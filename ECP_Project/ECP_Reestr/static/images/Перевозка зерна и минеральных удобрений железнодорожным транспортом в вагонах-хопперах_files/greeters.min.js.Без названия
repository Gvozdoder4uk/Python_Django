var CBHGreeters=function(a){function b(a,b){return b={exports:{}},a(b,b.exports),b.exports}function c(a,b){function c(a){Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=a,b&&b.apply(this,arguments)}return c.prototype=new Error,c.prototype.name=a,c.prototype.constructor=c,c}if(!a){var d={useDefaultConditionsOnEmpty:!0,defaultConditionsOnEmpty:{aggressiveness:"once_session",path:"*",pathOperator:"starts_with",secondsInPath:2},ignoreAgressiveness:!1},e=Math.ceil,f=Math.floor,g=function(a){return isNaN(a=+a)?0:(a>0?f:e)(a)},h=function(a){if(void 0==a)throw TypeError("Can't call method on  "+a);return a},i=function(a){return function(b,c){var d,e,f=String(h(b)),i=g(c),j=f.length;return i<0||i>=j?a?"":void 0:(d=f.charCodeAt(i),d<55296||d>56319||i+1===j||(e=f.charCodeAt(i+1))<56320||e>57343?a?f.charAt(i):d:a?f.slice(i,i+2):e-56320+(d-55296<<10)+65536)}},j=("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self,b(function(a){var b=a.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=b)})),k=b(function(a){var b=a.exports={version:"2.6.11"};"number"==typeof __e&&(__e=b)}),l=(k.version,function(a){return"object"==typeof a?null!==a:"function"==typeof a}),m=function(a){if(!l(a))throw TypeError(a+" is not an object!");return a},n=function(a){try{return!!a()}catch(a){return!0}},o=!n(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),p=j.document,q=l(p)&&l(p.createElement),r=function(a){return q?p.createElement(a):{}},s=!o&&!n(function(){return 7!=Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a}),t=function(a,b){if(!l(a))return a;var c,d;if(b&&"function"==typeof(c=a.toString)&&!l(d=c.call(a)))return d;if("function"==typeof(c=a.valueOf)&&!l(d=c.call(a)))return d;if(!b&&"function"==typeof(c=a.toString)&&!l(d=c.call(a)))return d;throw TypeError("Can't convert object to primitive value")},u=Object.defineProperty,v=o?Object.defineProperty:function(a,b,c){if(m(a),b=t(b,!0),m(c),s)try{return u(a,b,c)}catch(a){}if("get"in c||"set"in c)throw TypeError("Accessors not supported!");return"value"in c&&(a[b]=c.value),a},w={f:v},x=function(a,b){return{enumerable:!(1&a),configurable:!(2&a),writable:!(4&a),value:b}},y=o?function(a,b,c){return w.f(a,b,x(1,c))}:function(a,b,c){return a[b]=c,a},z={}.hasOwnProperty,A=function(a,b){return z.call(a,b)},B=0,C=Math.random(),D=function(a){return"Symbol(".concat(void 0===a?"":a,")_",(++B+C).toString(36))},E=b(function(a){var b=j["__core-js_shared__"]||(j["__core-js_shared__"]={});(a.exports=function(a,c){return b[a]||(b[a]=void 0!==c?c:{})})("versions",[]).push({version:k.version,mode:"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})}),F=E("native-function-to-string",Function.toString),G=b(function(a){var b=D("src"),c=(""+F).split("toString");k.inspectSource=function(a){return F.call(a)},(a.exports=function(a,d,e,f){var g="function"==typeof e;g&&(A(e,"name")||y(e,"name",d)),a[d]!==e&&(g&&(A(e,b)||y(e,b,a[d]?""+a[d]:c.join(String(d)))),a===j?a[d]=e:f?a[d]?a[d]=e:y(a,d,e):(delete a[d],y(a,d,e)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[b]||F.call(this)})}),H=function(a){if("function"!=typeof a)throw TypeError(a+" is not a function!");return a},I=function(a,b,c){if(H(a),void 0===b)return a;switch(c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)}}return function(){return a.apply(b,arguments)}},J=function(a,b,c){var d,e,f,g,h=a&J.F,i=a&J.G,l=a&J.S,m=a&J.P,n=a&J.B,o=i?j:l?j[b]||(j[b]={}):(j[b]||{}).prototype,p=i?k:k[b]||(k[b]={}),q=p.prototype||(p.prototype={});i&&(c=b);for(d in c)e=!h&&o&&void 0!==o[d],f=(e?o:c)[d],g=n&&e?I(f,j):m&&"function"==typeof f?I(Function.call,f):f,o&&G(o,d,f,a&J.U),p[d]!=f&&y(p,d,g),m&&q[d]!=f&&(q[d]=f)};j.core=k,J.F=1,J.G=2,J.S=4,J.P=8,J.B=16,J.W=32,J.U=64,J.R=128;var K=J,L={},M={}.toString,N=function(a){return M.call(a).slice(8,-1)},O=Object("z").propertyIsEnumerable(0)?Object:function(a){return"String"==N(a)?a.split(""):Object(a)},P=function(a){return O(h(a))},Q=Math.min,R=function(a){return a>0?Q(g(a),9007199254740991):0},S=Math.max,T=Math.min,U=function(a,b){return a=g(a),a<0?S(a+b,0):T(a,b)},V=function(a){return function(b,c,d){var e,f=P(b),g=R(f.length),h=U(d,g);if(a&&c!=c){for(;g>h;)if((e=f[h++])!=e)return!0}else for(;g>h;h++)if((a||h in f)&&f[h]===c)return a||h||0;return!a&&-1}},W=E("keys"),X=function(a){return W[a]||(W[a]=D(a))},Y=V(!1),Z=X("IE_PROTO"),$=function(a,b){var c,d=P(a),e=0,f=[];for(c in d)c!=Z&&A(d,c)&&f.push(c);for(;b.length>e;)A(d,c=b[e++])&&(~Y(f,c)||f.push(c));return f},_="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),aa=Object.keys||function(a){return $(a,_)},ba=o?Object.defineProperties:function(a,b){m(a);for(var c,d=aa(b),e=d.length,f=0;e>f;)w.f(a,c=d[f++],b[c]);return a},ca=j.document,da=ca&&ca.documentElement,ea=X("IE_PROTO"),fa=function(){},ga=function(){var a,b=r("iframe"),c=_.length;for(b.style.display="none",da.appendChild(b),b.src="javascript:",a=b.contentWindow.document,a.open(),a.write("<script>document.F=Object<\/script>"),a.close(),ga=a.F;c--;)delete ga.prototype[_[c]];return ga()},ha=Object.create||function(a,b){var c;return null!==a?(fa.prototype=m(a),c=new fa,fa.prototype=null,c[ea]=a):c=ga(),void 0===b?c:ba(c,b)},ia=b(function(a){var b=E("wks"),c=j.Symbol,d="function"==typeof c;(a.exports=function(a){return b[a]||(b[a]=d&&c[a]||(d?c:D)("Symbol."+a))}).store=b}),ja=w.f,ka=ia("toStringTag"),la=function(a,b,c){a&&!A(a=c?a:a.prototype,ka)&&ja(a,ka,{configurable:!0,value:b})},ma={};y(ma,ia("iterator"),function(){return this});var na=function(a,b,c){a.prototype=ha(ma,{next:x(1,c)}),la(a,b+" Iterator")},oa=function(a){return Object(h(a))},pa=X("IE_PROTO"),qa=Object.prototype,ra=Object.getPrototypeOf||function(a){return a=oa(a),A(a,pa)?a[pa]:"function"==typeof a.constructor&&a instanceof a.constructor?a.constructor.prototype:a instanceof Object?qa:null},sa=ia("iterator"),ta=!([].keys&&"next"in[].keys()),ua=function(){return this},va=function(a,b,c,d,e,f,g){na(c,b,d);var h,i,j,k=function(a){if(!ta&&a in o)return o[a];switch(a){case"keys":case"values":return function(){return new c(this,a)}}return function(){return new c(this,a)}},l=b+" Iterator",m="values"==e,n=!1,o=a.prototype,p=o[sa]||o["@@iterator"]||e&&o[e],q=p||k(e),r=e?m?k("entries"):q:void 0,s="Array"==b?o.entries||p:p;if(s&&(j=ra(s.call(new a)))!==Object.prototype&&j.next&&(la(j,l,!0),"function"!=typeof j[sa]&&y(j,sa,ua)),m&&p&&"values"!==p.name&&(n=!0,q=function(){return p.call(this)}),(ta||n||!o[sa])&&y(o,sa,q),L[b]=q,L[l]=ua,e)if(h={values:m?q:k("values"),keys:f?q:k("keys"),entries:r},g)for(i in h)i in o||G(o,i,h[i]);else K(K.P+K.F*(ta||n),b,h);return h},wa=i(!0);va(String,"String",function(a){this._t=String(a),this._i=0},function(){var a,b=this._t,c=this._i;return c>=b.length?{value:void 0,done:!0}:(a=wa(b,c),this._i+=a.length,{value:a,done:!1})});var xa=ia("unscopables"),ya=Array.prototype;void 0==ya[xa]&&y(ya,xa,{});var za=function(a){ya[xa][a]=!0},Aa=function(a,b){return{value:b,done:!!a}},Ba=va(Array,"Array",function(a,b){this._t=P(a),this._i=0,this._k=b},function(){var a=this._t,b=this._k,c=this._i++;return!a||c>=a.length?(this._t=void 0,Aa(1)):"keys"==b?Aa(0,c):"values"==b?Aa(0,a[c]):Aa(0,[c,a[c]])},"values");L.Arguments=L.Array,za("keys"),za("values"),za("entries");for(var Ca=ia("iterator"),Da=ia("toStringTag"),Ea=L.Array,Fa={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},Ga=aa(Fa),Ha=0;Ha<Ga.length;Ha++){var Ia,Ja=Ga[Ha],Ka=Fa[Ja],La=j[Ja],Ma=La&&La.prototype;if(Ma&&(Ma[Ca]||y(Ma,Ca,Ea),Ma[Da]||y(Ma,Da,Ja),L[Ja]=Ea,Ka))for(Ia in Ba)Ma[Ia]||G(Ma,Ia,Ba[Ia],!0)}var Na=ia,Oa={f:Na},Pa=(Oa.f("iterator"),b(function(a){var b=D("meta"),c=w.f,d=0,e=Object.isExtensible||function(){return!0},f=!n(function(){return e(Object.preventExtensions({}))}),g=function(a){c(a,b,{value:{i:"O"+ ++d,w:{}}})},h=function(a,c){if(!l(a))return"symbol"==typeof a?a:("string"==typeof a?"S":"P")+a;if(!A(a,b)){if(!e(a))return"F";if(!c)return"E";g(a)}return a[b].i},i=function(a,c){if(!A(a,b)){if(!e(a))return!0;if(!c)return!1;g(a)}return a[b].w},j=function(a){return f&&k.NEED&&e(a)&&!A(a,b)&&g(a),a},k=a.exports={KEY:b,NEED:!1,fastKey:h,getWeak:i,onFreeze:j}})),Qa=(Pa.KEY,Pa.NEED,Pa.fastKey,Pa.getWeak,Pa.onFreeze,w.f),Ra=function(a){var b=k.Symbol||(k.Symbol=j.Symbol||{});"_"==a.charAt(0)||a in b||Qa(b,a,{value:Oa.f(a)})},Sa=Object.getOwnPropertySymbols,Ta={f:Sa},Ua={}.propertyIsEnumerable,Va={f:Ua},Wa=function(a){var b=aa(a),c=Ta.f;if(c)for(var d,e=c(a),f=Va.f,g=0;e.length>g;)f.call(a,d=e[g++])&&b.push(d);return b},Xa=Array.isArray||function(a){return"Array"==N(a)},Ya=_.concat("length","prototype"),Za=Object.getOwnPropertyNames||function(a){return $(a,Ya)},$a={f:Za},_a=$a.f,ab={}.toString,bb="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],cb=function(a){try{return _a(a)}catch(a){return bb.slice()}},db=function(a){return bb&&"[object Window]"==ab.call(a)?cb(a):_a(P(a))},eb={f:db},fb=Object.getOwnPropertyDescriptor,gb=o?fb:function(a,b){if(a=P(a),b=t(b,!0),s)try{return fb(a,b)}catch(a){}if(A(a,b))return x(!Va.f.call(a,b),a[b])},hb={f:gb},ib=Pa.KEY,jb=hb.f,kb=w.f,lb=eb.f,mb=j.Symbol,nb=j.JSON,ob=nb&&nb.stringify,pb=ia("_hidden"),qb=ia("toPrimitive"),rb={}.propertyIsEnumerable,sb=E("symbol-registry"),tb=E("symbols"),ub=E("op-symbols"),vb=Object.prototype,wb="function"==typeof mb&&!!Ta.f,xb=j.QObject,yb=!xb||!xb.prototype||!xb.prototype.findChild,zb=o&&n(function(){return 7!=ha(kb({},"a",{get:function(){return kb(this,"a",{value:7}).a}})).a})?function(a,b,c){var d=jb(vb,b);d&&delete vb[b],kb(a,b,c),d&&a!==vb&&kb(vb,b,d)}:kb,Ab=function(a){var b=tb[a]=ha(mb.prototype);return b._k=a,b},Bb=wb&&"symbol"==typeof mb.iterator?function(a){return"symbol"==typeof a}:function(a){return a instanceof mb},Cb=function(a,b,c){return a===vb&&Cb(ub,b,c),m(a),b=t(b,!0),m(c),A(tb,b)?(c.enumerable?(A(a,pb)&&a[pb][b]&&(a[pb][b]=!1),c=ha(c,{enumerable:x(0,!1)})):(A(a,pb)||kb(a,pb,x(1,{})),a[pb][b]=!0),zb(a,b,c)):kb(a,b,c)},Db=function(a,b){m(a);for(var c,d=Wa(b=P(b)),e=0,f=d.length;f>e;)Cb(a,c=d[e++],b[c]);return a},Eb=function(a,b){return void 0===b?ha(a):Db(ha(a),b)},Fb=function(a){var b=rb.call(this,a=t(a,!0));return!(this===vb&&A(tb,a)&&!A(ub,a))&&(!(b||!A(this,a)||!A(tb,a)||A(this,pb)&&this[pb][a])||b)},Gb=function(a,b){if(a=P(a),b=t(b,!0),a!==vb||!A(tb,b)||A(ub,b)){var c=jb(a,b);return!c||!A(tb,b)||A(a,pb)&&a[pb][b]||(c.enumerable=!0),c}},Hb=function(a){for(var b,c=lb(P(a)),d=[],e=0;c.length>e;)A(tb,b=c[e++])||b==pb||b==ib||d.push(b);return d},Ib=function(a){for(var b,c=a===vb,d=lb(c?ub:P(a)),e=[],f=0;d.length>f;)!A(tb,b=d[f++])||c&&!A(vb,b)||e.push(tb[b]);return e};wb||(mb=function(){if(this instanceof mb)throw TypeError("Symbol is not a constructor!");var a=D(arguments.length>0?arguments[0]:void 0),b=function(c){this===vb&&b.call(ub,c),A(this,pb)&&A(this[pb],a)&&(this[pb][a]=!1),zb(this,a,x(1,c))};return o&&yb&&zb(vb,a,{configurable:!0,set:b}),Ab(a)},G(mb.prototype,"toString",function(){return this._k}),hb.f=Gb,w.f=Cb,$a.f=eb.f=Hb,Va.f=Fb,Ta.f=Ib,o&&G(vb,"propertyIsEnumerable",Fb,!0),Oa.f=function(a){return Ab(ia(a))}),K(K.G+K.W+K.F*!wb,{Symbol:mb});for(var Jb="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Kb=0;Jb.length>Kb;)ia(Jb[Kb++]);for(var Lb=aa(ia.store),Mb=0;Lb.length>Mb;)Ra(Lb[Mb++]);K(K.S+K.F*!wb,"Symbol",{for:function(a){return A(sb,a+="")?sb[a]:sb[a]=mb(a)},keyFor:function(a){if(!Bb(a))throw TypeError(a+" is not a symbol!");for(var b in sb)if(sb[b]===a)return b},useSetter:function(){yb=!0},useSimple:function(){yb=!1}}),K(K.S+K.F*!wb,"Object",{create:Eb,defineProperty:Cb,defineProperties:Db,getOwnPropertyDescriptor:Gb,getOwnPropertyNames:Hb,getOwnPropertySymbols:Ib});var Nb=n(function(){Ta.f(1)});K(K.S+K.F*Nb,"Object",{getOwnPropertySymbols:function(a){return Ta.f(oa(a))}}),nb&&K(K.S+K.F*(!wb||n(function(){var a=mb();return"[null]"!=ob([a])||"{}"!=ob({a:a})||"{}"!=ob(Object(a))})),"JSON",{stringify:function(a){for(var b,c,d=[a],e=1;arguments.length>e;)d.push(arguments[e++]);if(c=b=d[1],(l(b)||void 0!==a)&&!Bb(a))return Xa(b)||(b=function(a,b){if("function"==typeof c&&(b=c.call(this,a,b)),!Bb(b))return b}),d[1]=b,ob.apply(nb,d)}}),mb.prototype[qb]||y(mb.prototype,qb,mb.prototype.valueOf),la(mb,"Symbol"),la(Math,"Math",!0),la(j.JSON,"JSON",!0);var Ob=ia("toStringTag"),Pb="Arguments"==N(function(){return arguments}()),Qb=function(a,b){try{return a[b]}catch(a){}},Rb=function(a){var b,c,d;return void 0===a?"Undefined":null===a?"Null":"string"==typeof(c=Qb(b=Object(a),Ob))?c:Pb?N(b):"Object"==(d=N(b))&&"function"==typeof b.callee?"Arguments":d},Sb={};Sb[ia("toStringTag")]="z",Sb+""!="[object z]"&&G(Object.prototype,"toString",function(){return"[object "+Rb(this)+"]"},!0);var Tb=(k.Symbol,"function"==typeof Symbol&&Symbol.iterator,function(){var a="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103}(),function(){function a(a){this.value=a}function b(b){function c(a,b){return new Promise(function(c,e){var h={key:a,arg:b,resolve:c,reject:e,next:null};g?g=g.next=h:(f=g=h,d(a,b))})}function d(c,f){try{var g=b[c](f),h=g.value;h instanceof a?Promise.resolve(h.value).then(function(a){d("next",a)},function(a){d("throw",a)}):e(g.done?"return":"normal",g.value)}catch(a){e("throw",a)}}function e(a,b){switch(a){case"return":f.resolve({value:b,done:!0});break;case"throw":f.reject(b);break;default:f.resolve({value:b,done:!1})}f=f.next,f?d(f.key,f.arg):g=null}var f,g;this._invoke=c,"function"!=typeof b.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(b.prototype[Symbol.asyncIterator]=function(){return this}),b.prototype.next=function(a){return this._invoke("next",a)},b.prototype.throw=function(a){return this._invoke("throw",a)},b.prototype.return=function(a){return this._invoke("return",a)}}(),function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}),Ub=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),Vb=(Object.assign,function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}),Wb=function(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b},Xb=("undefined"==typeof global?self:global,function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(a){e=!0,f=a}finally{try{!d&&h.return&&h.return()}finally{if(e)throw f}}return c}}(),function(){function a(){Tb(this,a),this.eventRoutes={"core.greeters.rawDataReceived":this.onGreetersRawDataReceived,"widget.greeters.visible":this.onGreeterIsVisible,"widget.greeters.pause":this.onGreeterPauseQueue,"widget.greeters.closed":this.onGreeterResumeQueue,"widget.greeters.resume":this.onGreeterResumeQueue},this.eventEmitter=CBHCore.EventEmitter}return Ub(a,[{key:"init",value:function(){this.registerListeners()}},{key:"registerListeners",value:function(){var a=this;Object.keys(this.eventRoutes).forEach(function(b){a.eventEmitter.on(b,a.eventRoutes[b])})}},{key:"onGreetersRawDataReceived",value:function(a){try{if(void 0===a._embedded)throw new Error("data._embedded undefined");CBHGreeters.initGreeters(a._embedded),CBHCore.logger.debug({onGreetersRawDataReceived:CBHGreeters.greetersList})}catch(a){console.error("Error: "+a.name+":"+a.message)}}},{key:"onGreeterPauseQueue",value:function(){CBHGreeters.holdGreetersQueue(!0)}},{key:"onGreeterIsVisible",value:function(a){CBHCore.logger.debug({onGreeterIsVisible:a}),CBHGreeters.onGreeterIsVisible(a)}},{key:"onGreeterResumeQueue",value:function(a){CBHCore.logger.debug({onGreeterResumeQueue:a}),CBHGreeters.onGreeterResumeQueue(a)}}]),a}()),Yb={EQUALS:"equals",NOT_EQUALS:"not_equals",STARTS_WITH:"starts_with",ENDS_WITH:"ends_with",CONTAINS:"contains",NOT_CONTAINS:"not_contains",GREATER_THEN:"greater_then",KNOWN:"known",NOT_KNOWN:"n_known"},Zb=function(){function a(){Tb(this,a)}return Ub(a,null,[{key:"equals",value:function(a,b){return arguments.length>2&&void 0!==arguments[2]&&!arguments[2]?a==b:a===b}},{key:"not_equals",value:function(a,b){return arguments.length>2&&void 0!==arguments[2]&&!arguments[2]?a!=b:a!==b}},{key:"starts_with",value:function(a,b){var c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return void 0===a&&(a=""),"string"==typeof a&&"string"==typeof b&&new RegExp("^"+b,!1===c?"i":"").test(a)}},{key:"ends_with",value:function(a,b){var c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return void 0===a&&(a=""),"string"==typeof a&&"string"==typeof b&&new RegExp(b+"$",!1===c?"i":"").test(a)}},{key:"contains",value:function(a,b){var c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return void 0===a&&(a=""),"string"==typeof a&&"string"==typeof b&&-1!==a.search(new RegExp(b,!1===c?"i":""))}},{key:"not_contains",value:function(a,b){var c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return void 0===a&&(a=""),"string"==typeof b&&"string"==typeof a&&-1===a.search(new RegExp(b,!1===c?"i":""))}},{key:"greater_then",value:function(a,b){var c=this.toNumber(a),d=this.toNumber(b);return!isNaN(c)&&!isNaN(d)&&c>d}},{key:"toNumber",value:function(a){if("number"==typeof a)return a;var b="string"==typeof a?a.trim():a;return/^(-|\+)?([0-9]+|Infinity)$/.test(b)?Number(b):NaN}},{key:"known",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return void 0!==a&&!CBHCore.helpers.isEmpty(a)}},{key:"n_known",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return void 0===a||CBHCore.helpers.isEmpty(a)}}]),a}();Zb.predicatesMap=Yb;var $b=window,_b=c("InvalidArgumentError",function(a,b){this.message="Invalid value '"+b+"' for argument '"+a+"'"}),ac=(c("InvalidConditionType",function(a){this.message="Condition class '"+a+"' doesn't exists!"}),c("InvalidConditionMatcher",function(a){this.message="Matcher class of '"+a+"' doesn't exists!"})),bc=c("InvalidPredicate",function(a){this.message="No predicate method found for: '"+a}),cc=(c("ServerError",function(a,b){$b.message="#"+b+": "+a}),function(){function a(){Tb(this,a)}return Ub(a,null,[{key:"get",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"session";return CBHCore.storage.get(a,b)}},{key:"save",value:function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"session";return CBHCore.storage.save(a,b,c)}}]),a}());cc.KEYS={visitTime:"{greeterUid}_visitTime"};var dc=function(){function a(b){var c=b.predicate,d=b.value,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(Tb(this,a),this.isValid=!1,this.predicate=null,this.value=null,this.onConditionMatchCallback=null,this.storage=null,this.greeterUid=null,this.checkableValue=null,this.dependencies=[],this.predicate=c,this.value=d,this.greeterUid=e,this.storage=cc,CBHCore.logger.debug([this.getClassName()+" constructor",{predicate:c,value:d,greeterUid:e}]),void 0===Zb[this.predicate])throw this.isValid=!1,new bc(this.predicate);this.isValid=!0}return Ub(a,[{key:"checkPredicateCondition",value:function(a){var b=[];return this.checkableValue=a,(void 0!==a||this.isPredicateOfAwarenessType())&&b.push(a),b.push(this.value),Zb[this.predicate].apply(Zb,b)}},{key:"start",value:function(){}},{key:"getClassName",value:function(){return a.getClassName()}},{key:"isPredicateOfAwarenessType",value:function(){return Zb.predicatesMap.KNOWN===this.predicate||Zb.predicatesMap.NOT_KNOWN===this.predicate}}],[{key:"getClassName",value:function(){return"Matcher"}}]),a}(),ec=function(a){function b(){var a,c,d,e;Tb(this,b);for(var f=arguments.length,g=Array(f),h=0;h<f;h++)g[h]=arguments[h];return c=d=Wb(this,(a=b.__proto__||Object.getPrototypeOf(b)).call.apply(a,[this].concat(g))),d.visitDuration=0,e=c,Wb(d,e)}return Vb(b,a),Ub(b,[{key:"getClassName",value:function(){return b.getClassName()}}],[{key:"getClassName",value:function(){return"TimeMatcher"}}]),b}(dc),fc=function(){function a(b){Tb(this,a),this.dependencies=[],this.triggeredDependencies={},this.dependencies=b}return Ub(a,[{key:"check",value:function(a){return!(!a||-1===this.dependencies.indexOf(a))&&(this.triggeredDependencies[a]||(this.triggeredDependencies[a]=0),this.triggeredDependencies[a]++,this.dependencies.length===Object.keys(this.triggeredDependencies).length)}}]),a}(),gc=function(a){function b(a,c){var d=a.predicate,e=a.value;Tb(this,b);var f=Wb(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,{predicate:d,value:e},c));return f.dependencies=[xc.AVAILABLE_WORKERS.UrlMatcher.getClassName()],f.triggeredDependencies=[],f.hasStarted=!1,f.value=parseInt(f.value,10),f.dependencyChecker=new fc(f.dependencies),f}return Vb(b,a),Ub(b,[{key:"start",value:function(a,b){var c=this;if(!this.hasStarted&&this.dependencyChecker.check(b)){if(this.onConditionMatchCallback=a,this.hasStarted=!0,0===this.value&&this.predicate===Zb.predicatesMap.GREATER_THEN)return a(this.getClassName());this.visitDuration=this.storage.get(this.getStorageVisitTimeKey())||0;this.timerID=setInterval(function(){c.checkCondition(),c.visitDuration+=100,c.storage.save(c.getStorageVisitTimeKey(),c.visitDuration)},100)}}},{key:"getStorageVisitTimeKey",value:function(){return this.storage.KEYS.visitTime.replace(/{greeterUid}/,this.greeterUid)}},{key:"checkCondition",value:function(){if(this.visitDuration/1e3>=this.value)return clearInterval(this.timerID),this.onConditionMatchCallback(this.getClassName())}},{key:"getClassName",value:function(){return b.getClassName()}}],[{key:"getClassName",value:function(){return"PageTimeMatcher"}}]),b}(ec),hc=function(a){function b(){return Tb(this,b),Wb(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return Vb(b,a),Ub(b,[{key:"start",value:function(a){var b=Zb.predicatesMap;if(!(""!==this.value&&"/"!==this.value&&"*"!==this.value||this.predicate!==b.EQUALS&&this.predicate!==b.STARTS_WITH))return a(this.getClassName());var c=this.getUrl();if(""===c||!CBHCore.helpers.isEmpty(c)||this.isPredicateOfAwarenessType())return this.checkPredicateCondition(c)?a(this.getClassName()):void this.storage.save(this.storage.KEYS.visitTime.replace(/{greeterUid}/,this.greeterUid),0)}},{key:"getClassName",value:function(){return b.getClassName()}}],[{key:"getClassName",value:function(){return"UrlMatcher"}}]),b}(dc),ic=function(a){function b(){return Tb(this,b),Wb(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return Vb(b,a),Ub(b,[{key:"getUrl",value:function(){return CBHCore.user.session_ref||""}},{key:"getClassName",value:function(){return b.getClassName()}}],[{key:"getClassName",value:function(){return"RefererMatcher"}}]),b}(hc),jc=function(){function a(){Tb(this,a),this.onConditionMatchCallback=null}return Ub(a,[{key:"start",value:function(a){if(this.onConditionMatchCallback=a,CBHCore.isWorkTime())return a(this.getClassName());CBHCore.logger.debug({"ScheduleMatcher info":"not working time"})}},{key:"getClassName",value:function(){return a.getClassName()}}],[{key:"getClassName",value:function(){return"ScheduleMatcher"}}]),a}(),kc=function(a){function b(){return Tb(this,b),Wb(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return Vb(b,a),Ub(b,[{key:"getUrl",value:function(){return window.location.pathname.replace(/^\//,"")||""}},{key:"getClassName",value:function(){return b.getClassName()}}],[{key:"getClassName",value:function(){return"SiteUrlMatcher"}}]),b}(hc),lc=function(a){function b(){var a,c,d,e;Tb(this,b);for(var f=arguments.length,g=Array(f),h=0;h<f;h++)g[h]=arguments[h];return c=d=Wb(this,(a=b.__proto__||Object.getPrototypeOf(b)).call.apply(a,[this].concat(g))),d.labelName="",e=c,Wb(d,e)}return Vb(b,a),Ub(b,[{key:"start",value:function(a){var b=CBHCore.helpers.parseUri(window.location.href),c=CBHCore.helpers.parseUri(decodeURIComponent(CBHCore.user.last_page_with_utm)||""),d=b&&b.query&&b.query[this.labelName]||c&&c.query&&c.query[this.labelName];if(void 0===d&&(d=""),this.checkPredicateCondition(d))return a(this.getClassName())}},{key:"getClassName",value:function(){return b.getClassName()}}],[{key:"getClassName",value:function(){return"UtmMatcher"}}]),b}(dc),mc=function(a){function b(){var a,c,d,e;Tb(this,b);for(var f=arguments.length,g=Array(f),h=0;h<f;h++)g[h]=arguments[h];return c=d=Wb(this,(a=b.__proto__||Object.getPrototypeOf(b)).call.apply(a,[this].concat(g))),d.labelName="utm_campaign",e=c,Wb(d,e)}return Vb(b,a),Ub(b,[{key:"getClassName",value:function(){return b.getClassName()}}],[{key:"getClassName",value:function(){return"UtmCampaignMatcher"}}]),b}(lc),nc=function(a){function b(){var a,c,d,e;Tb(this,b);for(var f=arguments.length,g=Array(f),h=0;h<f;h++)g[h]=arguments[h];return c=d=Wb(this,(a=b.__proto__||Object.getPrototypeOf(b)).call.apply(a,[this].concat(g))),d.labelName="utm_content",e=c,Wb(d,e)}return Vb(b,a),Ub(b,[{key:"getClassName",value:function(){return b.getClassName()}}],[{key:"getClassName",value:function(){return"UtmContentMatcher"}}]),b}(lc),oc=function(a){function b(){var a,c,d,e;Tb(this,b);for(var f=arguments.length,g=Array(f),h=0;h<f;h++)g[h]=arguments[h];return c=d=Wb(this,(a=b.__proto__||Object.getPrototypeOf(b)).call.apply(a,[this].concat(g))),d.labelName="utm_medium",e=c,Wb(d,e)}return Vb(b,a),Ub(b,[{key:"getClassName",value:function(){return b.getClassName()}}],[{key:"getClassName",value:function(){return"UtmMediumMatcher"}}]),b}(lc),pc=function(a){function b(){var a,c,d,e;Tb(this,b);for(var f=arguments.length,g=Array(f),h=0;h<f;h++)g[h]=arguments[h];return c=d=Wb(this,(a=b.__proto__||Object.getPrototypeOf(b)).call.apply(a,[this].concat(g))),d.labelName="utm_source",e=c,Wb(d,e)}return Vb(b,a),Ub(b,[{key:"getClassName",value:function(){return b.getClassName()}}],[{key:"getClassName",value:function(){return"UtmSourceMatcher"}}]),b}(lc),qc=function(a){function b(){var a,c,d,e;Tb(this,b);for(var f=arguments.length,g=Array(f),h=0;h<f;h++)g[h]=arguments[h];return c=d=Wb(this,(a=b.__proto__||Object.getPrototypeOf(b)).call.apply(a,[this].concat(g))),d.labelName="utm_term",e=c,Wb(d,e)}return Vb(b,a),Ub(b,[{key:"getClassName",value:function(){return b.getClassName()}}],[{key:"getClassName",value:function(){return"UtmTermMatcher"}}]),b}(lc),rc=function(a){function b(a){var c=a.predicate,d=a.value;Tb(this,b);var e=Wb(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,{predicate:c,value:d}));return e.userProfileKey="",e.userData={},e.userData=CBHCore.user.getUserData(),e}return Vb(b,a),Ub(b,[{key:"start",value:function(a){if(this.checkPredicateCondition(this.userData[this.userProfileKey]))return a(this.getClassName())}},{key:"getClassName",value:function(){return b.getClassName()}}],[{key:"getClassName",value:function(){return"VisitorProfileMatcher"}}]),b}(dc),sc=function(a){function b(){var a,c,d,e;Tb(this,b);for(var f=arguments.length,g=Array(f),h=0;h<f;h++)g[h]=arguments[h];return c=d=Wb(this,(a=b.__proto__||Object.getPrototypeOf(b)).call.apply(a,[this].concat(g))),d.userProfileKey="email",e=c,Wb(d,e)}return Vb(b,a),Ub(b,[{key:"getClassName",value:function(){return b.getClassName()}}],[{key:"getClassName",value:function(){return"VisitorEmailMatcher"}}]),b}(rc),tc=function(a){function b(){return Tb(this,b),Wb(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return Vb(b,a),Ub(b,[{key:"start",value:function(a){}},{key:"getClassName",value:function(){return b.getClassName()}}],[{key:"getClassName",value:function(){return"VisitorGeoMatcher"}}]),b}(dc),uc=function(a){function b(){return Tb(this,b),Wb(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return Vb(b,a),Ub(b,[{key:"start",value:function(a){var b=(navigator.languages&&navigator.languages[0]||navigator.language||"").toLowerCase();if(this.value=this.value.toLowerCase(),-1!==b.indexOf("-")&&-1===this.value.indexOf("-")&&(b=b.split("-")[0]),this.checkPredicateCondition(b))return a(this.getClassName())}},{key:"getClassName",value:function(){return b.getClassName()}}],[{key:"getClassName",value:function(){return"VisitorLanguageMatcher"}}]),b}(dc),vc=function(a){function b(){var a,c,d,e;Tb(this,b);for(var f=arguments.length,g=Array(f),h=0;h<f;h++)g[h]=arguments[h];return c=d=Wb(this,(a=b.__proto__||Object.getPrototypeOf(b)).call.apply(a,[this].concat(g))),d.userProfileKey="name",e=c,Wb(d,e)}return Vb(b,a),Ub(b,[{key:"getClassName",value:function(){return b.getClassName()}}],[{key:"getClassName",value:function(){return"VisitorNameMatcher"}}]),b}(rc),wc=function(a){function b(){var a,c,d,e;Tb(this,b);for(var f=arguments.length,g=Array(f),h=0;h<f;h++)g[h]=arguments[h];return c=d=Wb(this,(a=b.__proto__||Object.getPrototypeOf(b)).call.apply(a,[this].concat(g))),d.userProfileKey="client_phone",e=c,Wb(d,e)}return Vb(b,a),Ub(b,[{key:"getClassName",value:function(){return b.getClassName()}}],[{key:"getClassName",value:function(){return"VisitorPhoneMatcher"}}]),b}(rc),xc=function(){function a(){Tb(this,a)}return Ub(a,null,[{key:"getMatcher",value:function(b){var c=b+"Matcher";return a.AVAILABLE_WORKERS[c]?a.AVAILABLE_WORKERS[c]:null}}]),a}();xc.AVAILABLE_WORKERS=Object.freeze({PageTimeMatcher:gc,RefererMatcher:ic,ScheduleMatcher:jc,UrlMatcher:kc,UtmCampaignMatcher:mc,UtmContentMatcher:nc,UtmMediumMatcher:oc,UtmSourceMatcher:pc,UtmTermMatcher:qc,VisitorEmailMatcher:sc,VisitorGeoMatcher:tc,VisitorLanguageMatcher:uc,VisitorNameMatcher:vc,VisitorPhoneMatcher:wc});var yc=function(){function a(b,c){var d=this;Tb(this,a),this.triggeredCnt=0,this.triggeredMatchers={},this.matchers=[],this.greeterUid=null,this.dependentMatchers=[],this.onCompositeMatcherTriggeredCallback=null,this.onSingleMatcherTriggered=function(a){if(!a)return void CBHCore.logger.debug({error:"matcherName empty"});d.triggeredMatchers[a]||(d.triggeredMatchers[a]=0),d.triggeredMatchers[a]++,CBHCore.logger.debug({matcherTriggered:{matcher:a,matcherData:d.getTriggeredMatcherByName(a),greeterUid:d.greeterUid}}),d.triggerDependentMatchers(a),d.matchers.length===Object.keys(d.triggeredMatchers).length&&d.onCompositeMatcherTriggeredCallback(d.greeterUid)},this.greeterUid=b,this.onCompositeMatcherTriggeredCallback=c}return Ub(a,[{key:"addSingleMatcher",value:function(a){this.matchers.push(a)}},{key:"start",value:function(){var a=this;this.matchers.forEach(function(b){b.dependencies&&b.dependencies.length&&a.dependentMatchers.push(b)}),this.matchers.forEach(function(b){b.start(a.onSingleMatcherTriggered)})}},{key:"triggerDependentMatchers",value:function(a){var b=this;this.dependentMatchers.forEach(function(c){c.start(b.onSingleMatcherTriggered,a)})}},{key:"getTriggeredMatcherByName",value:function(a){var b=this.matchers.filter(function(b){return b.getClassName()===a});return b.length?b[0]:null}}]),a}(),zc=function(){function a(){Tb(this,a)}return Ub(a,null,[{
key:"make",value:function(a,b){var c=a.uid,d=a.conditions;try{var e=new yc(c,b),f=!0,g=!1,h=void 0;try{for(var i,j=d[Symbol.iterator]();!(f=(i=j.next()).done);f=!0){var k=i.value,l=k.getClassName(),m=xc.getMatcher(l);if(null===m)throw new ac(l);try{e.addSingleMatcher(new m(k,c))}catch(a){CBHCore.logger.debug({errorMessage:"Error creating single matcher for condition "+k,Error:a})}}}catch(a){g=!0,h=a}finally{try{!f&&j.return&&j.return()}finally{if(g)throw h}}return e.addSingleMatcher(new jc),e}catch(a){return CBHCore.logger.debug({errorMessage:"Error in greeter's conditions "+c,Error:a}),null}}}]),a}(),Ac=function(){function a(){var b=this;Tb(this,a),this.compositeMatchers=[],this.greetersQueue=[],this.isQueueOnHold=!1,this.onCompositeMatcherTriggered=function(a){if(CBHCore.logger.debug({onCompositeMatcherTriggered:{greeterUid:a,isQueueOnHold:b.isQueueOnHold}}),a&&-1!==b.greetersQueue.indexOf(a))return void CBHCore.logger.debug({"onCompositeMatcherTriggered Duplicate":a});b.greetersQueue.push(a)}}return Ub(a,[{key:"init",value:function(a){var b=this;a.filter(function(a){return a.conditions}).filter(function(a){return!CBHGreeters.hasTriggeredBefore(a)||void 0!==CBHGreeters.settings.ignoreAgressiveness&&!1!==CBHGreeters.settings.ignoreAgressiveness||(CBHCore.logger.debug({"Skip greeter - it was triggered before":a.uid}),!1)}).forEach(function(a){b.compositeMatchers.push(zc.make(a,b.onCompositeMatcherTriggered))}),this.compositeMatchers.forEach(function(a){a.start()}),setInterval(function(){return b.watchQueue()},500)}},{key:"watchQueue",value:function(){!this.isQueueOnHold&&this.greetersQueue.length&&(this.holdGreetersQueue(!0),this.sendNextGreeterEvent())}},{key:"holdGreetersQueue",value:function(a){this.isQueueOnHold=a}},{key:"sendNextGreeterEvent",value:function(){if(this.greetersQueue.length){var a=CBHGreeters.getGreeterByUid(this.greetersQueue.shift());a&&CBHCore.EventEmitter.emit("greeters.arise",a)}}}]),a}(),Bc=function(){function a(b){Tb(this,a),this.main=null,this.hash=null,this.main=b,this.hash=window.location.hash.substring(1)}return Ub(a,[{key:"process",value:function(){var a=this;if(this.hash){var b=this.hash.match(/^callbackhunter-(.+)/);b&&b.length>0&&setTimeout(function(){return a.main.forceGreeter(b[1],!0)})}}}]),a}(),Cc=function(){function a(){Tb(this,a),this.name=null,this.seoId=null,this.uid=null,this.conditions=[],this.settings={}}return Ub(a,[{key:"aggressiveness",set:function(b){if(!a.AGGRESSIVENESS_TYPES[b])throw new _b("aggressiveness",b);this._aggressiveness=b},get:function(){return this._aggressiveness}},{key:"type",set:function(b){if(!a.TYPES[b])throw new _b("type",b);this._type=b},get:function(){return this._type}}]),a}();Cc.AGGRESSIVENESS_TYPES=Object.freeze({once_month:"once_month",once_week:"once_week",once_day:"once_day",once_session:"once_session"}),Cc.TYPES=Object.freeze({banner:"banner",slider:"slider",chat:"chat"});var Dc=function a(){Tb(this,a),this.bgChoice=null,this.bgColor=null,this.bgPresetId=null,this.bgFile=null,this.bgVideo=null,this.titleText=null,this.titleColor=null,this.subtitleText=null,this.subtitleColor=null,this.rightBgColor=null,this.rightTitleText=null,this.rightTitleColor=null,this.rightSubtitleText=null,this.rightSubtitleColor=null,this.timerEnabled=null,this.timerEndTs=null,this.timerTitleText=null,this.timerColor=null,this.callButtonText=null,this.buttonsColor=null};Dc.BG_CHOICES=Object.freeze({color:"color",preset:"preset",file:"file",video:"video"});var Ec=function(){function a(){Tb(this,a)}return Ub(a,null,[{key:"make",value:function(a,b){var c=a.bgChoice,d=a.bgColor,e=a.bgPresetId,f=a.bgVideo,g=a.titleText,h=a.titleColor,i=a.subtitleText,j=a.subtitleColor,k=a.rightBgColor,l=a.rightTitleText,m=a.rightTitleColor,n=a.rightSubtitleText,o=a.rightSubtitleColor,p=a.timerEnabled,q=a.timerEndTs,r=a.timerTitleText,s=a.timerColor,t=a.rightTitlePhoneText,u=a.rightTitlePhoneColor,v=a.callButtonText,w=a.buttonsColor,x=new Dc;return x.bgChoice=c,x.bgColor=d,x.bgPresetId=e,x.bgVideo=f,x.titleText=g,x.titleColor=h,x.subtitleText=i,x.subtitleColor=j,x.rightBgColor=k,x.rightTitleText=l||"â£",x.rightTitleColor=m,x.rightSubtitleText=n||"â£",x.rightSubtitleColor=o,x.timerEnabled=p,x.timerEndTs=q||0,x.timerTitleText=r||"â£",x.timerColor=s,x.rightTitlePhoneText=t||"â£",x.rightTitlePhoneColor=u,x.callButtonText=v,x.buttonsColor=w,x.bgFile=b&&b.background&&b.background.href,x}}]),a}(),Fc=function a(){Tb(this,a),this.bgChoice=null,this.bgColor=null,this.bgPresetId=null,this.bgFile=null,this.bgVideo=null,this.bodyLogo=null,this.titleText=null,this.subtitleText=null,this.secondScreenTitleText=null,this.titleColor=null,this.secondScreenTitleColor=null,this.firstButtonText=null,this.secondButtonText=null,this.secondScreenButtonText=null,this.buttonsColor=null,this.channelsSize=null,this.position=null,this.firstScreenEnabled=null,this.inheritWidget=null};Fc.BG_CHOICES=Object.freeze({color:"color",preset:"preset",file:"file",video:"video"}),Fc.POSITIONS=Object.freeze({center:"center",aside:"aside"});var Gc=function(){function a(){Tb(this,a)}return Ub(a,null,[{key:"make",value:function(a,b){var c=a.bgChoice,d=a.bgColor,e=a.bgPresetId,f=a.bgVideo,g=a.titleText,h=a.subtitleText,i=a.secondScreenTitleText,j=a.titleColor,k=a.secondScreenTitleColor,l=a.firstButtonText,m=a.secondButtonText,n=a.secondScreenButtonText,o=a.buttonsColor,p=a.channelsSize,q=a.position,r=a.firstScreenEnabled,s=new Fc;return s.bgChoice=c,s.bgColor=d,s.bgPresetId=e,s.bgVideo=f,s.titleText=g||"â£",s.subtitleText=h||"â£",s.secondScreenTitleText=i||"â£",s.titleColor=j,s.secondScreenTitleColor=k,s.firstButtonText=l,s.secondButtonText=m,s.secondScreenButtonText=n,s.buttonsColor=o,s.channelsSize=p,s.position=q,s.firstScreenEnabled=r,s.inheritWidget=!1,s.links=b,s.bgFile=b&&b.background&&b.background.href,s.bodyLogo=b&&b.sliderLogo&&b.sliderLogo.href,s}}]),a}(),Hc=function a(){Tb(this,a),this.text=null,this.managerAvatar=null,this.managerName=null,this.managerTitle=null,this.mode=null,this.buttonsColor=null,this.channelsSize=null};Hc.MODES=Object.freeze({min:"min",snippet:"snippet",full:"full"});var Ic=function(){function a(){Tb(this,a)}return Ub(a,null,[{key:"make",value:function(a,b){var c=a.text,d=a.managerAvatar,e=a.managerName,f=a.managerTitle,g=a.mode,h=a.buttonsColor,i=a.channelsSize,j=new Hc;return j.text=c,j.managerAvatar=d,j.managerName=e,j.managerTitle=f,j.mode=g,j.links=b,j.channelsSize=i,j.buttonsColor=h,j.managerAvatar=b&&b.managerAvatar&&b.managerAvatar.href,j.managerAvatar||j.mode!==Hc.MODES.snippet||(j.managerAvatar="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBkPSJNNDIzLjY4MyAzMTUuNTY5Yy4wNTIgNy4wMTEtNC4wOTkgMTMuMzI1LTEwLjQ2IDE2LjI3NS00MC4wMjIgMTguNTY0LTk1LjY2IDMwLjA4OC0xNTcuMjI0IDMwLjA4OHMtMTE3LjIwMi0xMS41MjMtMTU3LjIyNS0zMC4wODhjLTYuMzYtMi45NTEtMTAuNTExLTkuMjY1LTEwLjQ2LTE2LjI3NUM4OS41NyAxNDcuMDYyIDEyMC4zOTUgMCAyNTYgMHMxNjYuNDMgMTQ3LjA2MiAxNjcuNjgzIDMxNS41Njl6IiBmaWxsPSIjNWE0MTQ2Ii8+PHBhdGggZD0iTTMxNy43OTMgMzQyLjg0NHYtNDIuNzA2SDE5NC4yMDd2NDIuNzA2YTI2LjQ4IDI2LjQ4IDAgMCAxLTE4LjEwOSAyNS4xMjNsLTg0LjEyNiAyOC4wNDJjLTE4LjAyMyA2LjAwOC0zMC4xNzkgMjIuODc1LTMwLjE3OSA0MS44NzN2NTYuNDYzYzAgOS43NTEgNy45MDQgMTcuNjU1IDE3LjY1NSAxNy42NTVoMzUzLjEwM2M5Ljc1MSAwIDE3LjY1NS03LjkwNCAxNy42NTUtMTcuNjU1di01Ni40NjNjMC0xOC45OTgtMTIuMTU3LTM1Ljg2NS0zMC4xOC00MS44NzNMMzM1LjkgMzY3Ljk2N2EyNi40ODMgMjYuNDgzIDAgMCAxLTE4LjEwNy0yNS4xMjN6IiBmaWxsPSIjZTZhZjc4Ii8+PHBhdGggZD0iTTE5NC4yMDcgMzQyLjg0NGMwIDEwLjY4NS02LjQ1MyAyMC4xNzMtMTYuMTYxIDI0LjI5OCA5OC45MiAxNi44NTggMTM5LjcyLTUzLjc2MiAxMzkuNzItNTMuNzYybC4wMjgtLjAxOXYtMTMuMjIzSDE5NC4yMDd2NDIuNzA2eiIgZmlsbD0iI2QyOWI2ZSIvPjxwYXRoIGQ9Ik00MjAuMDI2IDM5Ni4wMDlsLTY4Ljc0LTIyLjkxM2MtMzIuNzE3IDQ0LjM4NS03MC45MDQgNjkuMTg3LTk1LjI4NiA3Ny4xMTEtMjQuMzgyLTcuOTI0LTYyLjU2OS0zMi43MjYtOTUuMjg2LTc3LjExMWwtNjguNzQgMjIuOTEzYy0xOC4wMjQgNi4wMDgtMzAuMTggMjIuODc1LTMwLjE4IDQxLjg3M3Y1Ni40NjNjMCA5Ljc1IDcuOTA1IDE3LjY1NSAxNy42NTUgMTcuNjU1aDM1My4xMDNjOS43NSAwIDE3LjY1NS03LjkwNSAxNy42NTUtMTcuNjU1di01Ni40NjNjMC0xOC45OTktMTIuMTU3LTM1Ljg2NS0zMC4xODEtNDEuODczeiIgZmlsbD0iI2U0ZWFmNiIvPjxnIGZpbGw9IiNkN2RlZWQiPjxwYXRoIGQ9Ik0xMjIuMDcxIDQ1Ny41MTlsLTQ4Ljk3LTQ4Ljk3Yy03LjA2IDcuOTA4LTExLjMwOCAxOC4yMTktMTEuMzA4IDI5LjMzMnY1Ni40NjNjMCA5Ljc1MSA3LjkwNCAxNy42NTUgMTcuNjU1IDE3LjY1NWg1Mi45NjZ2LTI5LjUxMmEzNS4zMSAzNS4zMSAwIDAgMC0xMC4zNDMtMjQuOTY4ek0zODkuOTI5IDQ1Ny41MTlsNDguOTctNDguOTdjNy4wNiA3LjkwOCAxMS4zMDggMTguMjE5IDExLjMwOCAyOS4zMzJ2NTYuNDYzYzAgOS43NTEtNy45MDQgMTcuNjU1LTE3LjY1NSAxNy42NTVoLTUyLjk2NnYtMjkuNTEyYTM1LjMxIDM1LjMxIDAgMCAxIDEwLjM0My0yNC45Njh6TTE0Ni41MDUgMzgzLjU2OWMzNS40NTcgNDguMTA4IDc2Ljk5MSA3NC42NDMgMTA0LjAzOSA4My40MzFsNS40NTYgMS43NyA1LjQ1Ny0xLjc3MWMyNy4wNDgtOC43ODkgNjguNTgyLTM1LjMyNCAxMDQuMDM5LTgzLjQzMWwzLjE2Ni00LjY4Mi0xNy4zNzYtNS43OTJjLTMyLjcxNiA0NC4zODYtNzAuOTAzIDY5LjE4OC05NS4yODUgNzcuMTEyLTI0LjM4Mi03LjkyNC02Mi41NjktMzIuNzI2LTk1LjI4Ni03Ny4xMTFsLTE3LjM3NiA1Ljc5MiAzLjE2NiA0LjY4MnoiLz48L2c+PHBhdGggZD0iTTE0Mi43MiAxODUuNDY5bC0xMC4yNTEtLjAzM2MtOS43NzItLjAzMS0xNy43MTEgNy44ODMtMTcuNzExIDE3LjY1NXYzNC44OTljMCA5Ljg4OCA4LjEyIDE3Ljg0OCAxOC4wMDcgMTcuNjUybDE1LjIxNS0uMzAzLTUuMjYtNjkuODd6IiBmaWxsPSIjNzA3NDg3Ii8+PHBhdGggZD0iTTEzMi40NyAxODUuNDM2Yy0uMDIgMC0uMDM2LjAwNi0uMDU2LjAwNnY3MC4xNzJjLjExOSAwIC4yMzIuMDMxLjM1Mi4wMjlsMTUuMjE1LS4zMDMtNS4yNi02OS44NjktMTAuMjUxLS4wMzV6IiBmaWxsPSIjNjU2ODdhIi8+PHBhdGggZD0iTTM2OS4yOCAxODUuNDY5bDEwLjI1MS0uMDMzYzkuNzcyLS4wMzEgMTcuNzExIDcuODgzIDE3LjcxMSAxNy42NTV2MzQuODk5YzAgOS44ODgtOC4xMiAxNy44NDgtMTguMDA3IDE3LjY1MmwtMTUuMjE1LS4zMDMgNS4yNi02OS44N3oiIGZpbGw9IiM3MDc0ODciLz48cGF0aCBkPSJNMzc5LjUzIDE4NS40MzZjLjAyIDAgLjAzNi4wMDYuMDU2LjAwNnY3MC4xNzJjLS4xMTkgMC0uMjMyLjAzMS0uMzUyLjAyOWwtMTUuMjE1LS4zMDMgNS4yNi02OS44NjkgMTAuMjUxLS4wMzV6IiBmaWxsPSIjNjU2ODdhIi8+PHBhdGggZD0iTTE0MS4yNDEgMTA1LjkzMXYzOC4wNjFjMCAxNS44MTYuNjA3IDMxLjYyNSAxLjgyIDQ3LjM5M2w1LjA4NyA2Ni4xMjlhNTIuOTY2IDUyLjk2NiAwIDAgMCAyMi40MzUgMzkuMzI5bDUzLjMwOCAzNy4zMTVhNTUuOTY3IDU1Ljk2NyAwIDAgMCAzMi4wOTUgMTAuMTE4aC4wMjZhNTUuOTYyIDU1Ljk2MiAwIDAgMCAzMi4wOTUtMTAuMTE4bDUzLjMwOC0zNy4zMTVhNTIuOTYgNTIuOTYgMCAwIDAgMjIuNDM1LTM5LjMyOWw1LjA4Ny02Ni4xMjlhNjE3LjkwMyA2MTcuOTAzIDAgMCAwIDEuODItNDcuMzkzdi0zOC4wNjFIMTQxLjI0MXoiIGZpbGw9IiNmMGMwODciLz48cGF0aCBkPSJNMzcwLjA5NyAxMDUuOTMxSDE0MS4yNDF2MzguMDYzYzAgNC45MDUuMTY2IDkuODA2LjI4MiAxNC43MDl2LjAwM2MuMTQgNS44OTUuMzY0IDExLjc4NS42NzMgMTcuNjczdi4wMDRjLjI2MyA1LjAwMi40ODEgMTAuMDA2Ljg2NSAxNS4wMDFsNS4wODcgNjYuMTI5YTUyLjk2NCA1Mi45NjQgMCAwIDAgMjIuNDM2IDM5LjMyOWw1My4zMDggMzcuMzE1YTU1Ljk3MyA1NS45NzMgMCAwIDAgMzIuMDk1IDEwLjExNmMtMTQuMTY2IDAtMjkuNzM1LTI0LjM4NC0zOS41MDMtNDIuODc2LTYuNDM1LTEyLjE4MS05Ljg2OS0yNS42ODQtMTAuMTI2LTM5LjQ1OGwtMS40OTEtNzkuOTI4Yy0uMTE4LTYuMzU2IDQuNDg3LTExLjc2MyAxMC43NS0xMi44NSA0Ny4zNC04LjIxNiA4NC45MTktMjEuNjQxIDEwNi40MDEtMzEuMTI2IDE3LjAzIDI4LjE1IDM5LjQ2IDM2LjU3IDQyLjM2OCAzNy41NjRsMi43NzcuOTQ5aDIuNjMxYy4zMS01Ljg4Mi41MzYtMTEuNzY2LjY3OS0xNy42NTVsLS4zNzYtNTIuOTYyeiIgZmlsbD0iI2U2YWY3OCIvPjxwYXRoIGQ9Ik0xMzIuNDE0IDk3LjEwM3Y2MS43OTNjMTA0LjU4NSAwIDE4NC4xOTgtMzYuNDEgMTk3LjUzMi00NC40NTUgMTQuMzMgMzUuNjI3IDQwLjE1MSA0NC40NTUgNDAuMTUxIDQ0LjQ1NWg5LjQ5Vjk3LjEwM0gxMzIuNDE0eiIgZmlsbD0iIzVhNDE0NiIvPjxwYXRoIGQ9Ik0zNzkuMjM0IDI1NS42NDFsLTE1LjE0Ny0uMzAxYy02Ljc0IDEyLjI0NS0yNi45MjkgMzIuMjk1LTg3LjEyMyAzMi4yOTV2MTcuNjU1YzgwLjQzOSAwIDEwMS4wOC0zNC4yNzggMTA2LjMyNC01MC4wNzMtMS4zMDguMjc5LTIuNjU2LjQ1Mi00LjA1NC40MjR6IiBmaWxsPSIjNDY0NjU1Ii8+PHBhdGggZD0iTTI2OS4yNDEgMzA4Ljk2NmgtOC44MjhjLTcuMzEzIDAtMTMuMjQxLTUuOTI5LTEzLjI0MS0xMy4yNDEgMC03LjMxMyA1LjkyOS0xMy4yNDEgMTMuMjQxLTEzLjI0MWg4LjgyOGM3LjMxMyAwIDEzLjI0MSA1LjkyOSAxMy4yNDEgMTMuMjQxLjAwMSA3LjMxMi01LjkyOCAxMy4yNDEtMTMuMjQxIDEzLjI0MXoiIGZpbGw9IiM1YjVkNmUiLz48L3N2Zz4="),j}}]),a}(),Jc=function(){function a(b,c){Tb(this,a),this.predicate=b,this.value=c}return Ub(a,[{key:"getClassName",value:function(){return a.getClassName()}}],[{key:"getClassName",value:function(){return"BaseCondition"}}]),a}(),Kc=function(a){function b(){return Tb(this,b),Wb(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return Vb(b,a),Ub(b,[{key:"getClassName",value:function(){return b.getClassName()}}],[{key:"getClassName",value:function(){return"PageTime"}}]),b}(Jc),Lc=function(a){function b(){return Tb(this,b),Wb(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return Vb(b,a),Ub(b,[{key:"getClassName",value:function(){return b.getClassName()}}],[{key:"getClassName",value:function(){return"Referer"}}]),b}(Jc),Mc=function(a){function b(){return Tb(this,b),Wb(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return Vb(b,a),Ub(b,[{key:"getClassName",value:function(){return b.getClassName()}}],[{key:"getClassName",value:function(){return"Url"}}]),b}(Jc),Nc=function(a){function b(){return Tb(this,b),Wb(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return Vb(b,a),Ub(b,[{key:"getClassName",value:function(){return b.getClassName()}}],[{key:"getClassName",value:function(){return"UtmCampaign"}}]),b}(Jc),Oc=function(a){function b(){return Tb(this,b),Wb(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return Vb(b,a),Ub(b,[{key:"getClassName",value:function(){return b.getClassName()}}],[{key:"getClassName",value:function(){return"UtmContent"}}]),b}(Jc),Pc=function(a){function b(){return Tb(this,b),Wb(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return Vb(b,a),Ub(b,[{key:"getClassName",value:function(){return b.getClassName()}}],[{key:"getClassName",value:function(){return"UtmMedium"}}]),b}(Jc),Qc=function(a){function b(){return Tb(this,b),Wb(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return Vb(b,a),Ub(b,[{key:"getClassName",value:function(){return b.getClassName()}}],[{key:"getClassName",value:function(){return"UtmSource"}}]),b}(Jc),Rc=function(a){function b(){return Tb(this,b),Wb(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return Vb(b,a),Ub(b,[{key:"getClassName",value:function(){return b.getClassName()}}],[{key:"getClassName",value:function(){return"UtmTerm"}}]),b}(Jc),Sc=function(a){function b(){return Tb(this,b),Wb(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return Vb(b,a),Ub(b,[{key:"getClassName",value:function(){return b.getClassName()}}],[{key:"getClassName",value:function(){return"VisitorPhone"}}]),b}(Jc),Tc={path:Mc,referrer:Lc,utmSource:Qc,utmMedium:Pc,utmCampaign:Nc,utmTerm:Rc,utmContent:Oc},Uc={referrerKnown:Lc,utmSourceKnown:Qc,utmMediumKnown:Pc,utmCampaignKnown:Nc,utmTermKnown:Rc,utmContentKnown:Oc,phoneKnown:Sc},Vc=function(){function a(){Tb(this,a)}return Ub(a,null,[{key:"make",value:function(a){var b=[];return a&&CBHCore.helpers.isObject(a)?(void 0!==a.secondsInPath&&(b.push(new Kc(Zb.predicatesMap.GREATER_THEN,parseInt(a.secondsInPath,10)||0)),void 0===a.path&&b.push(new Mc(Zb.predicatesMap.STARTS_WITH,"*"))),Object.keys(Tc).forEach(function(c){a[c]&&a[c+"Operator"]&&b.push(new Tc[c](a[c+"Operator"],a[c]))}),Object.keys(Uc).forEach(function(c){"boolean"==typeof a[c]&&b.push(new Uc[c](!0===a[c]?Zb.predicatesMap.KNOWN:Zb.predicatesMap.NOT_KNOWN))}),b):b}}]),a}(),Wc=function(){function a(){Tb(this,a)}return Ub(a,null,[{key:"make",value:function(a){var b=a.name,c=a.seoId,d=a.uid,e=a.type,f=a.settings,g=a.conditions,h=a._links,i=void 0===h?{}:h,j=new Cc;j.name=b,j.seoId=c,j.uid=d,j.type=e,j.settings={},f&&("banner"===j.type&&void 0!==f.banner?j.settings.banner=Ec.make(f.banner||{},i):"slider"===j.type&&void 0!==f.slider?j.settings.slider=Gc.make(f.slider||{},i):"chat"===j.type&&void 0!==f.chat&&(j.settings.chat=Ic.make(f.chat||{},i)));var k=this.defineConditions(g);return j.aggressiveness=k.aggressiveness?k.aggressiveness:Cc.AGGRESSIVENESS_TYPES.once_session,delete k.aggressiveness,j.conditions=Vc.make(k),j}},{key:"defineConditions",value:function(a){return a&&CBHCore.helpers.isObject(a)?a:CBHGreeters.settings.useDefaultConditionsOnEmpty&&CBHGreeters.settings.defaultConditionsOnEmpty?CBHGreeters.settings.defaultConditionsOnEmpty:[]}},{key:"fromRawData",value:function(b){return b&&Array.isArray(b.greeters)?b.greeters.map(function(b){return a.make(b)}):[]}}]),a}(),Xc=function(){function a(){Tb(this,a),this.listeners=new Xb,this.greetersList=[],this.matchersService=new Ac,this.locationHashProcessorService=new Bc(this)}return Ub(a,[{key:"init",value:function(){this.listeners.init(),this.locationHashProcessorService.process()}},{key:"initGreeters",value:function(a){this.greetersList=Wc.fromRawData(a),this.initMatchersService()}},{key:"getGreeterByUid",value:function(a){var b=this.greetersList.filter(function(b){return b.uid===a});return b.length?b[0]:null}},{key:"initMatchersService",value:function(){if(!this.greetersList)return void CBHCore.logger.debug({"greetersList empty":this.greetersList});this.matchersService.init(this.greetersList)}},{key:"onGreeterIsVisible",value:function(a){var b=this.getGreeterByUid(a);b||CBHCore.logger.debug({Error:"no such greteer: "+a}),this.setGreteerCatchingCookie(b),this.holdGreetersQueue(!0)}},{key:"onGreeterResumeQueue",value:function(){var a=this;setTimeout(function(){return a.holdGreetersQueue(!1)},0)}},{key:"setGreteerCatchingCookie",value:function(a){if(a){var b="",c=new CBHCore.lib.StrongDate,d="greeter_"+a.uid,e=a.aggressiveness,f=0;e===Cc.AGGRESSIVENESS_TYPES.once_day?f=24:e===Cc.AGGRESSIVENESS_TYPES.once_week?f=168:e===Cc.AGGRESSIVENESS_TYPES.once_month&&(f=720),f>0&&(c.setHours(c.getHours()+f),b=c.toUTCString()),CBHCore.cookies.set(d,e,{expires:b})}}},{key:"hasTriggeredBefore",value:function(a){if(!a)return!1;var b=CBHCore.cookies.get("greeter_"+a.uid);return b&&b===a.aggressiveness}},{key:"holdGreetersQueue",value:function(a){this.matchersService.holdGreetersQueue(a)}},{key:"forceGreeter",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]&&arguments[1],c=this.getGreeterByUid(a);if(!c)return b?void CBHCore.api.getGreeterByUid(a,function(a){CBHCore.EventEmitter.emit("greeters.arise",Wc.make(a))}):void console.warn({Error:"no such greeter: "+a});CBHCore.EventEmitter.emit("greeters.arise",c),this.holdGreetersQueue(!0)}},{key:"showGreetersList",value:function(){var a=[];if(this.greetersList.forEach(function(b){var c={ID:b.uid,Type:b.type};a.push(c)}),!a.length)return void console.log("No greeters!");console.table(a)}}]),a}(),Yc=new Xc;return Yc.settings=d,Yc}}("undefined"==typeof CBHCore);try{CBHGreeters.init()}catch(a){console.error(a)}