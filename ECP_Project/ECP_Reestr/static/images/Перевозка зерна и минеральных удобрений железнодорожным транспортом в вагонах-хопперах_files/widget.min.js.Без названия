var ClbhObject=function(a,b,c){function d(a){return a.charAt(0).toUpperCase()+a.slice(1)}function e(a,b){if(!a)return b.toLowerCase();var c=a.split("-");if(c.length>1)return c.splice(1,0,b),c.reduce(function(a,b){return""+a+d(b)});var e=a.replace(/([a-z])([A-Z])/g,"$1"+b+"$2");return a===e?""+a+b:e}function f(a,b){for(var c={},d=0;d<b.length;d+=1)(b[d]||0===b[d])&&(c[e(a,va[d])]=b[d]);return c}function g(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];var e=c[0],g=c[1],h=void 0===g?e:g,i=c[2],j=void 0===i?e:i,k=c[3];return f(a,[e,h,j,void 0===k?h:k])}function h(a){return Math.round(255*a)}function i(a,b,c){return h(a)+","+h(b)+","+h(c)}function j(a,b,c){var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i;if(0===b)return d(c,c,c);var e=a%360/60,f=(1-Math.abs(2*c-1))*b,g=f*(1-Math.abs(e%2-1)),h=0,j=0,k=0;e>=0&&e<1?(h=f,j=g):e>=1&&e<2?(h=g,j=f):e>=2&&e<3?(j=f,k=g):e>=3&&e<4?(j=g,k=f):e>=4&&e<5?(h=g,k=f):e>=5&&e<6&&(h=f,k=g);var l=c-f/2;return d(h+l,j+l,k+l)}function k(a){if("string"!=typeof a)return a;var b=a.toLowerCase();return xa[b]?"#"+xa[b]:a}function l(a){if("string"!=typeof a)throw new Error("Passed an incorrect argument to a color function, please pass a string representation of a color.");var b=k(a);if(b.match(ya))return{red:parseInt(""+b[1]+b[2],16),green:parseInt(""+b[3]+b[4],16),blue:parseInt(""+b[5]+b[6],16)};if(b.match(za))return{red:parseInt(""+b[1]+b[1],16),green:parseInt(""+b[2]+b[2],16),blue:parseInt(""+b[3]+b[3],16)};var c=Aa.exec(b);if(c)return{red:parseInt(""+c[1],10),green:parseInt(""+c[2],10),blue:parseInt(""+c[3],10)};var d=Ba.exec(b);if(d)return{red:parseInt(""+d[1],10),green:parseInt(""+d[2],10),blue:parseInt(""+d[3],10),alpha:parseFloat(""+d[4])};var e=Ca.exec(b);if(e){var f=parseInt(""+e[1],10),g=parseInt(""+e[2],10)/100,h=parseInt(""+e[3],10)/100,i="rgb("+j(f,g,h)+")",l=Aa.exec(i);if(!l)throw new Error("Couldn't generate valid rgb string from "+b+", it returned "+i+".");return{red:parseInt(""+l[1],10),green:parseInt(""+l[2],10),blue:parseInt(""+l[3],10)}}var m=Da.exec(b);if(m){var n=parseInt(""+m[1],10),o=parseInt(""+m[2],10)/100,p=parseInt(""+m[3],10)/100,q="rgb("+j(n,o,p)+")",r=Aa.exec(q);if(!r)throw new Error("Couldn't generate valid rgb string from "+b+", it returned "+q+".");return{red:parseInt(""+r[1],10),green:parseInt(""+r[2],10),blue:parseInt(""+r[3],10),alpha:parseFloat(""+m[4])}}throw new Error("Couldn't parse the color string. Please provide the color as a string in hex, rgb, rgba, hsl or hsla notation.")}function m(a){var b=a.red/255,c=a.green/255,d=a.blue/255,e=Math.max(b,c,d),f=Math.min(b,c,d),g=(e+f)/2;if(e===f)return void 0!==a.alpha?{hue:0,saturation:0,lightness:g,alpha:a.alpha}:{hue:0,saturation:0,lightness:g};var h=void 0,i=e-f,j=g>.5?i/(2-e-f):i/(e+f);switch(e){case b:h=(c-d)/i+(c<d?6:0);break;case c:h=(d-b)/i+2;break;default:h=(b-c)/i+4}return h*=60,void 0!==a.alpha?{hue:h,saturation:j,lightness:g,alpha:a.alpha}:{hue:h,saturation:j,lightness:g}}function n(a){return m(l(a))}function o(a){var b=a.toString(16);return 1===b.length?"0"+b:b}function p(a,b,c){if("number"==typeof a&&"number"==typeof b&&"number"==typeof c)return Ea("#"+o(a)+o(b)+o(c));if("object"==typeof a&&void 0===b&&void 0===c)return Ea("#"+o(a.red)+o(a.green)+o(a.blue));throw new Error("Passed invalid arguments to rgb, please pass multiple numbers e.g. rgb(255, 205, 100) or an object e.g. rgb({ red: 255, green: 205, blue: 100 }).")}function q(a,b,c,d){if("string"==typeof a&&"number"==typeof b){var e=l(a);return"rgba("+e.red+","+e.green+","+e.blue+","+b+")"}if("number"==typeof a&&"number"==typeof b&&"number"==typeof c&&"number"==typeof d)return d>=1?p(a,b,c):"rgba("+a+","+b+","+c+","+d+")";if("object"==typeof a&&void 0===b&&void 0===c&&void 0===d)return a.alpha>=1?p(a.red,a.green,a.blue):"rgba("+a.red+","+a.green+","+a.blue+","+a.alpha+")";throw new Error("Passed invalid arguments to rgba, please pass multiple numbers e.g. rgb(255, 205, 100, 0.75) or an object e.g. rgb({ red: 255, green: 205, blue: 100, alpha: 0.75 }).")}function r(a){return o(Math.round(255*a))}function s(a,b,c){return Ea("#"+r(a)+r(b)+r(c))}function t(a,b,c){return j(a,b,c,s)}function u(a,b,c){if("number"==typeof a&&"number"==typeof b&&"number"==typeof c)return t(a,b,c);if("object"==typeof a&&void 0===b&&void 0===c)return t(a.hue,a.saturation,a.lightness);throw new Error("Passed invalid arguments to hsl, please pass multiple numbers e.g. hsl(360, 0.75, 0.4) or an object e.g. rgb({ hue: 255, saturation: 0.4, lightness: 0.75 }).")}function v(a,b,c,d){if("number"==typeof a&&"number"==typeof b&&"number"==typeof c&&"number"==typeof d)return d>=1?t(a,b,c):"rgba("+j(a,b,c)+","+d+")";if("object"==typeof a&&void 0===b&&void 0===c&&void 0===d)return a.alpha>=1?t(a.hue,a.saturation,a.lightness):"rgba("+j(a.hue,a.saturation,a.lightness)+","+a.alpha+")";throw new Error("Passed invalid arguments to hsla, please pass multiple numbers e.g. hsl(360, 0.75, 0.4, 0.7) or an object e.g. rgb({ hue: 255, saturation: 0.4, lightness: 0.75, alpha: 0.7 }).")}function w(a){if("object"!=typeof a)throw new Error(Ja);if(Ga(a))return q(a);if(Fa(a))return p(a);if(Ia(a))return v(a);if(Ha(a))return u(a);throw new Error(Ja)}function x(a,b,c){return function(){var d=c.concat(Array.prototype.slice.call(arguments));return d.length>=b?a.apply(this,d):x(a,b,d)}}function y(a){return x(a,a.length,[])}function z(a,b,c){return Math.max(a,Math.min(b,c))}function A(a,b){var c=n(b);return w(wa({},c,{lightness:z(0,1,c.lightness-a)}))}function B(a,b){var c=n(b);return w(wa({},c,{lightness:z(0,1,c.lightness+a)}))}function C(a){return function(){var b=arguments.length<=1?void 0:arguments[1];try{b=a.apply(void 0,arguments)}catch(a){console.log(a)}return b}}function D(a){var b=a.element,c=a.valueAccessor;return!!CBHCore.helpers.isFunction(c)&&(Ua=new Ta({elemId:b,time:1e3*c(),template:"%minutes%:%seconds%:%ms%"}))}function E(a){return{customGroup:a.customGroup||!1,pageId:a.pageId||null,pageLink:a.pageLink||null,chatLink:a.chatLink||null}}function F(a,b){function c(a){return CBHCore.storage.get(a,e)}function d(a,b){return CBHCore.storage.save(a,b,e)}var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"session";return{get:function(){return a.apply(void 0,Array.prototype.slice.call(arguments).concat([c]))},save:function(){return b.apply(void 0,Array.prototype.slice.call(arguments).concat([d]))}}}function G(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ib.io&&ib.io.emit(a,b)}function H(a,b){return a.filter(function(a){return a.text&&a.text.length>0&&a.text.length<b})}function I(a,b){return b>0&&a[b].own===a[b-1].own}function J(a,b){return b<a.length-1&&a[b].own===a[b+1].own}function K(a){for(var b=null,c=a.sort(function(a,b){return a.ts-b.ts}).slice(),d=0;d<c.length;d++)d>0&&c[d].time()===c[d-1].time()&&c[d].own===c[d-1].own&&c[d-1].time(null),b&&b===c[d].day()?c[d].day(null):c[d].day()&&(b=c[d].day()),d===c.length-1?I(c,d)?c[d].position("last"):c[d].position("first"):I(c,d)?c[d].position("inner"):(c[d].position("first"),d>0&&"inner"===c[d-1].position()&&c[d-1].position("last"),J(c,d)||c[d].position("only"));return c}function L(a){a&&(a.scrollTop=a.scrollHeight)}function M(a,b){return b&&a?void 0!==a.find(function(a){return a.text&&a.text===b}):null}function N(a,b){return a.length<2?a[0]:a[(a.indexOf(b)+1)%a.length]}function O(a,b){var c=parseInt(b(),10);return isNaN(c)?"auto":c+a+"px"}function P(a,b){if(window.location.hash){var c=window.location.hash.substring(1);if("callbackhunter"===c)return void setTimeout(function(){return Q(a,b)});if("autocallback"===c){if(CBHCore.cookies.get("hunter_autocallback"))return void CBHCore.logger.debug({message:"autoCallback failed, because cookie 'hunter_autocallback' is set!"});Qb=!0,setTimeout(function(){return R(a,b)})}}}function Q(a,b){window.location.hash="#callbackhunter-ok",b.showSlider(!0)}function R(a,b){if(Qb){window.location.hash="#autocallback-ok";var c=CBHCore.params.mainSchedule,d=!1;if(Qb=!1,CBHCore.cookies.set("hunter_autocallback","1",{expires:1}),void 0!==ha.has_minutes&&(d=0!==parseInt(ha.has_minutes,10)),!(a.hasCalls&&CBHCore.helpers.hasSubscription()&&c.isWorkTime()&&d))return void CBHCore.logger.debug({message:"autoCallback failed",hasCalls:a.hasCalls,hasSubscription:CBHCore.helpers.hasSubscription(),isWorkTime:c.isWorkTime(),hasMinutes:d});a.showReason(CBHCore.showReasons.AUTOCALLBACK),b.startCallback()}}function S(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!CBHCore.extensionMode&&!ba.disable_metrika_events){if(!ba.yaMetrikaName)for(var c in window)if(window.hasOwnProperty(c)&&"string"==typeof c&&c.match(/^yaCounter\d+/)&&void 0!==window[c]&&window[c].reachGoal){ba.yaMetrikaName=c;break}if(ba.yaMetrikaName)try{b?window[ba.yaMetrikaName].reachGoal(a,{cbh:b}):window[ba.yaMetrikaName].reachGoal(a)}catch(a){}}}function T(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!CBHCore.extensionMode&&!ba.disable_ga_events)if(void 0!==window.ga_cbh&&CBHCore.helpers.isFunction(window.ga_cbh)&&window.ga_cbh("send","event",a,b,c),CBHCore.helpers.isFunction(window.ga))try{for(var d=window.ga.getAll(),e=0;e<d.length;++e){var f=d[e];f.send("event",a,b,c)}}catch(a){}else if("object"===la(window._gaq)&&CBHCore.helpers.isFunction(window._gaq.push))try{window._gaq.push(["_trackEvent",a,b,c])}catch(a){}}function U(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;CBHCore.logger.debug(["sendMarketingEvent",a,b]),T(a,b,c),S(a,c)}function V(a,b){ko.utils.registerEventHandler(window,"hashchange",function(){return P(a,b)}),P(a,b)}function W(){Rb.blockAutoPopup=!0}function X(a,b,c){var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,e=null;try{return"insertRule"in a?e=a.insertRule(b+"{"+c+"}",d):"addRule"in a&&(e=a.addRule(b,c,d)),function(){"deleteRule"in a?a.deleteRule(e):"removeRule"in a&&a.removeRule(e)}}catch(a){}return function(){}}function Y(a,b,c){var d=CBHCore.Masked;CBHCore.helpers.dontShowWidget()||CBHCore.db_params&&CBHCore.db_params.cbh_channels&&0===CBHCore.db_params.cbh_channels.length||(Z(),d.phoneCodes.loadMasks("all",CBHCore.lang.langCode,function(){V(a,b),b.draw(),c.init()}))}function Z(){if(!ba.disable_ga_events){if(void 0!==ha.ga_disable&&1===parseInt(ha.ga_disable,10))return!1;ca=null,function(a,b,c,d,e,f,g){a.GoogleAnalyticsObject=e,a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)},a[e].l=Number(new Date),f=b.createElement(c),g=b.getElementsByTagName(c)[0],f.async=1,f.src="//www.google-analytics.com/analytics.js",g.parentNode.insertBefore(f,g)}(window,document,"script",0,"ga_cbh"),ca=ca||window.ga_cbh,ca("create",CBHCore.opt.cbh_ga_id_v7||CBHCore.opt.cbh_ga_id,"callbackhunter.com"),ca("send","pageview")}}function $(){ko.options.useOnlyNativeEvents=!0,ko.setTemplateEngine(new ko.nativeTemplateEngine)}var _,aa,ba={StrongDate:Date,vkAppId:"5854600",fbAppId:"100933113718536",fbPageId:"170295890097406",fbChatLink:"https://m.me/170295890097406/",vkGroupId:"132204360",vkChatLink:"https://vk.me/callbackhunterchat",tgDomain:"cbh7_bot",fbPageLink:"https://www.facebook.com/cbhmsgbot/",viberPA_URI:"Callbackhunter",skPageLink:"https://join.skype.com/bot/",disable_ga_events:!1,disable_metrika_events:!1,yaMetrikaName:null,socketIOLib:"https://cdn.callbackhunter.com/widgets/v9/socket.io-1.4.5.mod.js",socketIOEndpoint:{url:"https://n.callbackhunter.com",path:"/builtin/socket.io"},disableCustomColors:!1,fakeChatMessages:!1,bgCarrouselHostname:["callbackhunter.com","cbh8.ru"],bgCarrouselCount:17,bgCarrouselInterval:3e3,knownPhoneSliderShowDelay:3e3},ca=function(){};!function(a,b){aa=function(a){function b(){var a=navigator.userAgent;return a.search(/Edge/)>-1?"edge":a.search(/MSIE/)>-1?"ie":a.search(/Trident/)>-1?"ie11":a.search(/Firefox/)>-1?"firefox":a.search(/Opera/)>-1?"opera":a.search(/OPR/)>-1?"operaWebkit":a.search(/YaBrowser/)>-1?"yabrowser":a.search(/Chrome/)>-1?"chrome":a.search(/Safari/)>-1?"safari":a.search(/Maxthon/)>-1?"maxthon":"browser"}function c(a,b){var c=document.createElement("iframe");return c.src=b,c.id="hiddenIframe",c.style.display="none",a.appendChild(c),c}function d(a){navigator.msLaunchUri(a,function(){},function(){n(p.desktop)})}function e(){var a,b=-1,c=navigator.userAgent;return"Microsoft Internet Explorer"===navigator.appName?(a=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),null!==a.exec(c)&&(b=parseFloat(RegExp.$1))):"Netscape"===navigator.appName&&(a=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),null!==a.exec(c)&&(b=parseFloat(RegExp.$1))),b}function f(a){10===e()?g(a):9===e()||11===e()?h(a):i(a)}function g(a){var b=setTimeout(function(){n(p.desktop)},1e3);window.addEventListener("blur",function(){clearTimeout(b)});var d=document.querySelector("#hiddenIframe");d||(d=c(document.body,"about:blank"));try{d.contentWindow.location.href=a}catch(a){n(p.desktop),clearTimeout(b)}}function h(a){function b(){clearTimeout(d),f.remove()}var d=setTimeout(function(){n(p.desktop),f.remove()},1e3),e=document.querySelector("#hiddenIframe");e||(e=c(document.body,"about:blank"));var f=l(window,"blur",b);e.contentWindow.location.href=a}function i(a){var b=window.open("","","width=0,height=0");b.document.write("<iframe src='"+a+"'></iframe>"),setTimeout(function(){try{b.location.href,b.setTimeout("window.close()",1e3)}catch(a){b.close(),n(p.desktop)}},1e3)}function j(a){var b=document.querySelector("#hiddenIframe");b||(b=c(document.body,"about:blank"));try{b.contentWindow.location.href=a}catch(a){"NS_ERROR_UNKNOWN_PROTOCOL"===a.name&&n(p.desktop)}}function k(a){for(var b=window;b!==b.parent;)b=b.parent;b.focus();var c,d;try{c=l(b,"blur",function(){clearTimeout(d),c.remove()})}catch(a){}c&&(d=setTimeout(function(){n(p.desktop),c.remove()},1e3)),s(a)}function l(a,b,c){return a.addEventListener?(a.addEventListener(b,c),{remove:function(){a.removeEventListener(b,c)}}):(a.attachEvent(b,c),{remove:function(){a.detachEvent(b,c)}})}function m(a){var b,c,d=CBHCore.helpers.parseUri(a),e=d.query,f=document.createElement("form");f.id="open-tab-fake-form",f.method="GET",f.action=a,f.target="_blank";for(var g in e)e.hasOwnProperty(g)&&(b=e[g],c=document.createElement("input"),c.setAttribute("type","hidden"),c.setAttribute("name",g),c.value=b,f.appendChild(c));return f}function n(a){if(a){var b=m(a);document.body.appendChild(b),b.submit(),void 0===Element.prototype.remove?document.body.removeChild(b):b.remove()}}if(a.document&&a.navigator){var o={windows:{},desktop:{},delay:1e3,delta:500},p={windows:{},desktop:""},q={windows:{store:{app:"ms-windows-store://pdp/?productid={id}",web:"https://www.microsoft.com/ru-ru/store/p/{name}/{id}"},test:/Windows\s+Phone|IEMobile/i}};Object.keys||(Object.keys=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b});var r=function(){for(var a in q)if(q.hasOwnProperty(a)&&navigator.userAgent.match(q[a].test))return a;return"desktop"},s=function(a){if(-1!==a.indexOf("http"))return void n(a);window.location.href=a},t=function(a,b){var c,d={};for(c in a)a.hasOwnProperty(c)&&(d[c]=a[c]);for(c in b)b.hasOwnProperty(c)&&(d[c]=b[c]);return d},u=function(){var a,b,c,d;for(a in o)if(o.hasOwnProperty(a)){b=o[a];var e=q[a];void 0!==e?(e=e.store,"object"==typeof b&&"object"==typeof e&&Object.keys(e).length>0&&(c=b.appId,d=b.appName,p[a].app=e.app.replace("{id}",c).replace("{name}",d),p[a].web=e.web.replace("{id}",c).replace("{name}",d))):"desktop"===a&&(p[a]=b.appUrl)}w()&&void 0!==o.windows.appId&&!1!==o.windows.appId&&(p.desktop=p.desktop.app)},v=function(){return"desktop"===r()},w=function(){var a=navigator.appVersion;return-1!==a.indexOf("Windows NT 6.2")||(-1!==a.indexOf("Windows NT 6.3")||-1!==a.indexOf("Windows NT 10.0"))},x=function(a){o=t(o,a),u()};return{setup:x,open:function(a,c){if(c&&x(c),v())if(navigator.msLaunchUri)d(a);else{var e=b();"firefox"===e?j(a):"chrome"===e||"yabrowser"===e||"opera"===e?k(a):"ie"===e?f(a):"safari"===e&&k(a)}return!0}}}}(a)}(window),function(){!function(a){var b=this||(0,eval)("this"),c=b.document,d=b.navigator,e=b.jQuery,f=b.JSON;!function(a){"function"==typeof _&&_.amd?_(["exports","require"],a):a(b.ko={})}(function(g,h){function i(a,b){return!!(null===a||typeof a in r)&&a===b}function j(b,c){var d;return function(){d||(d=q.utils.setTimeout(function(){d=a,b()},c))}}function k(a,b){var c;return function(){clearTimeout(c),c=q.utils.setTimeout(a,b)}}function l(a){var b=this;return a&&q.utils.objectForEach(a,function(a,c){var d=q.extenders[a];"function"==typeof d&&(b=d(b,c)||b)}),b}function m(a,b){b&&b!==s?"beforeChange"===b?this._limitBeforeChange(a):this._origNotifySubscribers(a,b):this._limitChange(a)}function n(a,b){null!==b&&b.dispose&&b.dispose()}function o(a,b){var c=this.computedObservable,d=c[y];d.isDisposed||(this.disposalCount&&this.disposalCandidates[b]?(c.addDependencyTracking(b,a,this.disposalCandidates[b]),this.disposalCandidates[b]=null,--this.disposalCount):d.dependencyTracking[b]||c.addDependencyTracking(b,a,d.isSleeping?{_target:a}:c.subscribeToDependency(a)))}function p(a,b,c,d){q.bindingHandlers[a]={init:function(a,e,f,g,h){var i,j;return q.computed(function(){var f=q.utils.unwrapObservable(e()),g=!c!=!f,k=!j;(k||b||g!==i)&&(k&&q.computedContext.getDependenciesCount()&&(j=q.utils.cloneNodes(q.virtualElements.childNodes(a),!0)),g?(k||q.virtualElements.setDomNodeChildren(a,q.utils.cloneNodes(j)),q.applyBindingsToDescendants(d?d(h,f):h,a)):q.virtualElements.emptyNode(a),i=g)},null,{disposeWhenNodeIsRemoved:a}),{controlsDescendantBindings:!0}}},q.expressionRewriting.bindingRewriteValidators[a]=!1,q.virtualElements.allowedBindings[a]=!0}var q=void 0!==g?g:{};q.exportSymbol=function(a,b){for(var c=a.split("."),d=q,e=0;e<c.length-1;e++)d=d[c[e]];d[c[c.length-1]]=b},q.exportProperty=function(a,b,c){a[b]=c},q.version="3.4.0",q.exportSymbol("version",q.version),q.options={deferUpdates:!1,useOnlyNativeEvents:!1},q.utils=function(){function g(a,b){for(var c in a)a.hasOwnProperty(c)&&b(c,a[c])}function h(a,b){if(b)for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function i(a,b){return a.__proto__=b,a}function j(a,b){if("input"!==q.utils.tagNameLower(a)||!a.type)return!1;if("click"!=b.toLowerCase())return!1;var c=a.type;return"checkbox"==c||"radio"==c}function k(a,b,c){var d;b&&("object"==typeof a.classList?(d=a.classList[c?"add":"remove"],q.utils.arrayForEach(b.match(v),function(b){d.call(a.classList,b)})):"string"==typeof a.className.baseVal?l(a.className,"baseVal",b,c):l(a,"className",b,c))}function l(a,b,c,d){var e=a[b].match(v)||[];q.utils.arrayForEach(c.match(v),function(a){q.utils.addOrRemoveItem(e,a,d)}),a[b]=e.join(" ")}var m={__proto__:[]}instanceof Array,n="function"==typeof Symbol,o={},p={};o[d&&/Firefox\/2/i.test(d.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"],o.MouseEvents=["click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","mouseenter","mouseleave"],g(o,function(a,b){if(b.length)for(var c=0,d=b.length;c<d;c++)p[b[c]]=a});var r={propertychange:!0},s=c&&function(){for(var b=3,d=c.createElement("div"),e=d.getElementsByTagName("i");d.innerHTML="\x3c!--[if gt IE "+ ++b+"]><i></i><![endif]--\x3e",e[0];);return b>4?b:a}(),t=6===s,u=7===s,v=/\S+/g;return{fieldsIncludedWithJsonPost:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],arrayForEach:function(a,b){for(var c=0,d=a.length;c<d;c++)b(a[c],c)},arrayIndexOf:function(a,b){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(a,b);for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},arrayFirst:function(a,b,c){for(var d=0,e=a.length;d<e;d++)if(b.call(c,a[d],d))return a[d];return null},arrayRemoveItem:function(a,b){var c=q.utils.arrayIndexOf(a,b);c>0?a.splice(c,1):0===c&&a.shift()},arrayGetDistinctValues:function(a){a=a||[];for(var b=[],c=0,d=a.length;c<d;c++)q.utils.arrayIndexOf(b,a[c])<0&&b.push(a[c]);return b},arrayMap:function(a,b){a=a||[];for(var c=[],d=0,e=a.length;d<e;d++)c.push(b(a[d],d));return c},arrayFilter:function(a,b){a=a||[];for(var c=[],d=0,e=a.length;d<e;d++)b(a[d],d)&&c.push(a[d]);return c},arrayPushAll:function(a,b){if(b instanceof Array)a.push.apply(a,b);else for(var c=0,d=b.length;c<d;c++)a.push(b[c]);return a},addOrRemoveItem:function(a,b,c){var d=q.utils.arrayIndexOf(q.utils.peekObservable(a),b);d<0?c&&a.push(b):c||a.splice(d,1)},canSetPrototype:m,extend:h,setPrototypeOf:i,setPrototypeOfOrExtend:m?i:h,objectForEach:g,objectMap:function(a,b){if(!a)return a;var c={};for(var d in a)a.hasOwnProperty(d)&&(c[d]=b(a[d],d,a));return c},emptyDomNode:function(a){for(;a.firstChild;)q.removeNode(a.firstChild)},moveCleanedNodesToContainerElement:function(a){for(var b=q.utils.makeArray(a),d=b[0]&&b[0].ownerDocument||c,e=d.createElement("div"),f=0,g=b.length;f<g;f++)e.appendChild(q.cleanNode(b[f]));return e},cloneNodes:function(a,b){for(var c=0,d=a.length,e=[];c<d;c++){var f=a[c].cloneNode(!0);e.push(b?q.cleanNode(f):f)}return e},setDomNodeChildren:function(a,b){if(q.utils.emptyDomNode(a),b)for(var c=0,d=b.length;c<d;c++)a.appendChild(b[c])},replaceDomNodes:function(a,b){var c=a.nodeType?[a]:a;if(c.length>0){for(var d=c[0],e=d.parentNode,f=0,g=b.length;f<g;f++)e.insertBefore(b[f],d);for(var f=0,g=c.length;f<g;f++)q.removeNode(c[f])}},fixUpContinuousNodeArray:function(a,b){if(a.length){for(b=8===b.nodeType&&b.parentNode||b;a.length&&a[0].parentNode!==b;)a.splice(0,1);for(;a.length>1&&a[a.length-1].parentNode!==b;)a.length--;if(a.length>1){var c=a[0],d=a[a.length-1];for(a.length=0;c!==d;)a.push(c),c=c.nextSibling;a.push(d)}}return a},setOptionNodeSelectionState:function(a,b){s<7?a.setAttribute("selected",b):a.selected=b},stringTrim:function(b){return null===b||b===a?"":b.trim?b.trim():b.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},stringStartsWith:function(a,b){return a=a||"",!(b.length>a.length)&&a.substring(0,b.length)===b},domNodeIsContainedBy:function(a,b){if(a===b)return!0;if(11===a.nodeType)return!1;if(b.contains)return b.contains(3===a.nodeType?a.parentNode:a);if(b.compareDocumentPosition)return 16==(16&b.compareDocumentPosition(a));for(;a&&a!=b;)a=a.parentNode;return!!a},domNodeIsAttachedToDocument:function(a){return q.utils.domNodeIsContainedBy(a,a.ownerDocument.documentElement)},anyDomNodeIsAttachedToDocument:function(a){return!!q.utils.arrayFirst(a,q.utils.domNodeIsAttachedToDocument)},tagNameLower:function(a){return a&&a.tagName&&a.tagName.toLowerCase()},catchFunctionErrors:function(a){return q.onError?function(){try{return a.apply(this,arguments)}catch(a){throw q.onError&&q.onError(a),a}}:a},setTimeout:function(a,b){return setTimeout(q.utils.catchFunctionErrors(a),b)},deferError:function(a){setTimeout(function(){throw q.onError&&q.onError(a),a},0)},registerEventHandler:function(a,b,c){var d=q.utils.catchFunctionErrors(c),f=s&&r[b];if(q.options.useOnlyNativeEvents||f||!e)if(f||"function"!=typeof a.addEventListener){if(void 0===a.attachEvent)throw new Error("Browser doesn't support addEventListener or attachEvent");var g=function(b){d.call(a,b)},h="on"+b;a.attachEvent(h,g),q.utils.domNodeDisposal.addDisposeCallback(a,function(){a.detachEvent(h,g)})}else a.addEventListener(b,d,!1);else e(a).bind(b,d)},triggerEvent:function(a,d){if(!a||!a.nodeType)throw new Error("element must be a DOM node when calling triggerEvent");var f=j(a,d);if(q.options.useOnlyNativeEvents||!e||f)if("function"==typeof c.createEvent){if("function"!=typeof a.dispatchEvent)throw new Error("The supplied element doesn't support dispatchEvent");var g=p[d]||"HTMLEvents",h=c.createEvent(g);h.initEvent(d,!0,!0,b,0,0,0,0,0,!1,!1,!1,!1,0,a),a.dispatchEvent(h)}else if(f&&a.click)a.click();else{if(void 0===a.fireEvent)throw new Error("Browser doesn't support triggering events");a.fireEvent("on"+d)}else e(a).trigger(d)},unwrapObservable:function(a){return q.isObservable(a)?a():a},peekObservable:function(a){return q.isObservable(a)?a.peek():a},toggleDomNodeCssClass:k,setTextContent:function(b,c){var d=q.utils.unwrapObservable(c);null!==d&&d!==a||(d="");var e=q.virtualElements.firstChild(b);!e||3!=e.nodeType||q.virtualElements.nextSibling(e)?q.virtualElements.setDomNodeChildren(b,[b.ownerDocument.createTextNode(d)]):e.data=d,q.utils.forceRefresh(b)},setElementName:function(a,b){if(a.name=b,s<=7)try{a.mergeAttributes(c.createElement("<input name='"+a.name+"'/>"),!1)}catch(a){}},forceRefresh:function(a){if(s>=9){var b=1==a.nodeType?a:a.parentNode;b.style&&(b.style.zoom=b.style.zoom)}},ensureSelectElementIsRenderedCorrectly:function(a){if(s){var b=a.style.width;a.style.width=0,a.style.width=b}},range:function(a,b){a=q.utils.unwrapObservable(a),b=q.utils.unwrapObservable(b);for(var c=[],d=a;d<=b;d++)c.push(d);return c},makeArray:function(a){for(var b=[],c=0,d=a.length;c<d;c++)b.push(a[c]);return b},createSymbolOrString:function(a){return n?Symbol(a):a},isIe6:t,isIe7:u,ieVersion:s,getFormFields:function(a,b){for(var c=q.utils.makeArray(a.getElementsByTagName("input")).concat(q.utils.makeArray(a.getElementsByTagName("textarea"))),d="string"==typeof b?function(a){return a.name===b}:function(a){return b.test(a.name)},e=[],f=c.length-1;f>=0;f--)d(c[f])&&e.push(c[f]);return e},parseJson:function(a){return"string"==typeof a&&(a=q.utils.stringTrim(a))?f&&f.parse?f.parse(a):new Function("return "+a)():null},stringifyJson:function(a,b,c){if(!f||!f.stringify)throw new Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return f.stringify(q.utils.unwrapObservable(a),b,c)},postJson:function(a,b,d){d=d||{};var e=d.params||{},f=d.includeFields||this.fieldsIncludedWithJsonPost,h=a;if("object"==typeof a&&"form"===q.utils.tagNameLower(a)){var i=a;h=i.action;for(var j=f.length-1;j>=0;j--)for(var k=q.utils.getFormFields(i,f[j]),l=k.length-1;l>=0;l--)e[k[l].name]=k[l].value}b=q.utils.unwrapObservable(b);var m=c.createElement("form");m.style.display="none",m.action=h,m.method="post";for(var n in b){var o=c.createElement("input");o.type="hidden",o.name=n,o.value=q.utils.stringifyJson(q.utils.unwrapObservable(b[n])),m.appendChild(o)}g(e,function(a,b){var d=c.createElement("input");d.type="hidden",d.name=a,d.value=b,m.appendChild(d)}),c.body.appendChild(m),d.submitter?d.submitter(m):m.submit(),setTimeout(function(){m.parentNode.removeChild(m)},0)}}}(),q.exportSymbol("utils",q.utils),q.exportSymbol("utils.arrayForEach",q.utils.arrayForEach),q.exportSymbol("utils.arrayFirst",q.utils.arrayFirst),q.exportSymbol("utils.arrayFilter",q.utils.arrayFilter),q.exportSymbol("utils.arrayGetDistinctValues",q.utils.arrayGetDistinctValues),q.exportSymbol("utils.arrayIndexOf",q.utils.arrayIndexOf),q.exportSymbol("utils.arrayMap",q.utils.arrayMap),q.exportSymbol("utils.arrayPushAll",q.utils.arrayPushAll),q.exportSymbol("utils.arrayRemoveItem",q.utils.arrayRemoveItem),q.exportSymbol("utils.extend",q.utils.extend),q.exportSymbol("utils.fieldsIncludedWithJsonPost",q.utils.fieldsIncludedWithJsonPost),q.exportSymbol("utils.getFormFields",q.utils.getFormFields),q.exportSymbol("utils.peekObservable",q.utils.peekObservable),q.exportSymbol("utils.postJson",q.utils.postJson),q.exportSymbol("utils.parseJson",q.utils.parseJson),q.exportSymbol("utils.registerEventHandler",q.utils.registerEventHandler),q.exportSymbol("utils.stringifyJson",q.utils.stringifyJson),q.exportSymbol("utils.range",q.utils.range),q.exportSymbol("utils.toggleDomNodeCssClass",q.utils.toggleDomNodeCssClass),q.exportSymbol("utils.triggerEvent",q.utils.triggerEvent),q.exportSymbol("utils.unwrapObservable",q.utils.unwrapObservable),q.exportSymbol("utils.objectForEach",q.utils.objectForEach),q.exportSymbol("utils.addOrRemoveItem",q.utils.addOrRemoveItem),q.exportSymbol("utils.setTextContent",q.utils.setTextContent),q.exportSymbol("unwrap",q.utils.unwrapObservable),Function.prototype.bind||(Function.prototype.bind=function(a){var b=this;if(1===arguments.length)return function(){return b.apply(a,arguments)};var c=Array.prototype.slice.call(arguments,1);return function(){var d=c.slice(0);return d.push.apply(d,arguments),b.apply(a,d)}}),q.utils.domData=new function(){function b(b,f){var g=b[d];if(!g||"null"===g||!e[g]){if(!f)return a;g=b[d]="ko"+c++,e[g]={}}return e[g]}var c=0,d="__ko__"+(new Date).getTime(),e={};return{get:function(c,d){var e=b(c,!1);return e===a?a:e[d]},set:function(c,d,e){if(e!==a||b(c,!1)!==a){b(c,!0)[d]=e}},clear:function(a){var b=a[d];return!!b&&(delete e[b],a[d]=null,!0)},nextKey:function(){return c+++d}}},q.exportSymbol("utils.domData",q.utils.domData),q.exportSymbol("utils.domData.clear",q.utils.domData.clear),q.utils.domNodeDisposal=new function(){function b(b,c){var d=q.utils.domData.get(b,g);return d===a&&c&&(d=[],q.utils.domData.set(b,g,d)),d}function c(b){q.utils.domData.set(b,g,a)}function d(a){var c=b(a,!1);if(c){c=c.slice(0);for(var d=0;d<c.length;d++)c[d](a)}q.utils.domData.clear(a),q.utils.domNodeDisposal.cleanExternalData(a),i[a.nodeType]&&f(a)}function f(a){for(var b,c=a.firstChild;b=c;)c=b.nextSibling,8===b.nodeType&&d(b)}var g=q.utils.domData.nextKey(),h={1:!0,8:!0,9:!0},i={1:!0,9:!0};return{addDisposeCallback:function(a,c){if("function"!=typeof c)throw new Error("Callback must be a function");b(a,!0).push(c)},removeDisposeCallback:function(a,d){var e=b(a,!1);e&&(q.utils.arrayRemoveItem(e,d),0==e.length&&c(a))},cleanNode:function(a){if(h[a.nodeType]&&(d(a),i[a.nodeType])){var b=[];q.utils.arrayPushAll(b,a.getElementsByTagName("*"));for(var c=0,e=b.length;c<e;c++)d(b[c])}return a},removeNode:function(a){q.cleanNode(a),a.parentNode&&a.parentNode.removeChild(a)},cleanExternalData:function(a){e&&"function"==typeof e.cleanData&&e.cleanData([a])}}},q.cleanNode=q.utils.domNodeDisposal.cleanNode,q.removeNode=q.utils.domNodeDisposal.removeNode,q.exportSymbol("cleanNode",q.cleanNode),q.exportSymbol("removeNode",q.removeNode),q.exportSymbol("utils.domNodeDisposal",q.utils.domNodeDisposal),q.exportSymbol("utils.domNodeDisposal.addDisposeCallback",q.utils.domNodeDisposal.addDisposeCallback),q.exportSymbol("utils.domNodeDisposal.removeDisposeCallback",q.utils.domNodeDisposal.removeDisposeCallback),function(){function d(a){var b=a.match(/^<([a-z]+)[ >]/);return b&&m[b[1]]||h}function f(a,e){e||(e=c);var f=e.parentWindow||e.defaultView||b,g=q.utils.stringTrim(a).toLowerCase(),h=e.createElement("div"),i=d(g),j=i[0],k="ignored<div>"+i[1]+a+i[2]+"</div>";for("function"==typeof f.innerShiv?h.appendChild(f.innerShiv(k)):(n&&e.appendChild(h),h.innerHTML=k,n&&h.parentNode.removeChild(h));j--;)h=h.lastChild;return q.utils.makeArray(h.lastChild.childNodes)}function g(a,b){if(e.parseHTML)return e.parseHTML(a,b)||[];var c=e.clean([a],b);if(c&&c[0]){for(var d=c[0];d.parentNode&&11!==d.parentNode.nodeType;)d=d.parentNode;d.parentNode&&d.parentNode.removeChild(d)}return c}var h=[0,"",""],i=[1,"<table>","</table>"],j=[2,"<table><tbody>","</tbody></table>"],k=[3,"<table><tbody><tr>","</tr></tbody></table>"],l=[1,"<select multiple='multiple'>","</select>"],m={thead:i,tbody:i,tfoot:i,tr:j,td:k,th:k,option:l,optgroup:l},n=q.utils.ieVersion<=8;q.utils.parseHtmlFragment=function(a,b){return e&&e.parseHTML?g(a,b):f(a,b)},q.utils.setHtml=function(b,c){if(q.utils.emptyDomNode(b),null!==(c=q.utils.unwrapObservable(c))&&c!==a)if("string"!=typeof c&&(c=c.toString()),e)e(b).html(c);else for(var d=q.utils.parseHtmlFragment(c,b.ownerDocument),f=0;f<d.length;f++)b.appendChild(d[f])}}(),q.exportSymbol("utils.parseHtmlFragment",q.utils.parseHtmlFragment),q.exportSymbol("utils.setHtml",q.utils.setHtml),q.memoization=function(){function b(){return(4294967296*(1+Math.random())|0).toString(16).substring(1)}function c(){return b()+b()}function d(a,b){if(a)if(8==a.nodeType){var c=q.memoization.parseMemoText(a.nodeValue);null!=c&&b.push({domNode:a,memoId:c})}else if(1==a.nodeType)for(var e=0,f=a.childNodes,g=f.length;e<g;e++)d(f[e],b)}var e={};return{memoize:function(a){if("function"!=typeof a)throw new Error("You can only pass a function to ko.memoization.memoize()");var b=c();return e[b]=a,
"\x3c!--[ko_memo:"+b+"]--\x3e"},unmemoize:function(b,c){var d=e[b];if(d===a)throw new Error("Couldn't find any memo with ID "+b+". Perhaps it's already been unmemoized.");try{return d.apply(null,c||[]),!0}finally{delete e[b]}},unmemoizeDomNodeAndDescendants:function(a,b){var c=[];d(a,c);for(var e=0,f=c.length;e<f;e++){var g=c[e].domNode,h=[g];b&&q.utils.arrayPushAll(h,b),q.memoization.unmemoize(c[e].memoId,h),g.nodeValue="",g.parentNode&&g.parentNode.removeChild(g)}},parseMemoText:function(a){var b=a.match(/^\[ko_memo\:(.*?)\]$/);return b?b[1]:null}}}(),q.exportSymbol("memoization",q.memoization),q.exportSymbol("memoization.memoize",q.memoization.memoize),q.exportSymbol("memoization.unmemoize",q.memoization.unmemoize),q.exportSymbol("memoization.parseMemoText",q.memoization.parseMemoText),q.exportSymbol("memoization.unmemoizeDomNodeAndDescendants",q.memoization.unmemoizeDomNodeAndDescendants),q.tasks=function(){function a(){if(h)for(var a,b=h,c=0;j<h;)if(a=g[j++]){if(j>b){if(++c>=5e3){j=h,q.utils.deferError(Error("'Too much recursion' after processing "+c+" task groups."));break}b=h}try{a()}catch(a){q.utils.deferError(a)}}}function d(){a(),j=h=g.length=0}function e(){q.tasks.scheduler(d)}var f,g=[],h=0,i=1,j=0;return f=b.MutationObserver?function(a){var b=c.createElement("div");return new MutationObserver(a).observe(b,{attributes:!0}),function(){b.classList.toggle("foo")}}(d):c&&"onreadystatechange"in c.createElement("script")?function(a){var b=c.createElement("script");b.onreadystatechange=function(){b.onreadystatechange=null,c.documentElement.removeChild(b),b=null,a()},c.documentElement.appendChild(b)}:function(a){setTimeout(a,0)},{scheduler:f,schedule:function(a){return h||e(),g[h++]=a,i++},cancel:function(a){var b=a-(i-h);b>=j&&b<h&&(g[b]=null)},resetForTesting:function(){var a=h-j;return j=h=g.length=0,a},runEarly:a}}(),q.exportSymbol("tasks",q.tasks),q.exportSymbol("tasks.schedule",q.tasks.schedule),q.exportSymbol("tasks.runEarly",q.tasks.runEarly),q.extenders={throttle:function(a,b){a.throttleEvaluation=b;var c=null;return q.dependentObservable({read:a,write:function(d){clearTimeout(c),c=q.utils.setTimeout(function(){a(d)},b)}})},rateLimit:function(a,b){var c,d,e;"number"==typeof b?c=b:(c=b.timeout,d=b.method),a._deferUpdates=!1,e="notifyWhenChangesStop"==d?k:j,a.limit(function(a){return e(a,c)})},deferred:function(b,c){if(!0!==c)throw new Error("The 'deferred' extender only accepts the value 'true', because it is not supported to turn deferral off once enabled.");b._deferUpdates||(b._deferUpdates=!0,b.limit(function(c){var d;return function(){q.tasks.cancel(d),d=q.tasks.schedule(c),b.notifySubscribers(a,"dirty")}}))},notify:function(a,b){a.equalityComparer="always"==b?null:i}};var r={undefined:1,boolean:1,number:1,string:1};q.exportSymbol("extenders",q.extenders),q.subscription=function(a,b,c){this._target=a,this.callback=b,this.disposeCallback=c,this.isDisposed=!1,q.exportProperty(this,"dispose",this.dispose)},q.subscription.prototype.dispose=function(){this.isDisposed=!0,this.disposeCallback()},q.subscribable=function(){q.utils.setPrototypeOfOrExtend(this,t),t.init(this)};var s="change",t={init:function(a){a._subscriptions={},a._versionNumber=1},subscribe:function(a,b,c){var d=this;c=c||s;var e=b?a.bind(b):a,f=new q.subscription(d,e,function(){q.utils.arrayRemoveItem(d._subscriptions[c],f),d.afterSubscriptionRemove&&d.afterSubscriptionRemove(c)});return d.beforeSubscriptionAdd&&d.beforeSubscriptionAdd(c),d._subscriptions[c]||(d._subscriptions[c]=[]),d._subscriptions[c].push(f),f},notifySubscribers:function(a,b){if(b=b||s,b===s&&this.updateVersion(),this.hasSubscriptionsForEvent(b))try{q.dependencyDetection.begin();for(var c,d=this._subscriptions[b].slice(0),e=0;c=d[e];++e)c.isDisposed||c.callback(a)}finally{q.dependencyDetection.end()}},getVersion:function(){return this._versionNumber},hasChanged:function(a){return this.getVersion()!==a},updateVersion:function(){++this._versionNumber},limit:function(a){var b,c,d,e=this,f=q.isObservable(e);e._origNotifySubscribers||(e._origNotifySubscribers=e.notifySubscribers,e.notifySubscribers=m);var g=a(function(){e._notificationIsPending=!1,f&&d===e&&(d=e()),b=!1,e.isDifferent(c,d)&&e._origNotifySubscribers(c=d)});e._limitChange=function(a){e._notificationIsPending=b=!0,d=a,g()},e._limitBeforeChange=function(a){b||(c=a,e._origNotifySubscribers(a,"beforeChange"))}},hasSubscriptionsForEvent:function(a){return this._subscriptions[a]&&this._subscriptions[a].length},getSubscriptionsCount:function(a){if(a)return this._subscriptions[a]&&this._subscriptions[a].length||0;var b=0;return q.utils.objectForEach(this._subscriptions,function(a,c){"dirty"!==a&&(b+=c.length)}),b},isDifferent:function(a,b){return!this.equalityComparer||!this.equalityComparer(a,b)},extend:l};q.exportProperty(t,"subscribe",t.subscribe),q.exportProperty(t,"extend",t.extend),q.exportProperty(t,"getSubscriptionsCount",t.getSubscriptionsCount),q.utils.canSetPrototype&&q.utils.setPrototypeOf(t,Function.prototype),q.subscribable.fn=t,q.isSubscribable=function(a){return null!=a&&"function"==typeof a.subscribe&&"function"==typeof a.notifySubscribers},q.exportSymbol("subscribable",q.subscribable),q.exportSymbol("isSubscribable",q.isSubscribable),q.computedContext=q.dependencyDetection=function(){function a(){return++f}function b(a){e.push(d),d=a}function c(){d=e.pop()}var d,e=[],f=0;return{begin:b,end:c,registerDependency:function(b){if(d){if(!q.isSubscribable(b))throw new Error("Only subscribable things can act as dependencies");d.callback.call(d.callbackTarget,b,b._id||(b._id=a()))}},ignore:function(a,d,e){try{return b(),a.apply(d,e||[])}finally{c()}},getDependenciesCount:function(){if(d)return d.computed.getDependenciesCount()},isInitial:function(){if(d)return d.isInitial}}}(),q.exportSymbol("computedContext",q.computedContext),q.exportSymbol("computedContext.getDependenciesCount",q.computedContext.getDependenciesCount),q.exportSymbol("computedContext.isInitial",q.computedContext.isInitial),q.exportSymbol("ignoreDependencies",q.ignoreDependencies=q.dependencyDetection.ignore);var u=q.utils.createSymbolOrString("_latestValue");q.observable=function(a){function b(){return arguments.length>0?(b.isDifferent(b[u],arguments[0])&&(b.valueWillMutate(),b[u]=arguments[0],b.valueHasMutated()),this):(q.dependencyDetection.registerDependency(b),b[u])}return b[u]=a,q.utils.canSetPrototype||q.utils.extend(b,q.subscribable.fn),q.subscribable.fn.init(b),q.utils.setPrototypeOfOrExtend(b,v),q.options.deferUpdates&&q.extenders.deferred(b,!0),b};var v={equalityComparer:i,peek:function(){return this[u]},valueHasMutated:function(){this.notifySubscribers(this[u])},valueWillMutate:function(){this.notifySubscribers(this[u],"beforeChange")}};q.utils.canSetPrototype&&q.utils.setPrototypeOf(v,q.subscribable.fn);var w=q.observable.protoProperty="__ko_proto__";v[w]=q.observable,q.hasPrototype=function(b,c){return null!==b&&b!==a&&b[w]!==a&&(b[w]===c||q.hasPrototype(b[w],c))},q.isObservable=function(a){return q.hasPrototype(a,q.observable)},q.isWriteableObservable=function(a){return"function"==typeof a&&a[w]===q.observable||!("function"!=typeof a||a[w]!==q.dependentObservable||!a.hasWriteFunction)},q.exportSymbol("observable",q.observable),q.exportSymbol("isObservable",q.isObservable),q.exportSymbol("isWriteableObservable",q.isWriteableObservable),q.exportSymbol("isWritableObservable",q.isWriteableObservable),q.exportSymbol("observable.fn",v),q.exportProperty(v,"peek",v.peek),q.exportProperty(v,"valueHasMutated",v.valueHasMutated),q.exportProperty(v,"valueWillMutate",v.valueWillMutate),q.observableArray=function(a){if("object"!=typeof(a=a||[])||!("length"in a))throw new Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");var b=q.observable(a);return q.utils.setPrototypeOfOrExtend(b,q.observableArray.fn),b.extend({trackArrayChanges:!0})},q.observableArray.fn={remove:function(a){for(var b=this.peek(),c=[],d="function"!=typeof a||q.isObservable(a)?function(b){return b===a}:a,e=0;e<b.length;e++){var f=b[e];d(f)&&(0===c.length&&this.valueWillMutate(),c.push(f),b.splice(e,1),e--)}return c.length&&this.valueHasMutated(),c},removeAll:function(b){if(b===a){var c=this.peek(),d=c.slice(0);return this.valueWillMutate(),c.splice(0,c.length),this.valueHasMutated(),d}return b?this.remove(function(a){return q.utils.arrayIndexOf(b,a)>=0}):[]},destroy:function(a){var b=this.peek(),c="function"!=typeof a||q.isObservable(a)?function(b){return b===a}:a;this.valueWillMutate();for(var d=b.length-1;d>=0;d--){c(b[d])&&(b[d]._destroy=!0)}this.valueHasMutated()},destroyAll:function(b){return b===a?this.destroy(function(){return!0}):b?this.destroy(function(a){return q.utils.arrayIndexOf(b,a)>=0}):[]},indexOf:function(a){var b=this();return q.utils.arrayIndexOf(b,a)},replace:function(a,b){var c=this.indexOf(a);c>=0&&(this.valueWillMutate(),this.peek()[c]=b,this.valueHasMutated())}},q.utils.canSetPrototype&&q.utils.setPrototypeOf(q.observableArray.fn,q.observable.fn),q.utils.arrayForEach(["pop","push","reverse","shift","sort","splice","unshift"],function(a){q.observableArray.fn[a]=function(){var b=this.peek();this.valueWillMutate(),this.cacheDiffForKnownOperation(b,a,arguments);var c=b[a].apply(b,arguments);return this.valueHasMutated(),c===b?this:c}}),q.utils.arrayForEach(["slice"],function(a){q.observableArray.fn[a]=function(){var b=this();return b[a].apply(b,arguments)}}),q.exportSymbol("observableArray",q.observableArray);var x="arrayChange";q.extenders.trackArrayChanges=function(a,b){function c(){if(!f){f=!0;var b=a.notifySubscribers;a.notifySubscribers=function(a,c){return c&&c!==s||++h,b.apply(this,arguments)};var c=[].concat(a.peek()||[]);g=null,e=a.subscribe(function(b){if(b=[].concat(b||[]),a.hasSubscriptionsForEvent(x))var e=d(c,b);c=b,g=null,h=0,e&&e.length&&a.notifySubscribers(e,x)})}}function d(b,c){return(!g||h>1)&&(g=q.utils.compareArrays(b,c,a.compareArrayOptions)),g}if(a.compareArrayOptions={},b&&"object"==typeof b&&q.utils.extend(a.compareArrayOptions,b),a.compareArrayOptions.sparse=!0,!a.cacheDiffForKnownOperation){var e,f=!1,g=null,h=0,i=a.beforeSubscriptionAdd,j=a.afterSubscriptionRemove;a.beforeSubscriptionAdd=function(b){i&&i.call(a,b),b===x&&c()},a.afterSubscriptionRemove=function(b){j&&j.call(a,b),b!==x||a.hasSubscriptionsForEvent(x)||(e.dispose(),f=!1)},a.cacheDiffForKnownOperation=function(a,b,c){function d(a,b,c){return e[e.length]={status:a,value:b,index:c}}if(f&&!h){var e=[],i=a.length,j=c.length,k=0;switch(b){case"push":k=i;case"unshift":for(var l=0;l<j;l++)d("added",c[l],k+l);break;case"pop":k=i-1;case"shift":i&&d("deleted",a[k],k);break;case"splice":for(var m=Math.min(Math.max(0,c[0]<0?i+c[0]:c[0]),i),n=1===j?i:Math.min(m+(c[1]||0),i),o=m+j-2,p=Math.max(n,o),r=[],s=[],l=m,t=2;l<p;++l,++t)l<n&&s.push(d("deleted",a[l],l)),l<o&&r.push(d("added",c[t],l));q.utils.findMovesInArrayComparison(s,r);break;default:return}g=e}}}};var y=q.utils.createSymbolOrString("_state");q.computed=q.dependentObservable=function(b,c,d){function e(){if(arguments.length>0){if("function"!=typeof f)throw new Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return f.apply(g.evaluatorFunctionTarget,arguments),this}return q.dependencyDetection.registerDependency(e),(g.isStale||g.isSleeping&&e.haveDependenciesChanged())&&e.evaluateImmediate(),g.latestValue}if("object"==typeof b?d=b:(d=d||{},b&&(d.read=b)),"function"!=typeof d.read)throw Error("Pass a function that returns the value of the ko.computed");var f=d.write,g={latestValue:a,isStale:!0,isBeingEvaluated:!1,suppressDisposalUntilDisposeWhenReturnsFalse:!1,isDisposed:!1,pure:!1,isSleeping:!1,readFunction:d.read,evaluatorFunctionTarget:c||d.owner,disposeWhenNodeIsRemoved:d.disposeWhenNodeIsRemoved||d.disposeWhenNodeIsRemoved||null,disposeWhen:d.disposeWhen||d.disposeWhen,domNodeDisposalCallback:null,dependencyTracking:{},dependenciesCount:0,evaluationTimeoutInstance:null};return e[y]=g,e.hasWriteFunction="function"==typeof f,q.utils.canSetPrototype||q.utils.extend(e,q.subscribable.fn),q.subscribable.fn.init(e),q.utils.setPrototypeOfOrExtend(e,z),d.pure?(g.pure=!0,g.isSleeping=!0,q.utils.extend(e,A)):d.deferEvaluation&&q.utils.extend(e,B),q.options.deferUpdates&&q.extenders.deferred(e,!0),g.disposeWhenNodeIsRemoved&&(g.suppressDisposalUntilDisposeWhenReturnsFalse=!0,g.disposeWhenNodeIsRemoved.nodeType||(g.disposeWhenNodeIsRemoved=null)),g.isSleeping||d.deferEvaluation||e.evaluateImmediate(),g.disposeWhenNodeIsRemoved&&e.isActive()&&q.utils.domNodeDisposal.addDisposeCallback(g.disposeWhenNodeIsRemoved,g.domNodeDisposalCallback=function(){e.dispose()}),e};var z={equalityComparer:i,getDependenciesCount:function(){return this[y].dependenciesCount},addDependencyTracking:function(a,b,c){if(this[y].pure&&b===this)throw Error("A 'pure' computed must not be called recursively");this[y].dependencyTracking[a]=c,c._order=this[y].dependenciesCount++,c._version=b.getVersion()},haveDependenciesChanged:function(){var a,b,c=this[y].dependencyTracking;for(a in c)if(c.hasOwnProperty(a)&&(b=c[a],b._target.hasChanged(b._version)))return!0},markDirty:function(){this._evalDelayed&&!this[y].isBeingEvaluated&&this._evalDelayed()},isActive:function(){return this[y].isStale||this[y].dependenciesCount>0},respondToChange:function(){this._notificationIsPending||this.evaluatePossiblyAsync()},subscribeToDependency:function(a){if(a._deferUpdates&&!this[y].disposeWhenNodeIsRemoved){var b=a.subscribe(this.markDirty,this,"dirty"),c=a.subscribe(this.respondToChange,this);return{_target:a,dispose:function(){b.dispose(),c.dispose()}}}return a.subscribe(this.evaluatePossiblyAsync,this)},evaluatePossiblyAsync:function(){var a=this,b=a.throttleEvaluation;b&&b>=0?(clearTimeout(this[y].evaluationTimeoutInstance),this[y].evaluationTimeoutInstance=q.utils.setTimeout(function(){a.evaluateImmediate(!0)},b)):a._evalDelayed?a._evalDelayed():a.evaluateImmediate(!0)},evaluateImmediate:function(a){var b=this,c=b[y],d=c.disposeWhen;if(!c.isBeingEvaluated&&!c.isDisposed){if(c.disposeWhenNodeIsRemoved&&!q.utils.domNodeIsAttachedToDocument(c.disposeWhenNodeIsRemoved)||d&&d()){if(!c.suppressDisposalUntilDisposeWhenReturnsFalse)return void b.dispose()}else c.suppressDisposalUntilDisposeWhenReturnsFalse=!1;c.isBeingEvaluated=!0;try{this.evaluateImmediate_CallReadWithDependencyDetection(a)}finally{c.isBeingEvaluated=!1}c.dependenciesCount||b.dispose()}},evaluateImmediate_CallReadWithDependencyDetection:function(b){var c=this,d=c[y],e=d.pure?a:!d.dependenciesCount,f={computedObservable:c,disposalCandidates:d.dependencyTracking,disposalCount:d.dependenciesCount};q.dependencyDetection.begin({callbackTarget:f,callback:o,computed:c,isInitial:e}),d.dependencyTracking={},d.dependenciesCount=0;var g=this.evaluateImmediate_CallReadThenEndDependencyDetection(d,f);c.isDifferent(d.latestValue,g)&&(d.isSleeping||c.notifySubscribers(d.latestValue,"beforeChange"),d.latestValue=g,d.isSleeping?c.updateVersion():b&&c.notifySubscribers(d.latestValue)),e&&c.notifySubscribers(d.latestValue,"awake")},evaluateImmediate_CallReadThenEndDependencyDetection:function(a,b){try{var c=a.readFunction;return a.evaluatorFunctionTarget?c.call(a.evaluatorFunctionTarget):c()}finally{q.dependencyDetection.end(),b.disposalCount&&!a.isSleeping&&q.utils.objectForEach(b.disposalCandidates,n),a.isStale=!1}},peek:function(){var a=this[y];return(a.isStale&&!a.dependenciesCount||a.isSleeping&&this.haveDependenciesChanged())&&this.evaluateImmediate(),a.latestValue},limit:function(a){q.subscribable.fn.limit.call(this,a),this._evalDelayed=function(){this._limitBeforeChange(this[y].latestValue),this[y].isStale=!0,this._limitChange(this)}},dispose:function(){var a=this[y];!a.isSleeping&&a.dependencyTracking&&q.utils.objectForEach(a.dependencyTracking,function(a,b){b.dispose&&b.dispose()}),a.disposeWhenNodeIsRemoved&&a.domNodeDisposalCallback&&q.utils.domNodeDisposal.removeDisposeCallback(a.disposeWhenNodeIsRemoved,a.domNodeDisposalCallback),a.dependencyTracking=null,a.dependenciesCount=0,a.isDisposed=!0,a.isStale=!1,a.isSleeping=!1,a.disposeWhenNodeIsRemoved=null}},A={beforeSubscriptionAdd:function(a){var b=this,c=b[y];if(!c.isDisposed&&c.isSleeping&&"change"==a){if(c.isSleeping=!1,c.isStale||b.haveDependenciesChanged())c.dependencyTracking=null,c.dependenciesCount=0,c.isStale=!0,b.evaluateImmediate();else{var d=[];q.utils.objectForEach(c.dependencyTracking,function(a,b){d[b._order]=a}),q.utils.arrayForEach(d,function(a,d){var e=c.dependencyTracking[a],f=b.subscribeToDependency(e._target);f._order=d,f._version=e._version,c.dependencyTracking[a]=f})}c.isDisposed||b.notifySubscribers(c.latestValue,"awake")}},afterSubscriptionRemove:function(b){var c=this[y];c.isDisposed||"change"!=b||this.hasSubscriptionsForEvent("change")||(q.utils.objectForEach(c.dependencyTracking,function(a,b){b.dispose&&(c.dependencyTracking[a]={_target:b._target,_order:b._order,_version:b._version},b.dispose())}),c.isSleeping=!0,this.notifySubscribers(a,"asleep"))},getVersion:function(){var a=this[y];return a.isSleeping&&(a.isStale||this.haveDependenciesChanged())&&this.evaluateImmediate(),q.subscribable.fn.getVersion.call(this)}},B={beforeSubscriptionAdd:function(a){"change"!=a&&"beforeChange"!=a||this.peek()}};q.utils.canSetPrototype&&q.utils.setPrototypeOf(z,q.subscribable.fn);var C=q.observable.protoProperty;q.computed[C]=q.observable,z[C]=q.computed,q.isComputed=function(a){return q.hasPrototype(a,q.computed)},q.isPureComputed=function(a){return q.hasPrototype(a,q.computed)&&a[y]&&a[y].pure},q.exportSymbol("computed",q.computed),q.exportSymbol("dependentObservable",q.computed),q.exportSymbol("isComputed",q.isComputed),q.exportSymbol("isPureComputed",q.isPureComputed),q.exportSymbol("computed.fn",z),q.exportProperty(z,"peek",z.peek),q.exportProperty(z,"dispose",z.dispose),q.exportProperty(z,"isActive",z.isActive),q.exportProperty(z,"getDependenciesCount",z.getDependenciesCount),q.pureComputed=function(a,b){return"function"==typeof a?q.computed(a,b,{pure:!0}):(a=q.utils.extend({},a),a.pure=!0,q.computed(a,b))},q.exportSymbol("pureComputed",q.pureComputed),function(){function b(e,f,g){if(g=g||new d,!!("object"!=typeof(e=f(e))||null===e||e===a||e instanceof RegExp||e instanceof Date||e instanceof String||e instanceof Number||e instanceof Boolean))return e;var h=e instanceof Array?[]:{};return g.save(e,h),c(e,function(c){var d=f(e[c]);switch(typeof d){case"boolean":case"number":case"string":case"function":h[c]=d;break;case"object":case"undefined":var i=g.get(d);h[c]=i!==a?i:b(d,f,g)}}),h}function c(a,b){if(a instanceof Array){for(var c=0;c<a.length;c++)b(c);"function"==typeof a.toJSON&&b("toJSON")}else for(var d in a)b(d)}function d(){this.keys=[],this.values=[]}q.toJS=function(a){if(0==arguments.length)throw new Error("When calling ko.toJS, pass the object you want to convert.");return b(a,function(a){for(var b=0;q.isObservable(a)&&b<10;b++)a=a();return a})},q.toJSON=function(a,b,c){var d=q.toJS(a);return q.utils.stringifyJson(d,b,c)},d.prototype={constructor:d,save:function(a,b){var c=q.utils.arrayIndexOf(this.keys,a);c>=0?this.values[c]=b:(this.keys.push(a),this.values.push(b))},get:function(b){var c=q.utils.arrayIndexOf(this.keys,b);return c>=0?this.values[c]:a}}}(),q.exportSymbol("toJS",q.toJS),q.exportSymbol("toJSON",q.toJSON),function(){q.selectExtensions={readValue:function(b){switch(q.utils.tagNameLower(b)){case"option":return!0===b.__ko__hasDomDataOptionValue__?q.utils.domData.get(b,q.bindingHandlers.options.optionValueDomDataKey):q.utils.ieVersion<=7?b.getAttributeNode("value")&&b.getAttributeNode("value").specified?b.value:b.text:b.value;case"select":return b.selectedIndex>=0?q.selectExtensions.readValue(b.options[b.selectedIndex]):a;default:return b.value}},writeValue:function(b,c,d){switch(q.utils.tagNameLower(b)){case"option":switch(typeof c){case"string":q.utils.domData.set(b,q.bindingHandlers.options.optionValueDomDataKey,a),"__ko__hasDomDataOptionValue__"in b&&delete b.__ko__hasDomDataOptionValue__,b.value=c;break;default:q.utils.domData.set(b,q.bindingHandlers.options.optionValueDomDataKey,c),b.__ko__hasDomDataOptionValue__=!0,b.value="number"==typeof c?c:""}break;case"select":""!==c&&null!==c||(c=a);for(var e,f=-1,g=0,h=b.options.length;g<h;++g)if((e=q.selectExtensions.readValue(b.options[g]))==c||""==e&&c===a){f=g;break}(d||f>=0||c===a&&b.size>1)&&(b.selectedIndex=f);break;default:null!==c&&c!==a||(c=""),b.value=c}}}}(),q.exportSymbol("selectExtensions",q.selectExtensions),q.exportSymbol("selectExtensions.readValue",q.selectExtensions.readValue),q.exportSymbol("selectExtensions.writeValue",q.selectExtensions.writeValue),q.expressionRewriting=function(){function a(a){if(q.utils.arrayIndexOf(d,a)>=0)return!1;var b=a.match(e);return null!==b&&(b[1]?"Object("+b[1]+")"+b[2]:a)}function b(a){var b=q.utils.stringTrim(a);123===b.charCodeAt(0)&&(b=b.slice(1,-1));var c,d=[],e=b.match(f),i=[],j=0;if(e){e.push(",");for(var k,l=0;k=e[l];++l){var m=k.charCodeAt(0);if(44===m){if(j<=0){d.push(c&&i.length?{key:c,value:i.join("")}:{unknown:c||i.join("")}),c=j=0,i=[];continue}}else if(58===m){if(!j&&!c&&1===i.length){c=i.pop();continue}}else if(47===m&&l&&k.length>1){var n=e[l-1].match(g);n&&!h[n[0]]&&(b=b.substr(b.indexOf(k)+1),e=b.match(f),e.push(","),l=-1,k="/")}else 40===m||123===m||91===m?++j:41===m||125===m||93===m?--j:c||i.length||34!==m&&39!==m||(k=k.slice(1,-1));i.push(k)}}return d}function c(c,d){function e(b,c){var d;if(!j){if(!function(a){return!a||!a.preprocess||(c=a.preprocess(c,b,e))}(q.getBindingHandler(b)))return;i[b]&&(d=a(c))&&g.push("'"+b+"':function(_z){"+d+"=_z}")}h&&(c="function(){return "+c+" }"),f.push("'"+b+"':"+c)}d=d||{};var f=[],g=[],h=d.valueAccessors,j=d.bindingParams,k="string"==typeof c?b(c):c;return q.utils.arrayForEach(k,function(a){e(a.key||a.unknown,a.value)}),g.length&&e("_ko_property_writers","{"+g.join(",")+" }"),f.join(",")}var d=["true","false","null","undefined"],e=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,f=RegExp("\"(?:[^\"\\\\]|\\\\.)*\"|'(?:[^'\\\\]|\\\\.)*'|/(?:[^/\\\\]|\\\\.)*/w*|[^\\s:,/][^,\"'{}()/:[\\]]*[^\\s,\"'{}()/:[\\]]|[^\\s]","g"),g=/[\])"'A-Za-z0-9_$]+$/,h={in:1,return:1,typeof:1},i={};return{bindingRewriteValidators:[],twoWayBindings:i,parseObjectLiteral:b,preProcessBindings:c,keyValueArrayContainsKey:function(a,b){for(var c=0;c<a.length;c++)if(a[c].key==b)return!0;return!1},writeValueToProperty:function(a,b,c,d,e){if(a&&q.isObservable(a))!q.isWriteableObservable(a)||e&&a.peek()===d||a(d);else{var f=b.get("_ko_property_writers");f&&f[c]&&f[c](d)}}}}(),q.exportSymbol("expressionRewriting",q.expressionRewriting),q.exportSymbol("expressionRewriting.bindingRewriteValidators",q.expressionRewriting.bindingRewriteValidators),q.exportSymbol("expressionRewriting.parseObjectLiteral",q.expressionRewriting.parseObjectLiteral),q.exportSymbol("expressionRewriting.preProcessBindings",q.expressionRewriting.preProcessBindings),q.exportSymbol("expressionRewriting._twoWayBindings",q.expressionRewriting.twoWayBindings),q.exportSymbol("jsonExpressionRewriting",q.expressionRewriting),q.exportSymbol("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",q.expressionRewriting.preProcessBindings),function(){function a(a){return 8==a.nodeType&&h.test(g?a.text:a.nodeValue)}function b(a){return 8==a.nodeType&&i.test(g?a.text:a.nodeValue)}function d(c,d){for(var e=c,f=1,g=[];e=e.nextSibling;){if(b(e)&&0===--f)return g;g.push(e),a(e)&&f++}if(!d)throw new Error("Cannot find closing comment tag to match: "+c.nodeValue);return null}function e(a,b){var c=d(a,b);return c?c.length>0?c[c.length-1].nextSibling:a.nextSibling:null}function f(c){var d=c.firstChild,f=null;if(d)do{if(f)f.push(d);else if(a(d)){var g=e(d,!0);g?d=g:f=[d]}else b(d)&&(f=[d])}while(d=d.nextSibling);return f}var g=c&&"\x3c!--test--\x3e"===c.createComment("test").text,h=g?/^<!--\s*ko(?:\s+([\s\S]+))?\s*-->$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,i=g?/^<!--\s*\/ko\s*-->$/:/^\s*\/ko\s*$/,j={ul:!0,ol:!0};q.virtualElements={allowedBindings:{},childNodes:function(b){return a(b)?d(b):b.childNodes},emptyNode:function(b){if(a(b))for(var c=q.virtualElements.childNodes(b),d=0,e=c.length;d<e;d++)q.removeNode(c[d]);else q.utils.emptyDomNode(b)},setDomNodeChildren:function(b,c){if(a(b)){q.virtualElements.emptyNode(b);for(var d=b.nextSibling,e=0,f=c.length;e<f;e++)d.parentNode.insertBefore(c[e],d)}else q.utils.setDomNodeChildren(b,c)},prepend:function(b,c){a(b)?b.parentNode.insertBefore(c,b.nextSibling):b.firstChild?b.insertBefore(c,b.firstChild):b.appendChild(c)},insertAfter:function(b,c,d){d?a(b)?b.parentNode.insertBefore(c,d.nextSibling):d.nextSibling?b.insertBefore(c,d.nextSibling):b.appendChild(c):q.virtualElements.prepend(b,c)},firstChild:function(c){return a(c)?!c.nextSibling||b(c.nextSibling)?null:c.nextSibling:c.firstChild},nextSibling:function(c){return a(c)&&(c=e(c)),c.nextSibling&&b(c.nextSibling)?null:c.nextSibling},hasBindingValue:a,virtualNodeBindingValue:function(a){var b=(g?a.text:a.nodeValue).match(h);return b?b[1]:null},normaliseVirtualElementDomStructure:function(a){if(j[q.utils.tagNameLower(a)]){var b=a.firstChild;if(b)do{if(1===b.nodeType){var c=f(b);if(c)for(var d=b.nextSibling,e=0;e<c.length;e++)d?a.insertBefore(c[e],d):a.appendChild(c[e])}}while(b=b.nextSibling)}}}}(),q.exportSymbol("virtualElements",q.virtualElements),q.exportSymbol("virtualElements.allowedBindings",q.virtualElements.allowedBindings),q.exportSymbol("virtualElements.emptyNode",q.virtualElements.emptyNode),q.exportSymbol("virtualElements.insertAfter",q.virtualElements.insertAfter),q.exportSymbol("virtualElements.prepend",q.virtualElements.prepend),q.exportSymbol("virtualElements.setDomNodeChildren",q.virtualElements.setDomNodeChildren),function(){function a(a,c,d){var e=a+(d&&d.valueAccessors||"");return c[e]||(c[e]=b(a,d))}function b(a,b){var c=q.expressionRewriting.preProcessBindings(a,b),d="with($context){with($data||{}){return{"+c+"}}}";return new Function("$context","$element",d)}q.bindingProvider=function(){this.bindingCache={}},q.utils.extend(q.bindingProvider.prototype,{nodeHasBindings:function(a){switch(a.nodeType){case 1:return null!=a.getAttribute("data-bind")||q.components.getComponentNameForNode(a);case 8:return q.virtualElements.hasBindingValue(a);default:return!1}},getBindings:function(a,b){var c=this.getBindingsString(a,b),d=c?this.parseBindingsString(c,b,a):null;return q.components.addBindingsForCustomElement(d,a,b,!1)},getBindingAccessors:function(a,b){var c=this.getBindingsString(a,b),d=c?this.parseBindingsString(c,b,a,{valueAccessors:!0}):null;return q.components.addBindingsForCustomElement(d,a,b,!0)},getBindingsString:function(a,b){switch(a.nodeType){case 1:return a.getAttribute("data-bind");case 8:return q.virtualElements.virtualNodeBindingValue(a);default:return null}},parseBindingsString:function(b,c,d,e){try{return a(b,this.bindingCache,e)(c,d)}catch(a){throw a.message="Unable to parse bindings.\nBindings value: "+b+"\nMessage: "+a.message,a}}}),q.bindingProvider.instance=new q.bindingProvider}(),q.exportSymbol("bindingProvider",q.bindingProvider),function(){function c(a){return function(){return a}}function d(a){return a()}function f(a){return q.utils.objectMap(q.dependencyDetection.ignore(a),function(b,c){return function(){return a()[c]}})}function g(a,b,d){return"function"==typeof a?f(a.bind(null,b,d)):q.utils.objectMap(a,c)}function h(a,b){return f(this.getBindings.bind(this,a,b))}function i(a){if(!q.virtualElements.allowedBindings[a])throw new Error("The binding '"+a+"' cannot be used with virtual elements")}function j(a,b,c){var d,e=q.virtualElements.firstChild(b),f=q.bindingProvider.instance,g=f.preprocessNode;if(g){for(;d=e;)e=q.virtualElements.nextSibling(d),g.call(f,d);e=q.virtualElements.firstChild(b)}for(;d=e;)e=q.virtualElements.nextSibling(d),k(a,d,c)}function k(a,b,c){var d=!0,e=1===b.nodeType;e&&q.virtualElements.normaliseVirtualElementDomStructure(b),(e&&c||q.bindingProvider.instance.nodeHasBindings(b))&&(d=m(b,null,a,c).shouldBindDescendants),d&&!o[q.utils.tagNameLower(b)]&&j(a,b,!e)}function l(a){var b=[],c={},d=[];return q.utils.objectForEach(a,function e(f){if(!c[f]){var g=q.getBindingHandler(f);g&&(g.after&&(d.push(f),q.utils.arrayForEach(g.after,function(b){if(a[b]){if(-1!==q.utils.arrayIndexOf(d,b))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+d.join(", "));e(b)}}),d.length--),b.push({key:f,handler:g})),c[f]=!0}}),b}function m(b,c,e,f){function g(){return q.utils.objectMap(o?o():k,d)}var j=q.utils.domData.get(b,p);if(!c){if(j)throw Error("You cannot apply bindings multiple times to the same element.");q.utils.domData.set(b,p,!0)}!j&&f&&q.storedBindingContextForNode(b,e);var k;if(c&&"function"!=typeof c)k=c;else{var m=q.bindingProvider.instance,n=m.getBindingAccessors||h,o=q.dependentObservable(function(){return k=c?c(e,b):n.call(m,b,e),k&&e._subscribable&&e._subscribable(),k},null,{disposeWhenNodeIsRemoved:b});k&&o.isActive()||(o=null)}var r;if(k){var s=o?function(a){return function(){return d(o()[a])}}:function(a){return k[a]};g.get=function(a){return k[a]&&d(s(a))},g.has=function(a){return a in k};var t=l(k);q.utils.arrayForEach(t,function(c){var d=c.handler.init,f=c.handler.update,h=c.key;8===b.nodeType&&i(h);try{"function"==typeof d&&q.dependencyDetection.ignore(function(){var c=d(b,s(h),g,e.$data,e);if(c&&c.controlsDescendantBindings){if(r!==a)throw new Error("Multiple bindings ("+r+" and "+h+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");r=h}}),"function"==typeof f&&q.dependentObservable(function(){f(b,s(h),g,e.$data,e)},null,{disposeWhenNodeIsRemoved:b})}catch(a){throw a.message='Unable to process binding "'+h+": "+k[h]+'"\nMessage: '+a.message,a}})}return{shouldBindDescendants:r===a}}function n(a){return a&&a instanceof q.bindingContext?a:new q.bindingContext(a)}q.bindingHandlers={};var o={script:!0,textarea:!0,template:!0};q.getBindingHandler=function(a){return q.bindingHandlers[a]},q.bindingContext=function(b,c,d,e){function f(){var a=j?b():b,f=q.utils.unwrapObservable(a);return c?(c._subscribable&&c._subscribable(),q.utils.extend(i,c),k&&(i._subscribable=k)):(i.$parents=[],i.$root=f,i.ko=q),i.$rawData=a,i.$data=f,d&&(i[d]=f),e&&e(i,c,f),i.$data}function g(){return h&&!q.utils.anyDomNodeIsAttachedToDocument(h)}var h,i=this,j="function"==typeof b&&!q.isObservable(b),k=q.dependentObservable(f,null,{disposeWhen:g,disposeWhenNodeIsRemoved:!0});k.isActive()&&(i._subscribable=k,k.equalityComparer=null,h=[],k._addNode=function(b){h.push(b),q.utils.domNodeDisposal.addDisposeCallback(b,function(b){q.utils.arrayRemoveItem(h,b),h.length||(k.dispose(),i._subscribable=k=a)})})},q.bindingContext.prototype.createChildContext=function(a,b,c){return new q.bindingContext(a,this,b,function(a,b){a.$parentContext=b,a.$parent=b.$data,a.$parents=(b.$parents||[]).slice(0),a.$parents.unshift(a.$parent),c&&c(a)})},q.bindingContext.prototype.extend=function(a){return new q.bindingContext(this._subscribable||this.$data,this,null,function(b,c){b.$rawData=c.$rawData,q.utils.extend(b,"function"==typeof a?a():a)})};var p=q.utils.domData.nextKey(),r=q.utils.domData.nextKey();q.storedBindingContextForNode=function(a,b){if(2!=arguments.length)return q.utils.domData.get(a,r);q.utils.domData.set(a,r,b),b._subscribable&&b._subscribable._addNode(a)},q.applyBindingAccessorsToNode=function(a,b,c){return 1===a.nodeType&&q.virtualElements.normaliseVirtualElementDomStructure(a),m(a,b,n(c),!0)},q.applyBindingsToNode=function(a,b,c){var d=n(c);return q.applyBindingAccessorsToNode(a,g(b,d,a),d)},q.applyBindingsToDescendants=function(a,b){1!==b.nodeType&&8!==b.nodeType||j(n(a),b,!0)},q.applyBindings=function(a,c){if(!e&&b.jQuery&&(e=b.jQuery),
c&&1!==c.nodeType&&8!==c.nodeType)throw new Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");c=c||b.document.body,k(n(a),c,!0)},q.contextFor=function(b){switch(b.nodeType){case 1:case 8:var c=q.storedBindingContextForNode(b);if(c)return c;if(b.parentNode)return q.contextFor(b.parentNode)}return a},q.dataFor=function(b){var c=q.contextFor(b);return c?c.$data:a},q.exportSymbol("bindingHandlers",q.bindingHandlers),q.exportSymbol("applyBindings",q.applyBindings),q.exportSymbol("applyBindingsToDescendants",q.applyBindingsToDescendants),q.exportSymbol("applyBindingAccessorsToNode",q.applyBindingAccessorsToNode),q.exportSymbol("applyBindingsToNode",q.applyBindingsToNode),q.exportSymbol("contextFor",q.contextFor),q.exportSymbol("dataFor",q.dataFor)}(),function(a){function b(b,c){return b.hasOwnProperty(c)?b[c]:a}function c(a,c){var e,h=b(f,a);h?h.subscribe(c):(h=f[a]=new q.subscribable,h.subscribe(c),d(a,function(b,c){var d=!(!c||!c.synchronous);g[a]={definition:b,isSynchronousComponent:d},delete f[a],e||d?h.notifySubscribers(b):q.tasks.schedule(function(){h.notifySubscribers(b)})}),e=!0)}function d(a,b){e("getConfig",[a],function(c){c?e("loadComponent",[a,c],function(a){b(a,c)}):b(null,null)})}function e(b,c,d,f){f||(f=q.components.loaders.slice(0));var g=f.shift();if(g){var h=g[b];if(h){var i=!1;if(h.apply(g,c.concat(function(a){i?d(null):null!==a?d(a):e(b,c,d,f)}))!==a&&(i=!0,!g.suppressLoaderExceptions))throw new Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}else e(b,c,d,f)}else d(null)}var f={},g={};q.components={get:function(a,d){var e=b(g,a);e?e.isSynchronousComponent?q.dependencyDetection.ignore(function(){d(e.definition)}):q.tasks.schedule(function(){d(e.definition)}):c(a,d)},clearCachedDefinition:function(a){delete g[a]},_getFirstResultFromLoaders:e},q.components.loaders=[],q.exportSymbol("components",q.components),q.exportSymbol("components.get",q.components.get),q.exportSymbol("components.clearCachedDefinition",q.components.clearCachedDefinition)}(),function(a){function d(a,b,c,d){var e={},f=2,g=function(){0==--f&&d(e)},h=c.template,i=c.viewModel;h?k(b,h,function(b){q.components._getFirstResultFromLoaders("loadTemplate",[a,b],function(a){e.template=a,g()})}):g(),i?k(b,i,function(b){q.components._getFirstResultFromLoaders("loadViewModel",[a,b],function(a){e[n]=a,g()})}):g()}function e(a,b,d){if("string"==typeof b)d(q.utils.parseHtmlFragment(b));else if(b instanceof Array)d(b);else if(j(b))d(q.utils.makeArray(b.childNodes));else if(b.element){var e=b.element;if(i(e))d(g(e));else if("string"==typeof e){var f=c.getElementById(e);f?d(g(f)):a("Cannot find element with ID "+e)}else a("Unknown element type: "+e)}else a("Unknown template value: "+b)}function f(a,b,c){if("function"==typeof b)c(function(a){return new b(a)});else if("function"==typeof b[n])c(b[n]);else if("instance"in b){var d=b.instance;c(function(a,b){return d})}else"viewModel"in b?f(a,b.viewModel,c):a("Unknown viewModel value: "+b)}function g(a){switch(q.utils.tagNameLower(a)){case"script":return q.utils.parseHtmlFragment(a.text);case"textarea":return q.utils.parseHtmlFragment(a.value);case"template":if(j(a.content))return q.utils.cloneNodes(a.content.childNodes)}return q.utils.cloneNodes(a.childNodes)}function i(a){return b.HTMLElement?a instanceof HTMLElement:a&&a.tagName&&1===a.nodeType}function j(a){return b.DocumentFragment?a instanceof DocumentFragment:a&&11===a.nodeType}function k(a,c,d){"string"==typeof c.require?h||b.require?(h||b.require)([c.require],d):a("Uses require, but no AMD loader is present"):d(c)}function l(a){return function(b){throw new Error("Component '"+a+"': "+b)}}var m={};q.components.register=function(a,b){if(!b)throw new Error("Invalid configuration for "+a);if(q.components.isRegistered(a))throw new Error("Component "+a+" is already registered");m[a]=b},q.components.isRegistered=function(a){return m.hasOwnProperty(a)},q.components.unregister=function(a){delete m[a],q.components.clearCachedDefinition(a)},q.components.defaultLoader={getConfig:function(a,b){b(m.hasOwnProperty(a)?m[a]:null)},loadComponent:function(a,b,c){var e=l(a);k(e,b,function(b){d(a,e,b,c)})},loadTemplate:function(a,b,c){e(l(a),b,c)},loadViewModel:function(a,b,c){f(l(a),b,c)}};var n="createViewModel";q.exportSymbol("components.register",q.components.register),q.exportSymbol("components.isRegistered",q.components.isRegistered),q.exportSymbol("components.unregister",q.components.unregister),q.exportSymbol("components.defaultLoader",q.components.defaultLoader),q.components.loaders.push(q.components.defaultLoader),q.components._allRegisteredComponents=m}(),function(a){function b(a,b){var c=a.getAttribute("params");if(c){var e=d.parseBindingsString(c,b,a,{valueAccessors:!0,bindingParams:!0}),f=q.utils.objectMap(e,function(b,c){return q.computed(b,null,{disposeWhenNodeIsRemoved:a})}),g=q.utils.objectMap(f,function(b,c){var d=b.peek();return b.isActive()?q.computed({read:function(){return q.utils.unwrapObservable(b())},write:q.isWriteableObservable(d)&&function(a){b()(a)},disposeWhenNodeIsRemoved:a}):d});return g.hasOwnProperty("$raw")||(g.$raw=f),g}return{$raw:{}}}q.components.getComponentNameForNode=function(a){var b=q.utils.tagNameLower(a);if(q.components.isRegistered(b)&&(-1!=b.indexOf("-")||""+a=="[object HTMLUnknownElement]"||q.utils.ieVersion<=8&&a.tagName===b))return b},q.components.addBindingsForCustomElement=function(a,c,d,e){if(1===c.nodeType){var f=q.components.getComponentNameForNode(c);if(f){if(a=a||{},a.component)throw new Error('Cannot use the "component" binding on a custom element matching a component');var g={name:f,params:b(c,d)};a.component=e?function(){return g}:g}}return a};var d=new q.bindingProvider;q.utils.ieVersion<9&&(q.components.register=function(a){return function(b){return c.createElement(b),a.apply(this,arguments)}}(q.components.register),c.createDocumentFragment=function(a){return function(){var b=a(),c=q.components._allRegisteredComponents;for(var d in c)c.hasOwnProperty(d)&&b.createElement(d);return b}}(c.createDocumentFragment))}(),function(a){function b(a,b,c){var d=b.template;if(!d)throw new Error("Component '"+a+"' has no template");var e=q.utils.cloneNodes(d);q.virtualElements.setDomNodeChildren(c,e)}function c(a,b,c,d){var e=a.createViewModel;return e?e.call(a,d,{element:b,templateNodes:c}):d}var d=0;q.bindingHandlers.component={init:function(a,e,f,g,h){var i,j,k=function(){var a=i&&i.dispose;"function"==typeof a&&a.call(i),i=null,j=null},l=q.utils.makeArray(q.virtualElements.childNodes(a));return q.utils.domNodeDisposal.addDisposeCallback(a,k),q.computed(function(){var f,g,m=q.utils.unwrapObservable(e());if("string"==typeof m?f=m:(f=q.utils.unwrapObservable(m.name),g=q.utils.unwrapObservable(m.params)),!f)throw new Error("No component name specified");var n=j=++d;q.components.get(f,function(d){if(j===n){if(k(),!d)throw new Error("Unknown component '"+f+"'");b(f,d,a);var e=c(d,a,l,g),m=h.createChildContext(e,void 0,function(a){a.$component=e,a.$componentTemplateNodes=l});i=e,q.applyBindingsToDescendants(m,a)}})},null,{disposeWhenNodeIsRemoved:a}),{controlsDescendantBindings:!0}}},q.virtualElements.allowedBindings.component=!0}();var D={class:"className",for:"htmlFor"};q.bindingHandlers.attr={update:function(b,c,d){var e=q.utils.unwrapObservable(c())||{};q.utils.objectForEach(e,function(c,d){d=q.utils.unwrapObservable(d);var e=!1===d||null===d||d===a;e&&b.removeAttribute(c),q.utils.ieVersion<=8&&c in D?(c=D[c],e?b.removeAttribute(c):b[c]=d):e||b.setAttribute(c,d.toString()),"name"===c&&q.utils.setElementName(b,e?"":d.toString())})}},function(){q.bindingHandlers.checked={after:["value","attr"],init:function(b,c,d){function e(){var a=b.checked,e=n?g():a;if(!q.computedContext.isInitial()&&(!i||a)){var f=q.dependencyDetection.ignore(c);if(k){var h=l?f.peek():f;m!==e?(a&&(q.utils.addOrRemoveItem(h,e,!0),q.utils.addOrRemoveItem(h,m,!1)),m=e):q.utils.addOrRemoveItem(h,e,a),l&&q.isWriteableObservable(f)&&f(h)}else q.expressionRewriting.writeValueToProperty(f,d,"checked",e,!0)}}function f(){var a=q.utils.unwrapObservable(c());b.checked=k?q.utils.arrayIndexOf(a,g())>=0:h?a:g()===a}var g=q.pureComputed(function(){return d.has("checkedValue")?q.utils.unwrapObservable(d.get("checkedValue")):d.has("value")?q.utils.unwrapObservable(d.get("value")):b.value}),h="checkbox"==b.type,i="radio"==b.type;if(h||i){var j=c(),k=h&&q.utils.unwrapObservable(j)instanceof Array,l=!(k&&j.push&&j.splice),m=k?g():a,n=i||k;i&&!b.name&&q.bindingHandlers.uniqueName.init(b,function(){return!0}),q.computed(e,null,{disposeWhenNodeIsRemoved:b}),q.utils.registerEventHandler(b,"click",e),q.computed(f,null,{disposeWhenNodeIsRemoved:b}),j=a}}},q.expressionRewriting.twoWayBindings.checked=!0,q.bindingHandlers.checkedValue={update:function(a,b){a.value=q.utils.unwrapObservable(b())}}}();q.bindingHandlers.css={update:function(a,b){var c=q.utils.unwrapObservable(b());null!==c&&"object"==typeof c?q.utils.objectForEach(c,function(b,c){c=q.utils.unwrapObservable(c),q.utils.toggleDomNodeCssClass(a,b,c)}):(c=q.utils.stringTrim(String(c||"")),q.utils.toggleDomNodeCssClass(a,a.__ko__cssValue,!1),a.__ko__cssValue=c,q.utils.toggleDomNodeCssClass(a,c,!0))}},q.bindingHandlers.enable={update:function(a,b){var c=q.utils.unwrapObservable(b());c&&a.disabled?a.removeAttribute("disabled"):c||a.disabled||(a.disabled=!0)}},q.bindingHandlers.disable={update:function(a,b){q.bindingHandlers.enable.update(a,function(){return!q.utils.unwrapObservable(b())})}},q.bindingHandlers.event={init:function(a,b,c,d,e){var f=b()||{};q.utils.objectForEach(f,function(f){"string"==typeof f&&q.utils.registerEventHandler(a,f,function(a){var g,h=b()[f];if(h){try{var i=q.utils.makeArray(arguments);d=e.$data,i.unshift(d),g=h.apply(d,i)}finally{!0!==g&&(a.preventDefault?a.preventDefault():a.returnValue=!1)}!1!==c.get(f+"Bubble")||(a.cancelBubble=!0,a.stopPropagation&&a.stopPropagation())}})})}},q.bindingHandlers.foreach={makeTemplateValueAccessor:function(a){return function(){var b=a(),c=q.utils.peekObservable(b);return c&&"number"!=typeof c.length?(q.utils.unwrapObservable(b),{foreach:c.data,as:c.as,includeDestroyed:c.includeDestroyed,afterAdd:c.afterAdd,beforeRemove:c.beforeRemove,afterRender:c.afterRender,beforeMove:c.beforeMove,afterMove:c.afterMove,templateEngine:q.nativeTemplateEngine.instance}):{foreach:b,templateEngine:q.nativeTemplateEngine.instance}}},init:function(a,b,c,d,e){return q.bindingHandlers.template.init(a,q.bindingHandlers.foreach.makeTemplateValueAccessor(b))},update:function(a,b,c,d,e){return q.bindingHandlers.template.update(a,q.bindingHandlers.foreach.makeTemplateValueAccessor(b),c,d,e)}},q.expressionRewriting.bindingRewriteValidators.foreach=!1,q.virtualElements.allowedBindings.foreach=!0;q.bindingHandlers.hasfocus={init:function(a,b,c){var d=function(d){a.__ko_hasfocusUpdating=!0;var e=a.ownerDocument;if("activeElement"in e){var f;try{f=e.activeElement}catch(a){f=e.body}d=f===a}var g=b();q.expressionRewriting.writeValueToProperty(g,c,"hasfocus",d,!0),a.__ko_hasfocusLastValue=d,a.__ko_hasfocusUpdating=!1},e=d.bind(null,!0),f=d.bind(null,!1);q.utils.registerEventHandler(a,"focus",e),q.utils.registerEventHandler(a,"focusin",e),q.utils.registerEventHandler(a,"blur",f),q.utils.registerEventHandler(a,"focusout",f)},update:function(a,b){var c=!!q.utils.unwrapObservable(b());a.__ko_hasfocusUpdating||a.__ko_hasfocusLastValue===c||(c?a.focus():a.blur(),!c&&a.__ko_hasfocusLastValue&&a.ownerDocument.body.focus(),q.dependencyDetection.ignore(q.utils.triggerEvent,null,[a,c?"focusin":"focusout"]))}},q.expressionRewriting.twoWayBindings.hasfocus=!0,q.bindingHandlers.hasFocus=q.bindingHandlers.hasfocus,q.expressionRewriting.twoWayBindings.hasFocus=!0,q.bindingHandlers.html={init:function(){return{controlsDescendantBindings:!0}},update:function(a,b){q.utils.setHtml(a,b())}},p("if"),p("ifnot",!1,!0),p("with",!0,!1,function(a,b){return a.createChildContext(b)});var E={};q.bindingHandlers.options={init:function(a){if("select"!==q.utils.tagNameLower(a))throw new Error("options binding applies only to SELECT elements");for(;a.length>0;)a.remove(0);return{controlsDescendantBindings:!0}},update:function(b,c,d){function e(){return q.utils.arrayFilter(b.options,function(a){return a.selected})}function f(a,b,c){var d=typeof b;return"function"==d?b(a):"string"==d?a[b]:c}function g(c,e,g){g.length&&(s=!o&&g[0].selected?[q.selectExtensions.readValue(g[0])]:[],t=!0);var h=b.ownerDocument.createElement("option");if(c===E)q.utils.setTextContent(h,d.get("optionsCaption")),q.selectExtensions.writeValue(h,a);else{var i=f(c,d.get("optionsValue"),c);q.selectExtensions.writeValue(h,q.utils.unwrapObservable(i));var j=f(c,d.get("optionsText"),i);q.utils.setTextContent(h,j)}return[h]}function h(a,c){if(t&&o)q.selectExtensions.writeValue(b,q.utils.unwrapObservable(d.get("value")),!0);else if(s.length){var e=q.utils.arrayIndexOf(s,q.selectExtensions.readValue(c[0]))>=0;q.utils.setOptionNodeSelectionState(c[0],e),t&&!e&&q.dependencyDetection.ignore(q.utils.triggerEvent,null,[b,"change"])}}var i,j,k=0==b.length,l=b.multiple,m=!k&&l?b.scrollTop:null,n=q.utils.unwrapObservable(c()),o=d.get("valueAllowUnset")&&d.has("value"),p=d.get("optionsIncludeDestroyed"),r={},s=[];o||(l?s=q.utils.arrayMap(e(),q.selectExtensions.readValue):b.selectedIndex>=0&&s.push(q.selectExtensions.readValue(b.options[b.selectedIndex]))),n&&(void 0===n.length&&(n=[n]),j=q.utils.arrayFilter(n,function(b){return p||b===a||null===b||!q.utils.unwrapObservable(b._destroy)}),d.has("optionsCaption")&&null!==(i=q.utils.unwrapObservable(d.get("optionsCaption")))&&i!==a&&j.unshift(E));var t=!1;r.beforeRemove=function(a){b.removeChild(a)};var u=h;d.has("optionsAfterRender")&&"function"==typeof d.get("optionsAfterRender")&&(u=function(b,c){h(b,c),q.dependencyDetection.ignore(d.get("optionsAfterRender"),null,[c[0],b!==E?b:a])}),q.utils.setDomNodeChildrenFromArrayMapping(b,j,g,r,u),q.dependencyDetection.ignore(function(){if(o)q.selectExtensions.writeValue(b,q.utils.unwrapObservable(d.get("value")),!0);else{var a;a=l?s.length&&e().length<s.length:s.length&&b.selectedIndex>=0?q.selectExtensions.readValue(b.options[b.selectedIndex])!==s[0]:s.length||b.selectedIndex>=0,a&&q.utils.triggerEvent(b,"change")}}),q.utils.ensureSelectElementIsRenderedCorrectly(b),m&&Math.abs(m-b.scrollTop)>20&&(b.scrollTop=m)}},q.bindingHandlers.options.optionValueDomDataKey=q.utils.domData.nextKey(),q.bindingHandlers.selectedOptions={after:["options","foreach"],init:function(a,b,c){q.utils.registerEventHandler(a,"change",function(){var d=b(),e=[];q.utils.arrayForEach(a.getElementsByTagName("option"),function(a){a.selected&&e.push(q.selectExtensions.readValue(a))}),q.expressionRewriting.writeValueToProperty(d,c,"selectedOptions",e)})},update:function(a,b){if("select"!=q.utils.tagNameLower(a))throw new Error("values binding applies only to SELECT elements");var c=q.utils.unwrapObservable(b()),d=a.scrollTop;c&&"number"==typeof c.length&&q.utils.arrayForEach(a.getElementsByTagName("option"),function(a){var b=q.utils.arrayIndexOf(c,q.selectExtensions.readValue(a))>=0;a.selected!=b&&q.utils.setOptionNodeSelectionState(a,b)}),a.scrollTop=d}},q.expressionRewriting.twoWayBindings.selectedOptions=!0,q.bindingHandlers.style={update:function(b,c){var d=q.utils.unwrapObservable(c()||{});q.utils.objectForEach(d,function(c,d){d=q.utils.unwrapObservable(d),null!==d&&d!==a&&!1!==d||(d=""),b.style[c]=d})}},q.bindingHandlers.submit={init:function(a,b,c,d,e){if("function"!=typeof b())throw new Error("The value for a submit binding must be a function");q.utils.registerEventHandler(a,"submit",function(c){var d,f=b();try{d=f.call(e.$data,a)}finally{!0!==d&&(c.preventDefault?c.preventDefault():c.returnValue=!1)}})}},q.bindingHandlers.text={init:function(){return{controlsDescendantBindings:!0}},update:function(a,b){q.utils.setTextContent(a,b())}},q.virtualElements.allowedBindings.text=!0,function(){if(b&&b.navigator)var c=function(a){if(a)return parseFloat(a[1])},d=b.opera&&b.opera.version&&parseInt(b.opera.version()),e=b.navigator.userAgent,f=c(e.match(/^(?:(?!chrome).)*version\/([^ ]*) safari/i)),g=c(e.match(/Firefox\/([^ ]*)/));if(q.utils.ieVersion<10)var h=q.utils.domData.nextKey(),i=q.utils.domData.nextKey(),j=function(a){var b=this.activeElement,c=b&&q.utils.domData.get(b,i);c&&c(a)},k=function(a,b){var c=a.ownerDocument;q.utils.domData.get(c,h)||(q.utils.domData.set(c,h,!0),q.utils.registerEventHandler(c,"selectionchange",j)),q.utils.domData.set(a,i,b)};q.bindingHandlers.textInput={init:function(b,c,e){var h,i,j=b.value,l=function(d){clearTimeout(h),i=h=a;var f=b.value;j!==f&&(j=f,q.expressionRewriting.writeValueToProperty(c(),e,"textInput",f))},m=function(a){if(!h){i=b.value;var c=l;h=q.utils.setTimeout(c,4)}},n=9==q.utils.ieVersion?m:l,o=function(){var d=q.utils.unwrapObservable(c());if(null!==d&&d!==a||(d=""),i!==a&&d===i)return void q.utils.setTimeout(o,4);b.value!==d&&(j=d,b.value=d)},p=function(a,c){q.utils.registerEventHandler(b,a,c)};q.utils.ieVersion<10?(p("propertychange",function(a){"value"===a.propertyName&&n(a)}),8==q.utils.ieVersion&&(p("keyup",l),p("keydown",l)),q.utils.ieVersion>=8&&(k(b,n),p("dragend",m))):(p("input",l),f<5&&"textarea"===q.utils.tagNameLower(b)?(p("keydown",m),p("paste",m),p("cut",m)):d<11?p("keydown",m):g<4&&(p("DOMAutoComplete",l),p("dragdrop",l),p("drop",l))),p("change",l),q.computed(o,null,{disposeWhenNodeIsRemoved:b})}},q.expressionRewriting.twoWayBindings.textInput=!0,q.bindingHandlers.textinput={preprocess:function(a,b,c){c("textInput",a)}}}(),q.bindingHandlers.uniqueName={init:function(a,b){if(b()){var c="ko_unique_"+ ++q.bindingHandlers.uniqueName.currentIndex;q.utils.setElementName(a,c)}}},q.bindingHandlers.uniqueName.currentIndex=0,q.bindingHandlers.value={after:["options","foreach"],init:function(a,b,c){if("input"==a.tagName.toLowerCase()&&("checkbox"==a.type||"radio"==a.type))return void q.applyBindingAccessorsToNode(a,{checkedValue:b});var d=["change"],e=c.get("valueUpdate"),f=!1,g=null;e&&("string"==typeof e&&(e=[e]),q.utils.arrayPushAll(d,e),d=q.utils.arrayGetDistinctValues(d));var h=function(){g=null,f=!1;var d=b(),e=q.selectExtensions.readValue(a);q.expressionRewriting.writeValueToProperty(d,c,"value",e)};q.utils.ieVersion&&"input"==a.tagName.toLowerCase()&&"text"==a.type&&"off"!=a.autocomplete&&(!a.form||"off"!=a.form.autocomplete)&&-1==q.utils.arrayIndexOf(d,"propertychange")&&(q.utils.registerEventHandler(a,"propertychange",function(){f=!0}),q.utils.registerEventHandler(a,"focus",function(){f=!1}),q.utils.registerEventHandler(a,"blur",function(){f&&h()})),q.utils.arrayForEach(d,function(b){var c=h;q.utils.stringStartsWith(b,"after")&&(c=function(){g=q.selectExtensions.readValue(a),q.utils.setTimeout(h,0)},b=b.substring("after".length)),q.utils.registerEventHandler(a,b,c)});var i=function(){var d=q.utils.unwrapObservable(b()),e=q.selectExtensions.readValue(a);if(null!==g&&d===g)return void q.utils.setTimeout(i,0);if(d!==e)if("select"===q.utils.tagNameLower(a)){var f=c.get("valueAllowUnset"),h=function(){q.selectExtensions.writeValue(a,d,f)};h(),f||d===q.selectExtensions.readValue(a)?q.utils.setTimeout(h,0):q.dependencyDetection.ignore(q.utils.triggerEvent,null,[a,"change"])}else q.selectExtensions.writeValue(a,d)};q.computed(i,null,{disposeWhenNodeIsRemoved:a})},update:function(){}},q.expressionRewriting.twoWayBindings.value=!0,q.bindingHandlers.visible={update:function(a,b){var c=q.utils.unwrapObservable(b()),d=!("none"==a.style.display);c&&!d?a.style.display="":!c&&d&&(a.style.display="none")}},function(a){q.bindingHandlers[a]={init:function(b,c,d,e,f){var g=function(){var b={};return b[a]=c(),b};return q.bindingHandlers.event.init.call(this,b,g,d,e,f)}}}("click"),q.templateEngine=function(){},q.templateEngine.prototype.renderTemplateSource=function(a,b,c,d){throw new Error("Override renderTemplateSource")},q.templateEngine.prototype.createJavaScriptEvaluatorBlock=function(a){throw new Error("Override createJavaScriptEvaluatorBlock")},q.templateEngine.prototype.makeTemplateSource=function(a,b){if("string"==typeof a){b=b||c;var d=b.getElementById(a);if(!d)throw new Error("Cannot find template with ID "+a);return new q.templateSources.domElement(d)}if(1==a.nodeType||8==a.nodeType)return new q.templateSources.anonymousTemplate(a);throw new Error("Unknown template type: "+a)},q.templateEngine.prototype.renderTemplate=function(a,b,c,d){var e=this.makeTemplateSource(a,d);return this.renderTemplateSource(e,b,c,d)},q.templateEngine.prototype.isTemplateRewritten=function(a,b){return!1===this.allowTemplateRewriting||this.makeTemplateSource(a,b).data("isRewritten")},q.templateEngine.prototype.rewriteTemplate=function(a,b,c){var d=this.makeTemplateSource(a,c),e=b(d.text());d.text(e),d.data("isRewritten",!0)},q.exportSymbol("templateEngine",q.templateEngine),q.templateRewriting=function(){function a(a){for(var b=q.expressionRewriting.bindingRewriteValidators,c=0;c<a.length;c++){var d=a[c].key;if(b.hasOwnProperty(d)){var e=b[d];if("function"==typeof e){var f=e(a[c].value);if(f)throw new Error(f)}else if(!e)throw new Error("This template engine does not support the '"+d+"' binding within its templates")}}}function b(b,c,d,e){var f=q.expressionRewriting.parseObjectLiteral(b);a(f);var g=q.expressionRewriting.preProcessBindings(f,{valueAccessors:!0}),h="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+g+" } })()},'"+d.toLowerCase()+"')";return e.createJavaScriptEvaluatorBlock(h)+c}var c=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'|[^>]*))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,d=/<!--\s*ko\b\s*([\s\S]*?)\s*-->/g;return{ensureTemplateIsRewritten:function(a,b,c){b.isTemplateRewritten(a,c)||b.rewriteTemplate(a,function(a){return q.templateRewriting.memoizeBindingAttributeSyntax(a,b)},c)},memoizeBindingAttributeSyntax:function(a,e){return a.replace(c,function(){return b(arguments[4],arguments[1],arguments[2],e)}).replace(d,function(){return b(arguments[1],"\x3c!-- ko --\x3e","#comment",e)})},applyMemoizedBindingsToNextSibling:function(a,b){return q.memoization.memoize(function(c,d){var e=c.nextSibling;e&&e.nodeName.toLowerCase()===b&&q.applyBindingAccessorsToNode(e,a,d)})}}}(),q.exportSymbol("__tr_ambtns",q.templateRewriting.applyMemoizedBindingsToNextSibling),function(){function b(a){return q.utils.domData.get(a,e)||{}}function c(a,b){q.utils.domData.set(a,e,b)}q.templateSources={};q.templateSources.domElement=function(a){if(this.domElement=a,a){var b=q.utils.tagNameLower(a);this.templateType="script"===b?1:"textarea"===b?2:"template"==b&&a.content&&11===a.content.nodeType?3:4}},q.templateSources.domElement.prototype.text=function(){var a=1===this.templateType?"text":2===this.templateType?"value":"innerHTML";if(0==arguments.length)return this.domElement[a];var b=arguments[0];"innerHTML"===a?q.utils.setHtml(this.domElement,b):this.domElement[a]=b};var d=q.utils.domData.nextKey()+"_";q.templateSources.domElement.prototype.data=function(a){if(1===arguments.length)return q.utils.domData.get(this.domElement,d+a);q.utils.domData.set(this.domElement,d+a,arguments[1])};var e=q.utils.domData.nextKey();q.templateSources.domElement.prototype.nodes=function(){var d=this.domElement;if(0==arguments.length){return b(d).containerData||(3===this.templateType?d.content:4===this.templateType?d:a)}c(d,{containerData:arguments[0]})},q.templateSources.anonymousTemplate=function(a){this.domElement=a},q.templateSources.anonymousTemplate.prototype=new q.templateSources.domElement,q.templateSources.anonymousTemplate.prototype.constructor=q.templateSources.anonymousTemplate,q.templateSources.anonymousTemplate.prototype.text=function(){if(0==arguments.length){var d=b(this.domElement);return d.textData===a&&d.containerData&&(d.textData=d.containerData.innerHTML),d.textData}var e=arguments[0];c(this.domElement,{textData:e})},q.exportSymbol("templateSources",q.templateSources),q.exportSymbol("templateSources.domElement",q.templateSources.domElement),q.exportSymbol("templateSources.anonymousTemplate",q.templateSources.anonymousTemplate)}(),function(){function b(a,b,c){for(var d,e=a,f=q.virtualElements.nextSibling(b);e&&(d=e)!==f;)e=q.virtualElements.nextSibling(d),c(d,e)}function c(a,c){if(a.length){var d=a[0],e=a[a.length-1],f=d.parentNode,g=q.bindingProvider.instance,h=g.preprocessNode;if(h){if(b(d,e,function(a,b){var c=a.previousSibling,f=h.call(g,a);f&&(a===d&&(d=f[0]||b),a===e&&(e=f[f.length-1]||c))}),a.length=0,!d)return;d===e?a.push(d):(a.push(d,e),q.utils.fixUpContinuousNodeArray(a,f))}b(d,e,function(a){1!==a.nodeType&&8!==a.nodeType||q.applyBindings(c,a)}),b(d,e,function(a){1!==a.nodeType&&8!==a.nodeType||q.memoization.unmemoizeDomNodeAndDescendants(a,[c])}),q.utils.fixUpContinuousNodeArray(a,f)}}function d(a){return a.nodeType?a:a.length>0?a[0]:null}function e(a,b,e,f,g){g=g||{};var i=a&&d(a),j=(i||e||{}).ownerDocument,k=g.templateEngine||h;q.templateRewriting.ensureTemplateIsRewritten(e,k,j);var l=k.renderTemplate(e,f,g,j);if("number"!=typeof l.length||l.length>0&&"number"!=typeof l[0].nodeType)throw new Error("Template engine must return an array of DOM nodes");var m=!1;switch(b){case"replaceChildren":q.virtualElements.setDomNodeChildren(a,l),m=!0;break;case"replaceNode":q.utils.replaceDomNodes(a,l),m=!0;break;case"ignoreTargetNode":break;default:throw new Error("Unknown renderMode: "+b)}return m&&(c(l,f),g.afterRender&&q.dependencyDetection.ignore(g.afterRender,null,[l,f.$data])),l}function f(a,b,c){return q.isObservable(a)?a():"function"==typeof a?a(b,c):a}function g(b,c){var d=q.utils.domData.get(b,i);d&&"function"==typeof d.dispose&&d.dispose(),q.utils.domData.set(b,i,c&&c.isActive()?c:a)}var h;q.setTemplateEngine=function(b){if(b!=a&&!(b instanceof q.templateEngine))throw new Error("templateEngine must inherit from ko.templateEngine");h=b},q.renderTemplate=function(b,c,g,i,j){if(g=g||{},(g.templateEngine||h)==a)throw new Error("Set a template engine before calling renderTemplate");if(j=j||"replaceChildren",i){var k=d(i),l=function(){return!k||!q.utils.domNodeIsAttachedToDocument(k)},m=k&&"replaceNode"==j?k.parentNode:k;return q.dependentObservable(function(){var a=c&&c instanceof q.bindingContext?c:new q.bindingContext(q.utils.unwrapObservable(c)),h=f(b,a.$data,a),l=e(i,j,h,a,g);"replaceNode"==j&&(i=l,k=d(i))},null,{disposeWhen:l,disposeWhenNodeIsRemoved:m})}return q.memoization.memoize(function(a){q.renderTemplate(b,c,g,a,"replaceNode")})},q.renderTemplateForEach=function(b,d,g,h,i){var j,k=function(a,c){return j=i.createChildContext(a,g.as,function(a){a.$index=c}),e(null,"ignoreTargetNode",f(b,a,j),j,g)},l=function(a,b,d){c(b,j),g.afterRender&&g.afterRender(b,a),j=null};return q.dependentObservable(function(){var b=q.utils.unwrapObservable(d)||[];void 0===b.length&&(b=[b]);var c=q.utils.arrayFilter(b,function(b){return g.includeDestroyed||b===a||null===b||!q.utils.unwrapObservable(b._destroy)});q.dependencyDetection.ignore(q.utils.setDomNodeChildrenFromArrayMapping,null,[h,c,k,g,l])},null,{disposeWhenNodeIsRemoved:h})};var i=q.utils.domData.nextKey();q.bindingHandlers.template={init:function(a,b){var c=q.utils.unwrapObservable(b());if("string"==typeof c||c.name)q.virtualElements.emptyNode(a);else if("nodes"in c){var d=c.nodes||[];if(q.isObservable(d))throw new Error('The "nodes" option must be a plain, non-observable array.');var e=q.utils.moveCleanedNodesToContainerElement(d);new q.templateSources.anonymousTemplate(a).nodes(e)}else{var f=q.virtualElements.childNodes(a),e=q.utils.moveCleanedNodesToContainerElement(f);new q.templateSources.anonymousTemplate(a).nodes(e)}return{controlsDescendantBindings:!0}},update:function(a,b,c,d,e){var f,h,i=b(),j=q.utils.unwrapObservable(i),k=!0,l=null;if("string"==typeof j?(h=i,j={}):(h=j.name,"if"in j&&(k=q.utils.unwrapObservable(j.if)),k&&"ifnot"in j&&(k=!q.utils.unwrapObservable(j.ifnot)),f=q.utils.unwrapObservable(j.data)),"foreach"in j){var m=k&&j.foreach||[];l=q.renderTemplateForEach(h||a,m,j,a,e)}else if(k){var n="data"in j?e.createChildContext(f,j.as):e;l=q.renderTemplate(h||a,n,j,a)}else q.virtualElements.emptyNode(a);g(a,l)}},q.expressionRewriting.bindingRewriteValidators.template=function(a){var b=q.expressionRewriting.parseObjectLiteral(a);return 1==b.length&&b[0].unknown?null:q.expressionRewriting.keyValueArrayContainsKey(b,"name")?null:"This template engine does not support anonymous templates nested within its templates"},q.virtualElements.allowedBindings.template=!0}(),q.exportSymbol("setTemplateEngine",q.setTemplateEngine),q.exportSymbol("renderTemplate",q.renderTemplate),q.utils.findMovesInArrayComparison=function(a,b,c){if(a.length&&b.length){var d,e,f,g,h;for(d=e=0;(!c||d<c)&&(g=a[e]);++e){for(f=0;h=b[f];++f)if(g.value===h.value){g.moved=h.index,h.moved=g.index,b.splice(f,1),d=f=0;break}d+=f}}},q.utils.compareArrays=function(){function a(a,e,f){return f="boolean"==typeof f?{dontLimitMoves:f}:f||{},a=a||[],e=e||[],a.length<e.length?b(a,e,c,d,f):b(e,a,d,c,f)}function b(a,b,c,d,e){var f,g,h,i,j,k,l=Math.min,m=Math.max,n=[],o=a.length,p=b.length,r=p-o||1,s=o+p+1;for(f=0;f<=o;f++)for(i=h,n.push(h=[]),j=l(p,f+r),k=m(0,f-1),g=k;g<=j;g++)if(g)if(f)if(a[f-1]===b[g-1])h[g]=i[g-1];else{var t=i[g]||s,u=h[g-1]||s;h[g]=l(t,u)+1}else h[g]=g+1;else h[g]=f+1;var v,w=[],x=[],y=[];for(f=o,g=p;f||g;)v=n[f][g]-1,g&&v===n[f][g-1]?x.push(w[w.length]={status:c,value:b[--g],index:g}):f&&v===n[f-1][g]?y.push(w[w.length]={status:d,value:a[--f],index:f}):(--g,--f,e.sparse||w.push({status:"retained",value:b[g]}));return q.utils.findMovesInArrayComparison(y,x,!e.dontLimitMoves&&10*o),w.reverse()}var c="added",d="deleted";return a}(),q.exportSymbol("utils.compareArrays",q.utils.compareArrays),function(){function b(b,c,d,e,f){var g=[],h=q.dependentObservable(function(){var a=c(d,f,q.utils.fixUpContinuousNodeArray(g,b))||[];g.length>0&&(q.utils.replaceDomNodes(g,a),e&&q.dependencyDetection.ignore(e,null,[d,a,f])),g.length=0,q.utils.arrayPushAll(g,a)},null,{disposeWhenNodeIsRemoved:b,disposeWhen:function(){return!q.utils.anyDomNodeIsAttachedToDocument(g)}});return{mappedNodes:g,dependentObservable:h.isActive()?h:a}}var c=q.utils.domData.nextKey(),d=q.utils.domData.nextKey();q.utils.setDomNodeChildrenFromArrayMapping=function(e,f,g,h,i){function j(a,b){l=p[b],v!==b&&(z[a]=l),l.indexObservable(v++),q.utils.fixUpContinuousNodeArray(l.mappedNodes,e),t.push(l),x.push(l)}function k(a,b){if(a)for(var c=0,d=b.length;c<d;c++)b[c]&&q.utils.arrayForEach(b[c].mappedNodes,function(d){a(d,c,b[c].arrayEntry)})}f=f||[],h=h||{};for(var l,m,n,o=q.utils.domData.get(e,c)===a,p=q.utils.domData.get(e,c)||[],r=q.utils.arrayMap(p,function(a){return a.arrayEntry}),s=q.utils.compareArrays(r,f,h.dontLimitMoves),t=[],u=0,v=0,w=[],x=[],y=[],z=[],A=[],B=0;m=s[B];B++)switch(n=m.moved,m.status){case"deleted":n===a&&(l=p[u],l.dependentObservable&&(l.dependentObservable.dispose(),l.dependentObservable=a),q.utils.fixUpContinuousNodeArray(l.mappedNodes,e).length&&(h.beforeRemove&&(t.push(l),x.push(l),l.arrayEntry===d?l=null:y[B]=l),l&&w.push.apply(w,l.mappedNodes))),u++;break;case"retained":j(B,u++);break;case"added":n!==a?j(B,n):(l={arrayEntry:m.value,indexObservable:q.observable(v++)},t.push(l),x.push(l),o||(A[B]=l))}q.utils.domData.set(e,c,t),k(h.beforeMove,z),q.utils.arrayForEach(w,h.beforeRemove?q.cleanNode:q.removeNode);for(var C,D,B=0,E=q.virtualElements.firstChild(e);l=x[B];B++){l.mappedNodes||q.utils.extend(l,b(e,g,l.arrayEntry,i,l.indexObservable));for(var F=0;D=l.mappedNodes[F];E=D.nextSibling,C=D,F++)D!==E&&q.virtualElements.insertAfter(e,D,C);!l.initialized&&i&&(i(l.arrayEntry,l.mappedNodes,l.indexObservable),l.initialized=!0)}for(k(h.beforeRemove,y),B=0;B<y.length;++B)y[B]&&(y[B].arrayEntry=d);k(h.afterMove,z),k(h.afterAdd,A)}}(),q.exportSymbol("utils.setDomNodeChildrenFromArrayMapping",q.utils.setDomNodeChildrenFromArrayMapping),q.nativeTemplateEngine=function(){
this.allowTemplateRewriting=!1},q.nativeTemplateEngine.prototype=new q.templateEngine,q.nativeTemplateEngine.prototype.constructor=q.nativeTemplateEngine,q.nativeTemplateEngine.prototype.renderTemplateSource=function(a,b,c,d){var e=!(q.utils.ieVersion<9),f=e?a.nodes:null,g=f?a.nodes():null;if(g)return q.utils.makeArray(g.cloneNode(!0).childNodes);var h=a.text();return q.utils.parseHtmlFragment(h,d)},q.nativeTemplateEngine.instance=new q.nativeTemplateEngine,q.setTemplateEngine(q.nativeTemplateEngine.instance),q.exportSymbol("nativeTemplateEngine",q.nativeTemplateEngine),function(){q.jqueryTmplTemplateEngine=function(){function a(){if(d<2)throw new Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.")}function b(a,b,c){return e.tmpl(a,b,c)}var d=this.jQueryTmplVersion=function(){if(!e||!e.tmpl)return 0;try{if(e.tmpl.tag.tmpl.open.toString().indexOf("__")>=0)return 2}catch(a){}return 1}();this.renderTemplateSource=function(d,f,g,h){h=h||c,g=g||{},a();var i=d.data("precompiled");if(!i){var j=d.text()||"";j="{{ko_with $item.koBindingContext}}"+j+"{{/ko_with}}",i=e.template(null,j),d.data("precompiled",i)}var k=[f.$data],l=e.extend({koBindingContext:f},g.templateOptions),m=b(i,k,l);return m.appendTo(h.createElement("div")),e.fragments={},m},this.createJavaScriptEvaluatorBlock=function(a){return"{{ko_code ((function() { return "+a+" })()) }}"},this.addTemplate=function(a,b){c.write("<script type='text/html' id='"+a+"'>"+b+"<\/script>")},d>0&&(e.tmpl.tag.ko_code={open:"__.push($1 || '');"},e.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},q.jqueryTmplTemplateEngine.prototype=new q.templateEngine,q.jqueryTmplTemplateEngine.prototype.constructor=q.jqueryTmplTemplateEngine;var a=new q.jqueryTmplTemplateEngine;a.jQueryTmplVersion>0&&q.setTemplateEngine(a),q.exportSymbol("jqueryTmplTemplateEngine",q.jqueryTmplTemplateEngine)}()})}()}(),Array.prototype.forEach||(Array.prototype.forEach=function(a,b){var c,d;if(null==this)throw new TypeError(" this is null or not defined");var e=Object(this),f=e.length>>>0;if("function"!=typeof a)throw new TypeError(a+" is not a function");for(arguments.length>1&&(c=b),d=0;d<f;){var g;d in e&&(g=e[d],a.call(c,g,d,e)),d++}}),Array.prototype.reduce||(Array.prototype.reduce=function(a){if(null==this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof a)throw new TypeError(a+" is not a function");var b,c=Object(this),d=c.length>>>0,e=0;if(2==arguments.length)b=arguments[1];else{for(;e<d&&!(e in c);)e++;if(e>=d)throw new TypeError("Reduce of empty array with no initial value");b=c[e++]}for(;e<d;e++)e in c&&(b=a(b,c[e],e,c));return b}),function(){var a=Function.bind.call(Function.call,Array.prototype.reduce),b=Function.bind.call(Function.call,Object.prototype.propertyIsEnumerable),c=Function.bind.call(Function.call,Array.prototype.concat),d=function(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(b);return c};Object.values||(Object.values=function(e){return a(d(e),function(a,d){return c(a,"string"==typeof d&&b(e,d)?[e[d]]:[])},[])}),Object.entries||(Object.entries=function(e){return a(d(e),function(a,d){return c(a,"string"==typeof d&&b(e,d)?[[d,e[d]]]:[])},[])})}(),Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d?this:a,b.concat(Array.prototype.slice.call(arguments)))};return this.prototype&&(d.prototype=this.prototype),e.prototype=new d,e}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(a){if(null==this)throw new TypeError('"this" is null or not defined');var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError("predicate must be a function");for(var d=arguments[1],e=0;e<c;){var f=b[e];if(a.call(d,f,e,b))return f;e++}}}),Array.from||(Array.from=function(){var a=Object.prototype.toString,b=function(b){return"function"==typeof b||"[object Function]"===a.call(b)},c=function(a){var b=Number(a);return isNaN(b)?0:0!==b&&isFinite(b)?(b>0?1:-1)*Math.floor(Math.abs(b)):b},d=Math.pow(2,53)-1,e=function(a){var b=c(a);return Math.min(Math.max(b,0),d)};return function(a){var c=this,d=Object(a);if(null==a)throw new TypeError("Array.from requires an array-like object - not null or undefined");var f,g=arguments.length>1?arguments[1]:void 0;if(void 0!==g){if(!b(g))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(f=arguments[2])}for(var h,i=e(d.length),j=b(c)?Object(new c(i)):new Array(i),k=0;k<i;)h=d[k],j[k]=g?void 0===f?g(h,k):g.call(f,h,k):h,k+=1;return j.length=i,j}}());var da=function(){function a(a){throw new RangeError(t[a])}function b(a,b){for(var c=a.length,d=[];c--;)d[c]=b(a[c]);return d}function c(a,c){var d=a.split("@"),e="";return d.length>1&&(e=d[0]+"@",a=d[1]),a=a.replace(s,"."),e+b(a.split("."),c).join(".")}function d(a){return b(a,function(a){var b="";return a>65535&&(a-=65536,b+=w(a>>>10&1023|55296),a=56320|1023&a),b+=w(a)}).join("")}function e(a){return a-48<10?a-22:a-65<26?a-65:a-97<26?a-97:j}function f(a,b,c){var d=0;for(a=c?v(a/n):a>>1,a+=v(a/b);a>u*l>>1;d+=j)a=v(a/u);return v(d+(u+1)*a/(a+m))}function g(b){var c,g,h,m,n,r,s,t,u,w,x=[],y=b.length,z=0,A=p,B=o;for(g=b.lastIndexOf(q),g<0&&(g=0),h=0;h<g;++h)b.charCodeAt(h)>=128&&a("not-basic"),x.push(b.charCodeAt(h));for(m=g>0?g+1:0;m<y;){for(n=z,r=1,s=j;m>=y&&a("invalid-input"),t=e(b.charCodeAt(m++)),(t>=j||t>v((i-z)/r))&&a("overflow"),z+=t*r,u=s<=B?k:s>=B+l?l:s-B,!(t<u);s+=j)w=j-u,r>v(i/w)&&a("overflow"),r*=w;c=x.length+1,B=f(z-n,c,0==n),v(z/c)>i-A&&a("overflow"),A+=v(z/c),z%=c,x.splice(z++,0,A)}return d(x)}function h(a){return c(a,function(a){return r.test(a)?g(a.slice(4).toLowerCase()):a})}var i=2147483647,j=36,k=1,l=26,m=38,n=700,o=72,p=128,q="-",r=/^xn--/,s=/[\x2E\u3002\uFF0E\uFF61]/g,t={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},u=j-k,v=Math.floor,w=String.fromCharCode;return{version:"1.4.1",ucs2:{encode:d},decode:g,toUnicode:h}}(),ea=function(a,b){return CBHCore.lang.translate(a,b)},fa=function(a){this.__=a};fa.prototype._=function(a){return void 0===a||null===a?"":a},fa.prototype["banner_action-timer"]=function(a){a=a||{};return'<div class="action-timer" data-bind="visible: timerIsValid()"><span class="timer-title" data-bind="text: timerTitleText, style: {color: timerColor}"></span><div class="timer-body" data-bind="style: {color: timerColor}"><span class="days digit-item" data-bind="visible: daysLeft() !== \'00\'"><span class="digit-spacer">:</span><span class="digits"><span class="digit-value" data-bind="text: daysLeft"></span><br/><span class="digit-name" data-bind="text: __(\'when.time_no_number.days\', { num: daysLeft() })"></span></span></span><span class="hours digit-item"><span class="digit-spacer">:</span><span class="digits"><span class="digit-value" data-bind="text: hoursLeft"></span><br/><span class="digit-name" data-bind="text: __(\'when.time_no_number.hours\', { num: hoursLeft() })"></span></span></span><span class="minutes digit-item"><span class="digit-spacer">:</span><span class="digits"><span class="digit-value" data-bind="text: minutesLeft"></span><br/><span class="digit-name" data-bind="text: __(\'when.time_no_number.minutes\', { num: minutesLeft() })"></span></span></span><span class="seconds digit-item"><span class="digits"><span class="digit-value" data-bind="text: secondsLeft"></span><br/><span class="digit-name" data-bind="text: __(\'when.time_no_number.seconds\', { num: secondsLeft() })"></span></span></span></div></div>'},fa.prototype.banner_background=function(a){a=a||{};return'\x3c!-- ko if: hasCarrousel --\x3e<div class="left"><div class="bg animated" data-bind="css: {fallback: fallback,active: !oddCounter()}"><div data-bind="style: {backgroundImage: backgroundImage}"></div></div><div class="bg animated" data-bind="css: {fallback: fallback,active: oddCounter}"><div data-bind="style: {backgroundImage: backgroundImageNext}"></div></div><div class="text-wrapper"><span class="title" data-bind="text: titleText, style: {color: titleColor}"></span><span class="subtitle" data-bind="text: subtitleText, style: {color: subtitleColor}"></span></div></div>\x3c!-- /ko --\x3e\x3c!-- ko ifnot: hasCarrousel --\x3e<div class="background-video" data-bind="visible: backgroundVideo"><div data-bind="ref: bgVideoRef"></div></div><div class="left"><div class="bg" data-bind="ifnot: backgroundVideo"><div data-bind="style: {backgroundImage: backgroundImage,backgroundColor: backgroundColor}"></div></div><div class="text-wrapper"><span class="title" data-bind="text: titleText, style: {color: titleColor}"></span><span class="subtitle" data-bind="text: subtitleText, style: {color: subtitleColor}"></span></div></div>\x3c!-- /ko --\x3e'},fa.prototype.banner_channels=function(a){a=a||{};return"<ul data-bind=\"visible: visible,foreach: channels\"><li data-bind=\"attr: {'class': ['channel-icon',$data.name + '-icon',].join(' ')},style: { backgroundColor: $parent.buttonsColor },click: $data.action\"></li></ul>"},fa.prototype.banner_container=function(a){a=a||{};return'<div class= "banner-container" data-bind="component: {name: \'banner\',params: {bannerSettings: customGreeterSettings.banner,}}"></div>'},fa.prototype.banner_main=function(a){a=a||{};return'<div class="banner-body">\x3c!-- ko component: {params: {bg: bg,backgroundImage: bg.image,backgroundColor: bg.color,backgroundVideo: bg.video,videoLoaded: readyToDisplay,titleText: titleText,subtitleText: subtitleText,textColor: titleColor,titleColor: titleColor,subtitleColor: subtitleColor,customSettings: customSettings},name: "banner-background"} --\x3e\x3c!-- /ko --\x3e<div class="right" data-bind="style: {backgroundColor: getRightBgColor}">\x3c!-- ko component: {params: {bg: bg,backgroundImage: bg.image,stdDeviation: bg.feGaussianBlurStdDeviation,customSettings: customSettings,},name: "banner-right-side-background"} --\x3e\x3c!-- /ko --\x3e<div class="header-bg" data-bind="visible: !timerIsValid(), style: {backgroundColor: getRightHeaderBgColor }"></div><div class="right-body" data-bind="css: {\'m-no-timer\': !timerIsValid() }"><div class="text-wrapper" data-bind="css: {\'m-no-timer\': !timerIsValid()}"><span class="title" data-bind="text: rightTitleText, style: {color: rightTitleColor}"></span><span class="subtitle" data-bind="text: rightSubtitleText, style: {color: rightSubtitleColor}"></span></div><div class="action-timer-container" data-bind="visible: timerIsValid, style: {color: timerColor}"><div class="timer-counter" data-bind="component: {name: \'banner-action-timer\',params: {timerTitleText: timerTitleText,timerEndTs: timerEndTs,timerColor: timerColor}}"></div></div><div class="call-order" data-bind="css: {\'m-no-timer\': !timerIsValid() }"><div class="content"><div class="enter-phone"><span class="title" data-bind="text: rightTitlePhoneText, style: {color: rightTitlePhoneColor}"></span><div class="form"><div class="form-row" data-bind="css: { \'error\': wrongNumberError }"><input type="tel" data-bind="masked: user.phone"/></div></div><button class="button" data-bind="text: callButtonText,style: { color: callTextColor },click: callOrder"></button></div><div class="buttons"><div class="channels" data-bind="visible: viewmodel.commList.length > 0,component: {name: \'banner-channels\',params: {visible: viewmodel.commList.length > 0,channels: viewmodel.commList,deeplinks: viewmodel.deeplinks,activeSlide: viewmodel.activeSlide,activeSocial: viewmodel.activeSocial,changeSliderOpenState: viewmodel.changeSliderOpenState,buttonsColor: buttonsColor,close: close,sliderVisible: sliderVisible}}"></div></div></div></div></div></div></div><div class="footer"><div class="data-collection" data-bind="css: { \'error\': dataAgreementError, \'alone\': !showPoweredBy()},component: {name: \'checkbox\',params: {checked: dataAgreement,text: $root.showDataCollectionText}}"></div>\x3c!-- ko component: {params: { key: \'banner\' },name: "powered-by"} --\x3e\x3c!-- /ko --\x3e</div><span class="banner-close cbh-icon-common" data-bind="click:close, style: {color: closeColor }"></span>'},fa.prototype.banner_right_side_background=function(a){a=a||{};return'\x3c!-- ko if: hasCarrousel --\x3e<div class="blurred-background" data-bind="style: { backgroundImage: oddCounter() ? backgroundImageNext() : backgroundImage() }"></div>\x3c!-- /ko --\x3e\x3c!-- ko ifnot: hasCarrousel --\x3e<div class="blurred-background" data-bind="style: { backgroundImage: backgroundImage },css: { \'video\': backgroundVideo }"></div>\x3c!-- /ko --\x3e<svg class="blurred-background__ie"><defs><filter id="blurRightBg"><feGaussianBlur stdDeviation="15" data-bind="attr: {stdDeviation: stdDeviation }" /></filter></defs><image xlink:href=\'\' data-bind="attr: { \'xlink:href\': bgClearImage }" width="268" height="421"  filter="url(#blurRightBg)"></image></svg>'},fa.prototype["builtin-snippet"]=function(a){a=a||{};return'<div class="builtin-snippet"><div class="manager-name" data-bind="click:click"><span data-bind="text:name"></span><span data-bind="visible:managerTitleEnabled && name().length">,&nbsp;</span><span data-bind="visible:managerTitleEnabled, text:title" style="font-weight: normal;"></span></div><div class="message" data-bind="text:text, click:click"></div><span class="builtin-snippet-close cbh-icon-common" data-bind="click:close"></span></div>'},fa.prototype.builtin=function(a){return a=a||{},'<div class="chat-header"><div class="bg-video" data-bind="visible: $root.backgroundVideo()"><div data-bind="ref: bgVideoRef" style="width: 377px; height: 300px;"></div></div><div class="person-meta" data-bind="style: {backgroundImage: $root.sliderBackgroundImage,backgroundColor: $root.sliderBackgroundColor,color: $root.sliderTextColor}"><div class="img" data-bind="style: { backgroundImage: manager.avatar }, css: { \'custom\': manager.avatar() }"></div><div class="h2" data-bind="text: manager.name().substring(0,30)"></div><div class="p" data-bind="text: manager.title().substring(0,30)"></div></div></div><div class="chat-body" data-bind="ref: msgContainer,css: {empty: messages().length === 0},event: {scroll: onScroll}"><ul><li class="bg" data-bind="style: { minHeight: (parseInt($root.builtinHeight()) - 151) + \'px\' }"></li>\x3c!-- ko foreach: messages --\x3e<li class="chat-msg" data-bind="css: {\'manager\': !own,\'inner\': position() === \'inner\',\'only\': position() === \'only\',\'first\': position() === \'first\' || position() === \'only\',\'last\': position() === \'last\'}"><div class="day" data-bind="text: day, visible: day"></div><div class="msg-container">\x3c!-- ko if: !own && (position() === \'last\' || position() === \'only\') --\x3e<div class="avatar" data-bind="style: {backgroundImage: $parent.manager.avatar},css: {\'custom\':  $parent.manager.avatar}"></div>\x3c!-- /ko --\x3e<div class="msg" data-bind="html: text"></div><div class="ts" data-bind="text: time"></div></div></li>\x3c!-- /ko --\x3e</ul></div><div class="chat-text-field"><input type="text" placeholder="'+this.__("builtin.prompt",a)+'" data-bind="hasFocus: inputFocused,textInput: message,event: {keypress: onKeypress}"/><div class="controls"><div class="send" data-bind="click: send"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M2 21l21-9L2 3v7l15 2-15 2v7z"/></svg></div></div></div>\x3c!-- ko component: {params: { key: "builtin" },name: "powered-by"} --\x3e\x3c!-- /ko --\x3e'},fa.prototype.button=function(a){a=a||{};return'<div class="buttons" data-bind="css: {\'left-side\': [\'tl\', \'bl\'].indexOf(quadrant()) !== -1,catch: caught}">\x3c!-- ko component: {name: "main-button",params: {caught: caught,activeSlide: activeSlide,sliderOpen: sliderOpen,changeSliderOpenState: changeSliderOpenState,sliderVisible: sliderVisible,channelsVisible: channelsVisible,priorityChannel: priorityChannel,hasChats: hasChats,hasCalls: hasCalls,unreadMessagesCount: unreadMessagesCount,resetCatching: resetCatching,applyGreeterSettings: applyGreeterSettings,chatsManager: chatsManager,customGreeterSettings: customGreeterSettings}} --\x3e\x3c!-- /ko --\x3e<div class="channels" data-bind="visible: sliderOpen() && channelsVisible(),component: {name: \'channels\',params: {visible: caught() || commList.length > 1 || hasCalls && commList.length > 0,caught: caught,channels: commList,deeplinks: deeplinks,activeSlide: activeSlide,activeSocial: activeSocial,sliderOpen: sliderOpen,changeSliderOpenState: changeSliderOpenState,sliderVisible: sliderVisible}}"></div></div>'},fa.prototype.channels=function(a){a=a||{};return"<ul data-bind=\"visible: visible,foreach: channels,css: {'active': $root.sliderOpen()}\"><li data-bind=\"attr: {'class': ['channel-icon',$data.name + '-icon',(!$parent.denyActiveButtonState&& ($root.activeSlide() === $data.name|| ($root.activeSlide() === 'social' && $root.activeSocial() === $data.name))) ? 'active' : ''].join(' ')},click: $data.action\">\x3c!-- ko if: $data.name === 'builtin' && $root.unreadMessagesCount() > 0 --\x3e\x3c!-- ko component: {params: { count: $root.unreadMessagesCount },name: \"unread-messages-counter\"} --\x3e\x3c!-- /ko --\x3e\x3c!-- /ko --\x3e</li></ul>"},fa.prototype.checkbox=function(a){a=a||{};return'<div class="checkbox-container"><input type="checkbox" data-bind="attr: { id: id }, checked: checked"/><label data-bind="attr: { for: id }, html: text"></label></div>'},fa.prototype.email=function(a){a=a||{};var b=this;return'<div class="chat-header"><div class="bg-video" data-bind="visible: $root.backgroundVideo()"><div data-bind="ref: bgVideoRef" style="width: 377px; height: 300px;"></div></div><div class="person-meta" data-bind="style: {backgroundImage: $root.sliderBackgroundImage,backgroundColor: $root.sliderBackgroundColor,color: $root.sliderTextColor}"><div class="img"></div><div class="p">'+b.__("email.title",a)+'</div></div></div><div class="email-body">\x3c!-- ko if: activeSubslide() === \'email_exit\' --\x3e<div class="overlay"><div class="title">'+b.__("email.you_sure",a)+'</div><div class="buttons"><div class="button"><button class="empty" data-bind="click: close">'+b.__("email.yes_close",a)+'</button></div><div class="button"><button data-bind="click: show">'+b.__("email.no_close",a)+'</button></div></div></div>\x3c!-- /ko --\x3e<div class="content" data-bind="css: { blur: activeSubslide() === \'email_exit\' }"><div class="textarea" data-bind="css: {required: emailText().length === 0,error: !textOk() && sendAttempt()}"><div class="placeholder" data-bind="if: emailText().length === 0">'+b.__("email.text_placeholder",a)+'</div><textarea data-bind="textInput: emailText"></textarea></div><div class="text" data-bind="css: {required: user.email().length === 0,error: !emailOk() && sendAttempt()}"><div class="placeholder" data-bind="if: user.email().length === 0">'+b.__("email.email_placeholder",a)+'</div><input type="email" name="email" autocomplete="on" data-bind="textInput: user.email"/></div><div class="text"><input type="text" name="name" autocomplete="on" data-bind="attr: { placeholder: __(\'email.name_placeholder\') },textInput: user.name"/></div><div class="text"><input type="tel" data-bind="masked: user.phone"/></div><div class="buttons" data-bind="visible: activeSubslide() !== \'email_exit\'"><div class="button"><button data-bind="enable: dataAgreement,click: send">'+b.__("email.send",a)+'</button></div><div class="data-collection" data-bind="component: {name: \'checkbox\',params: {checked: dataAgreement,text: $root.showDataCollectionText}}"></div></div></div></div>\x3c!-- ko component: {params: { key: "email" },name: "powered-by"} --\x3e\x3c!-- /ko --\x3e'},fa.prototype["main-button"]=function(a){a=a||{};return"\x3c!-- ko if: sliderOpen() && activeSlide() !== 'builtin-snippet' --\x3e<div class=\"main-button close\" data-bind=\"click: closeSlider\"></div>\x3c!-- /ko --\x3e\x3c!-- ko if: !sliderOpen() || hasCalls || activeSlide() === 'builtin-snippet' --\x3e<div class=\"main-button\" data-bind=\"ref: $root.mainButtonRef,css: {'active': !sliderOpen() || (activeSlide() === 'callback' || activeSlide() === 'builtin-snippet'),'slider-open': (sliderOpen() || !channelsVisible()) && activeSlide() !== 'builtin-snippet','callback': alternativeButton() && hasCalls,'logo': alternativeButton() && !hasCalls,'custom-logo': alternativeButton() && !hasCalls && customBrandLogo()},style: { backgroundImage: (alternativeButton() && !hasCalls) ? customBrandLogo : '' },click: click\">\x3c!-- ko component: {params: { count: $root.unreadMessagesCount },name: \"unread-messages-counter\"} --\x3e\x3c!-- /ko --\x3e\x3c!-- ko foreach: callbackIcons --\x3e<i data-bind=\"attr: {'class': ['icon',$data,$data === 'logo' && $parent.customBrandLogo() ? 'custom' : '',($parent.rotatingCallIcon() === $data) ? 'rotate-icon' : ''].join(' ')},style: { backgroundImage: $data === 'logo' ? $parent.customBrandLogo : '' }\"></i>\x3c!-- /ko --\x3e</div>\x3c!-- /ko --\x3e"},fa.prototype.main=function(a){a=a||{};return"<div class=\"cbh-body-fade\" data-bind=\"visible: isBannerVisible() || (caught() && catchVisible() && sliderVideoLoaded()),click: closeCatchDialog\"></div><div class=\"cbh-slider\" data-bind=\"ref: builtinRef,visible: (caught() || positioningFinished() && isSliderAllowed() && sliderOpen()) && sliderVideoLoaded(),css: {'cbh-builtin': activeSlide() === 'builtin' || activeSlide() === 'email','cbh-fixed': isFixedButton,'cbh-catch': caught},style: {height: ['builtin', 'builtin-snippet', 'email'].indexOf(activeSlide()) !== -1 ? builtinHeight() : null,bottom: sliderBottom(),top: sliderTop(),right: activeSlide() === 'builtin-snippet' ? (parseInt(sliderRight(), 10) - 13) + 'px' : sliderRight(),left: sliderLeft()}\"></div><div class=\"cbh-button\" data-bind=\"visible: isMainButtonsPlankVisible(),style: {width: (sliderWidth() + 8) + 'px',height: (btnSize() + 8) + 'px',bottom: bottom(),top: top(),right: right(),left: left()},css: {'cbh-only-button': !sliderOpen() || activeSlide() === 'builtin-snippet','cbh-fixed': isFixedButton,'cbh-catch': caught}\"><div class=\"cbh-ph-circle\"></div><div class=\"cbh-ph-circle-fill\"></div></div><div class=\"cbh-banner\" data-bind=\"visible: isBannerVisible()\"></div>"},fa.prototype["powered-by"]=function(a){a=a||{};return'\x3c!-- ko if: showPoweredBy --\x3e<div class="powered-by" data-bind="html: poweredByContent, click: poweredByClicked"></div>\x3c!-- /ko --\x3e'},fa.prototype.rating=function(a){a=a||{};return'<ul class="rating" data-bind="foreach: [1,2,3,4,5]"><li data-bind="click: $parent.onRate.bind($parent),style: { color: $parent.textColor }"></li></ul>'},fa.prototype.select=function(a){a=a||{};return'<div class="select" data-bind="click: showPopup"><select><option data-bind="text: selectedText"></option></select></div><ul class="select-popup" data-bind="visible: popupVisible, foreach: options"><li data-bind="text: text, click: $parent.pick.bind($parent)"></li></ul>'},fa.prototype.slider__index=function(a){return a=a||{},'\x3c!-- ko component: {params: {backgroundImage: backgroundImage,backgroundColor: backgroundColor,backgroundVideo: backgroundVideo,videoLoaded: sliderVideoLoaded,textColor: textColor,caught: caught,customSettings: customGreeterSettings.slider},name: "slider-background"} --\x3e\x3c!-- /ko --\x3e<i class="logo" data-bind="style: {backgroundImage: logoImage},visible: activeSubslide() !== \'sms_mesage\',css: {social: showSocialAvatar,custom: logoImage}"></i><div class="body">\x3c!-- ko if: content --\x3e<div class="content" data-bind="template: content"></div>\x3c!-- /ko --\x3e</div><div class="footer"><div class="data-collection" data-bind="css: { \'error\': dataAgreementError, \'alone\': !showPoweredBy() },component: {name: \'checkbox\',params: {checked: dataAgreement,text: $root.showDataCollectionText}}"></div>\x3c!-- ko component: {params: { key: \'slider\' },name: "powered-by"} --\x3e\x3c!-- /ko --\x3e</div>'+this._(a.templates)},fa.prototype.slider_background=function(a){a=a||{};return'\x3c!-- ko if: hasCarrousel --\x3e<div class="bg animated" data-bind="css: {fallback: fallback,active: !oddCounter()}"><div data-bind="style: {backgroundImage: backgroundImage}"></div></div><div class="bg animated" data-bind="css: {fallback: fallback,active: oddCounter}"><div data-bind="style: {backgroundImage: backgroundImageNext}"></div></div>\x3c!-- /ko --\x3e\x3c!-- ko ifnot: hasCarrousel --\x3e<div class="bg active"><div data-bind="style: {backgroundImage: backgroundImage,backgroundColor: backgroundColor}"></div><div class="bg__video" data-bind="visible: backgroundVideo()"><div data-bind="ref: bgVideoRef" style="width: 550px; height: 377px;"></div></div></div>\x3c!-- /ko --\x3e'},fa.prototype.slider_call_later=function(a){a=a||{};var b=this;return'<div class="title" data-bind="text: title,style: { color: textColor }"></div><div class="form"><div class="form-row"><div class="pick day" data-bind="component: {name: \'select\',params: {options: availableDays,selected: selectedDay}}"></div><div class="pick time" data-bind="component: {name: \'select\',params: {options: availableHours,selected: selectedHour}}"></div><div class="buttons-block">\x3c!-- ko if: allowTimeSelection --\x3e<button class="call-now" data-bind="click: showCommunicationSlide,style: { color: textColor }">'+b.__("slider.call_later.call_now",a)+'</button>\x3c!-- /ko --\x3e<button data-bind="click: callDeferred">'+b.__("slider.call_later.button",a)+"</button></div></div></div>"},fa.prototype.slider_call_now=function(a){return a=a||{},'<div class="title" data-bind="text: title() || \' ⁣\',style: { color: textColor }"></div><div class="form"><div class="form-row" data-bind="css: { \'error\': wrongNumberError }"><input type="tel" data-bind="masked: user.phone"/><div class="buttons-block">\x3c!-- ko if: allowTimeSelection --\x3e<button class="pick-time" data-bind="click: callLater,style: { color: textColor }">'+this.__("slider.call_now.pick_time",a)+'</button>\x3c!-- /ko --\x3e<button data-bind="click: call,text: callButtonText"></button></div></div></div>'},fa.prototype.slider_social=function(a){a=a||{};return'<div class="form"><div class="form-row"><div class="social"><div class="text" data-bind="html: text,style: { color: textColor }"></div><div class="buttons-block"><button data-bind="attr: { \'class\': activeSocial },click: socialButtonOnClick(),text: socialButtonText"></button></div></div></div></div>'},fa.prototype.slider=function(a){a=a||{};return"<div class=\"snippet-container\" data-bind=\"ref: $root.snippetContainerRef,visible: slideVisible('builtin-snippet'),component: {name: 'builtin-snippet',params: {chatSettings: customGreeterSettings.chat(),}},css: {'left-side': ['tl', 'bl'].indexOf(quadrant()) !== -1,'top-side': ['tl', 'tr'].indexOf(quadrant()) !== -1,}\"></div><div class=\"builtin-container\" data-bind=\"visible: slideVisible('builtin'),component: {name: 'builtin',params: {enabled: builtinChatEnabled,unreadMessagesCount: unreadMessagesCount,visible: slideVisible('builtin'),user: user,customGreeterSettings: customGreeterSettings}}\"></div><div class=\"email-container\" data-bind=\"visible: slideVisible('email'),component: {name: 'email',params: {user: user,sliderOpen: sliderOpen,channelsVisible: channelsVisible,activeSlide: activeSlide,activeSubslide: activeSubslide,sliderVisible: sliderVisible}}\"></div><div class=\"slider\" data-bind=\"visible: caught() || isSliderAllowed() && slideInvisible('builtin')() && slideInvisible('builtin-snippet')() && slideInvisible('email')() && sliderVisible(),css: { catch: caught },component: {name: 'slider',params: {visible: slideInvisible('builtin') && slideInvisible('builtin-snippet') && slideInvisible('email'),channelsVisible: channelsVisible}}\"></div>"},fa.prototype["unread-messages-counter"]=function(a){a=a||{};return"<i class='cbh-new-messages' data-bind=\"text: unreadMessagesPresentation,css: {'cbh-visible': visible}\"></i>"},fa.prototype.widget_call_disabled=function(a){return a=a||{},'<div class="title" data-bind="style: { color: textColor }"><div data-bind="html: title"></div><div class="sub-title" data-bind="visible: channels.length > 1">'+this.__("slider.call_disabled.sub_title",a)+"</div></div>"},fa.prototype.widget_call_failure=function(a){a=a||{};var b=this;return'<div class="title" data-bind="text: __(\'call_failure.title\'),style: { color: textColor }"></div><div class="form"><div class="form-row"><button data-bind="click: showCommunicationSlide" class="yes">'+b.__("yes",a)+'</button><button class="no empty" data-bind="click: close,style: { color: textColor }">'+b.__("close",a)+"</button></div></div>"},fa.prototype.widget_call_free_success=function(a){return a=a||{},'<div class="title no-margin" data-bind="text: __(\'free_success.title\'),style: { color: textColor }"></div><div class="form"><div class="form-row"><div class="buttons-block"><button data-bind="click: afterSuccess">'+this.__("close_widget",a)+"</button></div></div></div>"},fa.prototype.widget_call_later_success=function(a){return a=a||{},'<div class="title" data-bind="text: title,style: { color: textColor }"></div><div class="form"><div class="form-row"><div class="text" data-bind="text: text,style: { color: textColor }"></div><div class="buttons-block"><button data-bind="click: afterSuccess">'+this.__("close_widget",a)+"</button></div></div></div>"},fa.prototype.widget_call_rating=function(a){a=a||{};return'<div class="title" data-bind="text: __(\'rating.title\'),style: { color: textColor }"></div>\x3c!-- ko component: {name: \'rating\',params: {onRate: onRate.bind($data),textColor: textColor}} --\x3e\x3c!-- /ko --\x3e<div class="text" data-bind="text: __(\'rating.text\'),style: { color: textColor }"></div>'},fa.prototype.widget_call_result=function(a){a=a||{};var b=this;return'<div class="title" data-bind="text: __(\'call_result.title\'),style: { color: textColor }"></div><div class="form"><div class="form-row"><button data-bind="click: callSuccess" class="yes">'+b.__("yes",a)+'</button><button class="no empty" data-bind="click: callFailure,style: { color: textColor }">'+b.__("no",a)+"</button></div></div>"},fa.prototype.widget_call_timer=function(a){a=a||{};return'<div class="title" data-bind="text: title,style: { color: textColor }"></div><div class="timer" data-bind="countdown: countdown,style: { color: textColor }"></div>'},fa.prototype.widget_catch=function(a){return a=a||{},'<div class="title catch" data-bind="style: { color: textColor }"><div data-bind="html: title"></div><div class="sub-title" data-bind="text: subTitle"></div></div><div class="form" style="margin-top: 1px;"><div class="form-row"><button class="yes" data-bind="click: prioritySocial, text: firstButtonText"></button><button class="no empty" data-bind="text: secondButtonText,click: prioritySocial,style: { color: textColor }">'+this.__("no",a)+"</button></div></div>"},fa.prototype.widget_email_failure=function(a){a=a||{};return'<div class="title" data-bind="text: ___(\'email.failure\'),style: { color: textColor }"></div><div class="form"><div class="form-row"><button class="long" data-bind="click: email,text: ___(\'email.again_failure\')"></button><button class="no empty standard-width" data-bind="click: close,text: ___(\'email.close\'),style: { color: textColor }"></button></div></div>'},fa.prototype.widget_email_success=function(a){a=a||{};return'<div class="title" data-bind="text: ___(\'email.success\'),style: { color: textColor }"></div><div class="form"><div class="form-row"><button class="no empty standard-width" data-bind="click: close,text: ___(\'email.close\'),style: { color: textColor }"></button></div></div>'},fa.prototype.widget_enter_phone=function(a){return a=a||{},
'<div class="title" data-bind="text: title,style: { color: textColor }"></div><div class="form"><div class="form-row" data-bind="css: { \'error\': wrongNumberError }"><input type="tel" data-bind="masked: user.phone"/><div class="buttons-block"><button data-bind="click: next()">'+this.__("slider.waiting_call",a)+"</button></div></div></div>"},fa.prototype.widget_select_office=function(a){a=a||{};return'<div class="title" data-bind="text: title,style: { color: textColor }"></div><div class="form"><div class="form-row"><div class="pick office" data-bind="component: {name: \'select\',params: {options: officeSelectionList,selected: selectedOffice}}"></div><div class="buttons-block"><button data-bind="click: next(),text: __(\'select_office.button\')"></button></div></div></div>'},fa.prototype.widget_sms_failure=function(a){a=a||{};return'<div class="title" data-bind="text: __(\'sms_failure.title\'),style: { color: textColor }"></div><div class="form"><div class="form-row"><button class="long" data-bind="click: smsPhone,text: __(\'sms_failure.again\')"></button><button class="no empty standard-width" data-bind="click: close,text: __(\'sms_failure.close\'),style: { color: textColor }"></button></div></div>'},fa.prototype.widget_sms_message=function(a){a=a||{};return'<div class="form"><div class="form-row"><div class="textarea-container"><div class="textarea"><textarea data-bind="attr: { placeholder: __(\'sms_phone.placeholder\') },textInput: smsText"></textarea></div><button class="floated" data-bind="enable: callAllowed() && smsAllowed(),click: sms,text: __(\'sms_phone.send\')"></button></div></div></div>'},fa.prototype.widget_sms_phone=function(a){a=a||{};return'<div class="title" data-bind="text: __(\'sms_phone.title\'),style: { color: textColor }"></div><div class="form"><div class="form-row"><input type="tel" data-bind="masked: user.phone"/><div class="buttons-block"><button data-bind="enable: callAllowed,click: smsMessage,text: __(\'sms_phone.button\')"></button></div></div></div>'},fa.prototype.widget_sms_success=function(a){a=a||{};return'<div class="title" data-bind="text: __(\'sms_success.title\'),style: { color: textColor }"></div><div class="form"><div class="form-row"><button class="empty long" data-bind="click: smsPhone,text: __(\'sms_success.again\'),style: { color: textColor }"></button><button data-bind="click: close,text: __(\'sms_success.close\')"></button></div></div>'};var ga=new fa(ea),ha=CBHCore.db_params;ha.valueEquals=function(a,b){return void 0!==ha[a]&&ha[a]===b};var ia,ja,ka,la="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},ma=(function(){var a="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103}(),function(){function a(a){this.value=a}function b(b){function c(a,b){return new Promise(function(c,e){var h={key:a,arg:b,resolve:c,reject:e,next:null};g?g=g.next=h:(f=g=h,d(a,b))})}function d(c,f){try{var g=b[c](f),h=g.value;h instanceof a?Promise.resolve(h.value).then(function(a){d("next",a)},function(a){d("throw",a)}):e(g.done?"return":"normal",g.value)}catch(a){e("throw",a)}}function e(a,b){switch(a){case"return":f.resolve({value:b,done:!0});break;case"throw":f.reject(b);break;default:f.resolve({value:b,done:!1})}f=f.next,f?d(f.key,f.arg):g=null}var f,g;this._invoke=c,"function"!=typeof b.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(b.prototype[Symbol.asyncIterator]=function(){return this}),b.prototype.next=function(a){return this._invoke("next",a)},b.prototype.throw=function(a){return this._invoke("throw",a)},b.prototype.return=function(a){return this._invoke("return",a)}}(),function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}),na=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),oa=(Object.assign,function a(b,c,d){null===b&&(b=Function.prototype);var e=Object.getOwnPropertyDescriptor(b,c);if(void 0===e){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if("value"in e)return e.value;var g=e.get;if(void 0!==g)return g.call(d)}),pa=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)},qa=function(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b},ra=("undefined"==typeof global?self:global,function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(a){e=!0,f=a}finally{try{!d&&h.return&&h.return()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()),sa=function(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)},ta=function(){function a(){ma(this,a),this.scheduleValues=CBHCore.params.mainSchedule.getValues()}return na(a,[{key:"reduce",value:function(a,b){if("function"!=typeof b)throw new TypeError(b+" is not a function");var c=Object(a),d=a.length>>>0,e=0,f=void 0;if(3===arguments.length)f=arguments[2];else{for(;e<d&&!(e in c);)e++;if(e>=d)throw new TypeError("Reduce of empty array with no initial value");f=c[e++]}for(;e<d;e++)e in c&&(f=b(f,c[e],e,c));return f}},{key:"savePriorityChannel",value:function(a){CBHCore.savePriorityChannel(a)}},{key:"renderDay",value:function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"%day%, %date%",d=this.getCalendarDic(),e=new ba.StrongDate(Number(a));e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0);var f="",g="",h="",i=d.monthes[a.getMonth()];if(f=this.toLocaleStringSupportsLocales()?e.toLocaleString(CBHCore.lang.langCode,{month:"long",day:"numeric"}):e.getDate()+" "+ea("when.monthes."+i),b){var j=new ba.StrongDate;j.setHours(0),j.setMinutes(0),j.setSeconds(0),j.setMilliseconds(0);var k=(Number(e)-Number(j))/864e5;void 0!==d.days[k]?g=ea("when.days."+d.days[k]):k<7&&(g=ea("when.daysOfWeek."+d.daysOfWeek[a.getDay()])),h=c.replace("%day%",g).replace("%date%",f)}else h=f;return h}},{key:"getCalendarDic",value:function(){return{days:["today","tomorrow"],daysOfWeek:["sun","mon","tue","wed","thu","fri","sat"],monthes:["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"]}}},{key:"getShortWhen",value:function(a){var b=new ba.StrongDate;b.setHours(0),b.setMinutes(0),b.setSeconds(0),b.setMilliseconds(0);var c=new ba.StrongDate(Number(a));c.setHours(0),c.setMinutes(0),c.setSeconds(0),c.setMilliseconds(0);var d=this.getCalendarDic(),e=(Number(c)-Number(b))/864e5;return void 0!==d.days[e]?ea("when.days."+d.days[e]):e<4&&ea("when.daysOfWeek."+d.daysOfWeek[a.getDay()])}},{key:"capitalizeFirstLetter",value:function(a){return a.charAt(0).toUpperCase()+a.slice(1)}},{key:"toLocaleStringSupportsLocales",value:function(){try{(new Date).toLocaleString("i")}catch(a){return"RangeError"===a.name}return!1}},{key:"generateDaySelects",value:function(){var a=this;return this.daySelects(!1,function(b){return a.renderDay(b,!0,"%date%")})}},{key:"daySelects",value:function(a,b){var c=this,d=!0,e=[],f="",g="",h=0;return Object.keys(this.scheduleValues).forEach(function(i){var j=new ba.StrongDate(Number(i)),k=b(j);a&&(k=c.capitalizeFirstLetter(k));var l=c.getShortWhen(j);d&&(f=k,g=l,h=Number(i)),e.push({shortText:l,text:k,value:Number(i),selected:d}),d=!1}),{data:e,firstName:f,firstVal:h,firstShort:g}}},{key:"generateHourSelects",value:function(){var a=this,b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:CBHCore.params.mainSchedule.getNextWorkingDay(),c=[],d=!0,e="",f=0;return Object.keys(this.scheduleValues[b]).forEach(function(g){a.scheduleValues[b][g].forEach(function(b){var g=void 0;g=a.toLocaleStringSupportsLocales()?b.toLocaleString(CBHCore.lang.langCode,{hour:"2-digit",minute:"2-digit"}):b.toTimeString().substr(0,5),d&&(e=g,f=Number(b)),c.push({text:g,value:Number(b),selected:d}),d=!1})}),{data:c,firstName:e,firstVal:f}}},{key:"shadeColor",value:function(a,b){function c(a){return Math.round((e-a)*f)+a}var d=parseInt(a.slice(1),16),e=b<0?0:255,f=b<0?-1*b:b,g=d>>16,h=d>>8&255,i=255&d;return"#"+(16777216+65536*c(g)+256*c(h)+c(i)).toString(16).slice(1)}},{key:"stripTags",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",c=(String(b||"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join(""),d=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,e=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;return a.replace(e,"").replace(d,function(a,b){return c.indexOf("<"+b.toLowerCase()+">")>-1?a:""})}},{key:"debounce",value:function(a,b,c){var d=void 0;return function(){var e=c&&!d,f=arguments,g=function(){d=null,c||a.apply(void 0,sa(f))};clearTimeout(d),d=setTimeout(g,b),e&&a.apply(void 0,sa(f))}}},{key:"arrayRemove",value:function(a,b,c){var d=a.slice((c||b)+1||a.length);return a.length=b<0?a.length+b:b,a.push.apply(a,d)}},{key:"rC",value:function(a,b){a.classList?a.classList.remove(b):a.className=a.className.replace(new RegExp("(^|\\b)"+b.split(" ").join("|")+"(\\b|$)","gi")," ")}},{key:"aC",value:function(a,b){a.classList?a.classList.add(b):a.className+=" "+b}},{key:"bodyHasHorizontalScroll",value:function(){return document.documentElement.scrollWidth>document.documentElement.clientWidth}},{key:"getColorBrightness",value:function(a){var b=parseInt(a.slice(1),16);return.299*(b>>16)+.587*(b>>8&255)+.114*(255&b)}},{key:"areClipPathShapesSupported",value:function(){for(var a="clipPath",b=["webkit","moz","ms","o"],c=[a],d=document.createElement("testelement"),e=0,f=b.length;e<f;e++){var g=b[e]+a.charAt(0).toUpperCase()+a.slice(1);c.push(g)}for(var h=0,i=c.length;h<i;h++){var j=c[h];if(""===d.style[j]&&(d.style[j]="polygon(50% 0%, 0% 100%, 100% 100%)",""!==d.style[j]))return!0}return!1}},{key:"blinkObservable",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1500;a(!0),setTimeout(function(){return a(!1)},b)}}]),a}(),ua=new ta,va=["Top","Right","Bottom","Left"],wa=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},xa=(ia={html:{fontFamily:"sans-serif"},body:{margin:"0"}},ia["a:active,\n  a:hover"]={outlineWidth:"0"},ia["button,\n  input,\n  optgroup,\n  select,\n  textarea"]={fontFamily:"sans-serif",fontSize:"100%",lineHeight:"1.15"},ka={html:{lineHeight:"1.15",textSizeAdjust:"100%"}},ka["article,\n  aside,\n  footer,\n  header,\n  nav,\n  section"]={display:"block"},ka.h1={fontSize:"2em",margin:"0.67em 0"},ka["figcaption,\n  figure,\n  main"]={display:"block"},ka.figure={margin:"1em 40px"},ka.hr={boxSizing:"content-box",height:"0",overflow:"visible"},ka.pre={fontFamily:"monospace, monospace",fontSize:"1em"},ka.a={"background-color":"transparent","-webkit-text-decoration-skip":"objects"},ka["abbr[title]"]=(ja={borderBottom:"none",textDecoration:"underline"},ja.textDecoration="underline dotted",ja),ka["b,\n  strong"]={fontWeight:"inherit"},ka["code,\n  kbd,\n  samp"]={fontFamily:"monospace, monospace",fontSize:"1em"},ka.dfn={fontStyle:"italic"},ka.mark={backgroundColor:"#ff0",color:"#000"},ka.small={fontSize:"80%"},ka["sub,\n  sup"]={fontSize:"75%",lineHeight:"0",position:"relative",verticalAlign:"baseline"},ka.sub={bottom:"-0.25em"},ka.sup={top:"-0.5em"},ka["audio,\n  video"]={display:"inline-block"},ka["audio:not([controls])"]={display:"none",height:"0"},ka.img={borderStyle:"none"},ka["svg:not(:root)"]={overflow:"hidden"},ka["button,\n  input,\n  optgroup,\n  select,\n  textarea"]={margin:"0"},ka["button,\n  input"]={overflow:"visible"},ka["button,\n  select"]={textTransform:"none"},ka['button,\n  html [type="button"],\n  [type="reset"],\n  [type="submit"]']={"-webkit-appearance":"button"},ka['button::-moz-focus-inner,\n  [type="button"]::-moz-focus-inner,\n  [type="reset"]::-moz-focus-inner,\n  [type="submit"]::-moz-focus-inner']={borderStyle:"none",padding:"0"},ka['button:-moz-focusring,\n  [type="button"]:-moz-focusring,\n  [type="reset"]:-moz-focusring,\n  [type="submit"]:-moz-focusring']={outline:"1px dotted ButtonText"},ka.fieldset={border:"1px solid #c0c0c0",margin:"0 2px",padding:"0.35em 0.625em 0.75em"},ka.legend={boxSizing:"border-box",color:"inherit",display:"table",maxWidth:"100%",padding:"0",whiteSpace:"normal"},ka.progress={display:"inline-block",verticalAlign:"baseline"},ka.textarea={overflow:"auto"},ka['[type="checkbox"],\n  [type="radio"]']={boxSizing:"border-box",padding:"0"},ka['[type="number"]::-webkit-inner-spin-button,\n  [type="number"]::-webkit-outer-spin-button']={height:"auto"},ka['[type="search"]']={"-webkit-appearance":"textfield",outlineOffset:"-2px"},ka['[type="search"]::-webkit-search-cancel-button,\n  [type="search"]::-webkit-search-decoration']={"-webkit-appearance":"none"},ka["::-webkit-file-upload-button"]={"-webkit-appearance":"button",font:"inherit"},ka["details,\n  menu"]={display:"block"},ka.summary={display:"list-item"},ka.canvas={display:"inline-block"},ka.template={display:"none"},ka["[hidden]"]={display:"none"},{aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"}),ya=/^#[a-fA-F0-9]{6}$/,za=/^#[a-fA-F0-9]{3}$/,Aa=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/,Ba=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([-+]?[0-9]*[.]?[0-9]+)\s*\)$/,Ca=/^hsl\(\s*(\d{1,3})\s*,\s*(\d{1,3})%\s*,\s*(\d{1,3})%\s*\)$/,Da=/^hsla\(\s*(\d{1,3})\s*,\s*(\d{1,3})%\s*,\s*(\d{1,3})%\s*,\s*([-+]?[0-9]*[.]?[0-9]+)\s*\)$/,Ea=function(a){return 7===a.length&&a[1]===a[2]&&a[3]===a[4]&&a[5]===a[6]?"#"+a[1]+a[3]+a[5]:a},Fa=function(a){return"number"==typeof a.red&&"number"==typeof a.green&&"number"==typeof a.blue&&("number"!=typeof a.alpha||void 0===a.alpha)},Ga=function(a){return"number"==typeof a.red&&"number"==typeof a.green&&"number"==typeof a.blue&&"number"==typeof a.alpha},Ha=function(a){return"number"==typeof a.hue&&"number"==typeof a.saturation&&"number"==typeof a.lightness&&("number"!=typeof a.alpha||void 0===a.alpha)},Ia=function(a){return"number"==typeof a.hue&&"number"==typeof a.saturation&&"number"==typeof a.lightness&&"number"==typeof a.alpha},Ja="Passed invalid argument to toColorString, please pass a RgbColor, RgbaColor, HslColor or HslaColor object.",Ka=y(A),La=y(B),Ma=["absolute","fixed","relative","static","sticky"],Na=function(){function a(){ma(this,a)}return na(a,[{key:"getColorBrightness",value:function(a){var b=parseInt(this.colorFilter(a).slice(1),16);return.299*(b>>16)+.587*(b>>8&255)+.114*(255&b)}},{key:"getWhiteOrBlack",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;return this.getColorBrightness(this.colorFilter(a))>b?"#000000":"#ffffff"}},{key:"modifyColorBrightness",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,d="#"+this.colorFilter(a),e=this.getColorBrightness(d);return e>b?this.errorlessDarken(c,d):this.errorlessLighten(c,d)}},{key:"colorFilter",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#",c=a.replace(/[^0-9a-fA-F]/g,"").substr(0,6);return 3===c.length&&(c+=c),b+c}}]),a}();Na.prototype.errorlessDarken=C(Ka),Na.prototype.errorlessLighten=C(La);var Oa=new Na,Pa=CBHCore.Masked,Qa=function(){function a(b){var c=this;ma(this,a),this.pic=ko.observable(""),this.phone=ko.observable(""),this.phoneFallback=ko.observable(""),this.email=ko.observable(""),this.emailFallback=ko.observable(""),this.name=ko.observable(""),b||(this.phone(CBHCore.user.client_phone?CBHCore.user.client_phone:CBHCore.getDefaultPhoneCode()),this.phoneFallback(CBHCore.user.client_phone_fallback?CBHCore.user.client_phone_fallback:CBHCore.getDefaultPhoneCode()),this.email(CBHCore.user.email||""),this.emailFallback(CBHCore.user.email_fallback||""),this.name(CBHCore.user.name||"")),this.initSocial(),this.phoneIsInvalid=ko.observable(!1),this.phoneChanged=!1,this.phone.subscribe(function(){c.phoneIsInvalid(!1),c.phoneChanged=!0}),this.beautifulPhone=ko.computed(function(){return Pa.getPhone(c.phone())||c.phone()}),this.setupServer()}return na(a,[{key:"initSocial",value:function(){function a(a){return void 0!==CBHCore.user[a]&&CBHCore.user[a]?CBHCore.user[a]:""}var b=this,c={};["vk","fb","vb","tg","sk","whatsApp"].forEach(function(d){var e=d+"_avatar",f=d+"_id";b[d]=ko.observable(a(f)),c[d]=a(e)}),this.avatars=ko.observable(c)}},{key:"setupServer",value:function(){var a=this;this.phoneFallback.subscribe(ua.debounce(function(){CBHCore.helpers.savePhoneFallback(a.phoneFallback())},500)),this.name.subscribe(ua.debounce(function(){CBHCore.helpers.saveName(a.name())},500)),this.email.subscribe(ua.debounce(function(){CBHCore.helpers.saveEmail(a.email())},500)),this.emailFallback.subscribe(ua.debounce(function(){CBHCore.helpers.saveEmailFallback(a.emailFallback())},500)),this.sk.subscribe(ua.debounce(function(){CBHCore.helpers.saveSkId(a.sk())},500))}},{key:"isPhoneValid",value:function(a){return this.phoneIsInvalid((this.phoneChanged||a)&&(!CBHCore.helpers.isValidPhone(this.phone())||!Pa.isValid(this.phone()))),!this.phoneIsInvalid()}},{key:"isEmailValid",value:function(){var a=this.email();return a.length>0&&-1!==a.indexOf("@")&&-1!==a.indexOf(".")}},{key:"injectNameIfAvailable",value:function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,e=void 0;return e=d>0?this.getShortName(d):this.name(),this.name().length>0?ea(a,CBHCore.helpers.extend(c,{name:CBHCore.helpers.escapeHtml(e)})):ea(b,c)}},{key:"getShortName",value:function(a){var b=this.name().trim();return b.length<=a||a<=0?b:(b=b.split(/\s/)[0],b.length<=a?b:b.substr(0,a-1)+"…")}}]),a}(),Ra=function(){function a(b){var c=this;ma(this,a),this.options=b.options,this.selected=b.selected,this.popupVisible=ko.observable(!1),this.selectedText=ko.computed(function(){return c.selected()?c.selected().text:""}),CBHCore.helpers.isFunction(this.options)&&this.options().length>0&&this.selected(this.options()[0])}return na(a,[{key:"showPopup",value:function(){this.popupVisible(!0)}},{key:"pick",value:function(a){this.selected(a),this.popupVisible(!1)}}]),a}(),Sa=function a(b){ma(this,a),this.onRate=b.onRate,this.textColor=b.textColor,this.index=ko.observable(!1)},Ta=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ma(this,a),CBHCore.helpers.isArray(b.elemId)||(b.elemId=[b.elemId]),this.elemId=b.elemId,this.elems=[];var c=void 0,d=void 0;for(var e in this.elemId)this.elemId.hasOwnProperty(e)&&("string"==typeof b.elemId[e]?(c=document.getElementById(b.elemId[e]),d=b.elemId[e]):b.elemId[e]&&(c=b.elemId[e],d="cbh_cntdwn_"+Math.floor(1e3*Math.random())),c&&(this.elems[d]=c));this.time=b.time,this.currentTime=this.time,this.template=b.template,this.msNumbers=b.msNumbers||2,this.delta=b.delta||33,this.reset()}return na(a,[{key:"addContainer",value:function(a){var b=void 0,c=void 0;"string"==typeof a?(b=a,c=document.getElementById(b)):void 0===a.elements?(b=a.id||"cbh_cntdwn_"+Math.floor(1e3*Math.random()),c=a):(b=a.getAttr("id"),c=a.elements[0]),c&&b&&-1===this.elems.indexOf(c)&&(this.elems[b]=c,this.reset(!1))}},{key:"divide",value:function(a){var b={};b.hours=Math.floor(a/36e5),b.minutes=Math.floor((a-36e5*b.hours)/6e4),b.seconds=Math.floor((a-(36e5*b.hours+6e4*b.minutes))/1e3),b.ms=a-(36e5*b.hours+6e4*b.minutes+1e3*b.seconds),b.ms=b.ms.toString().substr(0,this.msNumbers);var c=Math.floor(a/1e3);return CBHCore.is_mobile?b.text=c<=86400?ea("countdown.tomorrow"):c<=172800?ea("countdown.afterTomorrow"):ea("countdown.after")+" "+this.secondsToString(c,0):b.text=b.hours>23?this.secondsToString(c,0,1):this.secondsToString(c,1,2),b}},{key:"set",value:function(a){this.currentTime=a;var b=this.divide(this.currentTime);for(var c in this.elems)if(this.elems.hasOwnProperty(c))for(var d in b)b.hasOwnProperty(d)&&("text"!==d&&(b[d]=String("0"+b[d]).slice(-2)),void 0===this.elems[c].placeholders[d]&&(this.elems[c].placeholders[d]=document.getElementById(c+"_"+d)||this.elems[c].querySelector("#"+c+"_"+d)),this.elems[c].placeholders[d]&&(this.elems[c].placeholders[d].innerHTML=b[d]))}},{key:"reset",value:function(){var a=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];a&&this.stop();for(var b in this.elems)this.elems.hasOwnProperty(b)&&(this.elems[b].innerHTML=this.template.replace(/%(.+?)%/g,'<span id="'+b+'_$1"></span>'),this.elems[b].placeholders={});this.set(a?this.time-10:this.currentTime)}},{key:"start",value:function(a){if(!this.running){this.running=!0;var b=Number(new Date);this.countdownInterval=setInterval(function(){var c=Number(new Date),d=this.time-(c-b);if(d>0)this.set(d);else if(this.set(0),this.stop(),CBHCore.helpers.isFunction(a))return a()}.bind(this),this.delta)}}},{key:"stop",value:function(){clearInterval(this.countdownInterval),this.running=!1}},{key:"secondsToString",value:function(a,b,c){var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:" ",e=parseInt(a,10),f="string"==typeof d?d:" ",g=-1===[0,1,2,3].indexOf(parseInt(b,10))?1:parseInt(b,10),h=-1===[0,1,2,3].indexOf(parseInt(c,10))?1:parseInt(c,10),i=["days","hours","minutes","seconds"];if(3===h)return ea(i[3],{num:e});for(var j=[Math.floor(e/86400),Math.floor(e%86400/3600),Math.floor(e%86400%3600/60),e%86400%3600%60],k=1;k<3;k++)k>h&&(j[k+1]+=j[1]*(0===k?24:60),j[k]=0);0===g&&0===j[0]&&j[1]>0&&(j[0]=1,j[1]=0);var l=[];for(var m in j)if(j.hasOwnProperty(m)&&(l.push(ea(i[m],{num:j[m]})),m>g))break;return l.join(f)}}]),a}(),Ua=null,Va=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},b=a.element,c=void 0===b?null:b,d=a.valueAccessor,e=void 0===d?null:d;return c&&Ua&&Ua.addContainer(c),Ua||D({element:c,valueAccessor:e})},Wa=CBHCore.lib.StrongDate,Xa=function(){function a(){ma(this,a),this.clientChannel=void 0!==ha.clientChannel&&ha.clientChannel,this.socials=["fb","vk","vb","tg","sk","whatsApp"]}return na(a,[{key:"make",value:function(a){for(var b={},c=0;c<this.socials.length;c++){var d=this.socials[c];void 0!==a[d]&&(this[d+"params"]=E(a[d])),CBHCore.helpers.isFunction(this[d+"Setup"])&&this[d+"Setup"](this.getChannel(d+"_g"))}for(var e=0;e<this.socials.length;e++){var f=this.socials[e];void 0!==this[f+"params"]&&(b[f]=E(this[f+"params"]))}return b}},{key:"getChannel",value:function(a){return this.clientChannel&&void 0!==this.clientChannel[a]?this.clientChannel[a]:null}},{key:"fbSetup",value:function(a){a?(this.fbparams.customGroup=!0,this.fbparams.pageId=a.id,this.fbparams.chatLink="https://m.me/"+this.fbparams.pageId,this.fbparams.pageLink=this.clientChannel.fb_g.link):this.fbparams.pageId=null}},{key:"vkSetup",value:function(a){a?(this.vkparams.pageId=a.id,this.vkparams.chatLink="https://vk.com/im?sel=-"+a.id,this.vkparams.customGroup=!0):(this.vkparams.pageId=null,this.vkparams.chatLink="")}},{key:"vbSetup",value:function(a){var b=this.vbparams.pageId;if(this.vbparams.chatLink="",!CBHCore.helpers.isWindowsPhone()){a&&a.id&&(b=a.id);var c=JSON.stringify({sid:CBHCore.user.session_id,hcode:CBHCore.hunter_code});this.vbparams.chatLink="viber://pa?"+CBHCore.helpers.makeQueryString({chatURI:b,context:c})}}},{key:"tgSetup",value:function(a){a&&(this.tgparams.pageId=a.id),ha.client_data&&ha.client_data.id&&(this.tgparams.chatLink="tg://resolve?domain="+this.tgparams.pageId+"&start="+CBHCore.hunter_code+"-"+ha.client_data.id)}},{key:"skSetup",value:function(a){a&&(this.skparams.pageId=a.id,this.skparams.chatLink+=this.skparams.pageId)}},{key:"whatsAppSetup",value:function(a){a&&a.link&&(this.whatsAppparams={chatLink:a.link})}}]),a}(),Ya=new Xa,Za=Ya.make({fb:{pageId:ba.fbPageId,chatLink:ba.fbChatLink},vk:{pageId:ba.vkGroupId,chatLink:ba.vkChatLink},vb:{pageId:ba.viberPA_URI,chatLink:null},tg:{pageId:ba.tgDomain,chatLink:null},sk:{pageId:null,chatLink:ba.skPageLink}}),$a=function(){function a(b,c){ma(this,a),this.vm=null,this.config=b,this.vm=c}return na(a,[{key:"fb",value:function(){void 0!==this.config.fb&&(this.sendSocialButtonEvent("fb"),window.open(this.config.fb.chatLink))}},{key:"vk",value:function(){void 0!==this.config.vk&&(this.sendSocialButtonEvent("vk"),window.open("https://vk.com/im?sel=-"+this.config.vk.pageId,"blank"))}},{key:"vb",value:function(){void 0!==this.config.vb&&(this.sendSocialButtonEvent("vb"),aa.open(this.config.vb.chatLink,{windows:{appId:"9wzdncrfj46z",appName:"viber"},desktop:{appUrl:"https://www.viber.com/ru/"}}))}},{key:"tg",value:function(){if(void 0!==this.config.tg){this.sendSocialButtonEvent("tg");var a={desktop:{appUrl:"https://desktop.telegram.org/"}};CBHCore.helpers.isWindowsPhone()&&(a.windows={appId:"9wzdncrdzhs0",appName:"telegram-messenger"}),aa.open(this.config.tg.chatLink,a)}}},{key:"sk",value:function(){void 0!==this.config.sk&&(this.sendSocialButtonEvent("sk"),aa.open(this.config.sk.chatLink,{}))}},{key:"whatsApp",value:function(){this.config.whatsApp&&this.config.whatsApp.chatLink&&(this.sendSocialButtonEvent("whatsApp"),window.open(this.config.whatsApp.chatLink))}},{key:"sendSocialButtonEvent",value:function(a){return this.vm.sendCustomizedMarketingEvent("Callbackhunter_SOCIAL_BUTTON_"+a.toUpperCase(),"clicked"),!0}}]),a}(),_a=function(){function a(b){ma(this,a),this.enabledChats=ha.chat_channels||[],this.enabledChannels=ha.cbh_channels||[],this.commList=[],this.priorityChannel=null,this.chatsConfig=Za,this.deeplinks=new $a(Za,b),this.hasManagerBot=void 0!==ha.has_manager_bot&&ha.has_manager_bot,this.clientChannel=void 0!==ha.clientChannel&&ha.clientChannel,this.builtinChatEnabled=ko.observable(!1),this.sms=b.hasSms(),this.generateCommList(),this.hasCalls=this.isChannelEnabled("callback"),this.hasChats=this.commList.length>0}return na(a,[{key:"isChatEnabled",value:function(a){return!this.enabledChats.length||-1!==this.enabledChats.indexOf(a)}},{key:"isChannelEnabled",value:function(a){var b=this.enabledChannels;if(0===b.length)return!0;var c="desc_"+a;return b.hasOwnProperty(c)}},{key:"generateCommList",value:function(){if(this.hasManagerBot){var a=[],b=this.initPriorityList();this.isChatEnabled("builtin")&&this.isChannelEnabled("builtin")?(a.push("builtin"),this.builtinChatEnabled(!0)):this.builtinChatEnabled(!1),this.chatsConfig.vk.chatLink&&this.chatsConfig.vk.pageId&&this.isChatEnabled("vk")&&this.isChannelEnabled("vk")&&a.push("vk"),(this.chatsConfig.fb.chatLink||this.chatsConfig.fb.pageLink)&&this.chatsConfig.fb.pageId&&this.isChatEnabled("fb")&&this.isChannelEnabled("fb")&&a.push("fb"),this.chatsConfig.sk.pageId&&this.chatsConfig.sk.chatLink&&this.isChatEnabled("sk")&&this.isChannelEnabled("sk")&&a.push("sk"),this.chatsConfig.tg.chatLink&&this.isChatEnabled("tg")&&this.isChannelEnabled("tg")&&a.push("tg"),this.isChatEnabled("email")&&this.isChannelEnabled("email")&&a.push("email"),this.sms&&this.isChatEnabled("sms")&&this.isChannelEnabled("sms")&&a.push("sms"),this.chatsConfig.whatsApp&&this.chatsConfig.whatsApp.chatLink&&this.isChatEnabled("whatsApp")&&this.isChannelEnabled("whatsApp")&&a.push("whatsApp"),this.setPriorities(b,a),this.setPriorityChannel()}}},{key:"initPriorityList",value:function(){return ha.client_data&&CBHCore.helpers.isArray(ha.client_data.comm_rating)?ha.client_data.comm_rating.slice():["builtin"]}},{key:"setPriorities",value:function(a,b){a.slice().forEach(function(c){var d=b.indexOf(c);-1===d?ua.arrayRemove(a,a.indexOf(c)):ua.arrayRemove(b,d)}),this.commList=a.concat(b),this.forceChannelPriority("sms",-1),this.forceChannelPriority("sk",-1),this.forceChannelPriority("builtin",1)}},{key:"forceChannelPriority",value:function(a,b){this.commList=this.commList.sort(function(c,d){return c!==a&&d!==a?0:c===a?-b:b})}},{key:"setPriorityChannel",value:function(){ha.client_data&&ha.client_data.priority_channel&&-1!==this.commList.indexOf(ha.client_data.priority_channel)?this.priorityChannel=ha.client_data.priority_channel:this.isChannelEnabled("callback")?this.priorityChannel="callback":this.priorityChannel=this.commList[0]}}],[{key:"supportedPriorityChannel",value:function(a){return-1!==["fb","vk","tg","vb","builtin","email","whatsApp"].indexOf(a)}}]),a}(),ab=140,bb=function(){function a(b,c,d,e){var f=this;ma(this,a),cb.call(this),this.___=ea,this.prefix=e,this.vm=c,this.visible=b.visible,this.customGreeterSettings=c.customGreeterSettings,this.user=c.user,this.countdown=c.countdown,this.activeSlide=c.activeSlide,this.activeSubslide=c.activeSubslide,this.activeSocial=c.activeSocial,this.sliderOpen=c.sliderOpen,this.changeSliderOpenState=c.changeSliderOpenState,this.channelsVisible=c.channelsVisible,this.channels=c.commList,this.showReason=c.showReason,this.sliderVideoLoaded=c.sliderVideoLoaded,this.freeMode=c.freeMode,this.worktime=c.worktime,this.hasCalls=c.hasCalls,
this.caught=c.caught,this.deeplinks=c.deeplinks,this.priorityChannel=c.priorityChannel,this.disableCatchFirstStep=ko.observable(!1),this.title=ko.observable(),this.subTitle=ko.observable(""),this.firstButtonText=ko.observable(""),this.secondButtonText=ko.observable(""),this.callButtonText=ko.observable(""),this.text=ko.observable(),this.content=ko.computed(function(){if(!f.activeSubslide()||!f.visible())return null;var a="widget_"+f.activeSubslide();return CBHCore.helpers.isFunction(d[a])?a:(a=e+"_"+f.activeSubslide(),"slider_catch"===a&&f.disableCatchFirstStep()&&(a="slider_call_now",f.showCommunicationSlide()),CBHCore.helpers.isFunction(d[a])?a:null)}),this.setupOffices(c),this.setupTime(c),this.setupFirstStepSkipState(),this.setupText(),this.setupTextColor(c),this.setupBackground(c),this.setupLogo(),["catch","slider"].forEach(function(a){return f.addLangVariables(a)}),this.allowTimeSelection=ko.computed(function(){return f.worktime()&&!f.freeMode()}),this.dataAgreement=ko.observable(!0),this.socialButtonOnClick=ko.observable(),this.socialAvatar=ko.observable(),this.rating=ko.observable(),this.next=ko.observable(),this.smsText=ko.observable(""),this.socialButtonText=ko.observable(""),this.smsText.subscribe(function(){f.smsText().length>ab&&f.smsText(f.smsText().substr(0,ab))}),this.callAllowed=ko.computed(function(){return f.user.isPhoneValid()&&f.dataAgreement()}),this.wrongNumberError=ko.observable(!1),this.dataAgreementError=ko.observable(!1),this.showPoweredBy=ko.observable(ha.show_powered_by),this.smsAllowed=ko.computed(function(){return f.smsText().length>0&&f.smsText().length<=ab}),this.user.phone.valueHasMutated(),this.activeSlide.subscribe(function(){f.activeSlide()&&("call-now"===f.activeSlide()?setTimeout(function(){return f.hasCalls?f.call():f.call(!0)}):"callback"===f.activeSlide()?CBHCore.helpers.isFunction(f.defaultSubslide)&&setTimeout(function(){return f.defaultSubslide()}):"sms"===f.activeSlide()?setTimeout(function(){return f.smsPhone()}):"social"===f.activeSlide()?setTimeout(function(){return f.prioritySocial()}):f.changeSliderOpenState(!0))});var g=function(){f.channelsVisible(-1!==["call_now","call_disabled","catch","sms_phone","social","email_main"].indexOf(f.activeSubslide()))};this.activeSubslide.subscribe(g),this.activeSlide.subscribe(g),this.caught.subscribe(function(){return f.catch()}),this.activeSlide.notifySubscribers(),this.visible.notifySubscribers(),this.customGreeterSettings.slider.subscribe(function(){f.setupLogo(),f.setupFirstStepSkipState(),f.setupText(),f.updateTextColor(),f.disableCatchFirstStep()&&f.activeSlide.valueHasMutated()})}return na(a,[{key:"setupFirstStepSkipState",value:function(){var a=void 0!==ha.disable_catch_first_step&&parseInt(ha.disable_catch_first_step,10),b=this.getGreeterData();b&&(a=!b.firstScreenEnabled),this.disableCatchFirstStep(a)}},{key:"addLangVariables",value:function(a){if(!this.freeMode()){var b=ea(a+".call_now.title")||"";b&&(b="#{name}, "+b.charAt(0).toLowerCase()+b.slice(1)),CBHCore.lang.addLangRow(a+".call_now.title_name",b)}}},{key:"isCatchSlide",value:function(){return"catch"===this.activeSubslide()}},{key:"setupTextColor",value:function(a){var b=this;this.textColor=a.sliderTextColor,this.caught.subscribe(function(){b.updateTextColor()}),this.caught.valueHasMutated()}},{key:"updateTextColor",value:function(){var a="#ffffff",b=this.getGreeterData();if(b&&(b.titleColor||b.secondScreenTitleColor))a=this.isCatchSlide()?b.titleColor:b.secondScreenTitleColor;else{var c=this.caught()?"catcher_text_color":"slider_text_color";c&&ha[c]&&(a=function(a){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#")+a.replace(/[^0-9a-fA-F]/g,"").substr(0,6)}(ha[c]))}this.textColor(a)}},{key:"setupBackground",value:function(a){this.backgroundImage=a.sliderBackgroundImage,this.backgroundColor=a.sliderBackgroundColor,this.backgroundVideo=a.backgroundVideo}},{key:"setupOffices",value:function(a){this.selectedOffice=a.selectedOffice,this.officeSelectionList=a.officeSelectionList}},{key:"setupTime",value:function(a){this.availableDays=a.availableDays,this.selectedDay=a.selectedDay,this.availableHours=a.availableHours,this.selectedHour=a.selectedHour}},{key:"__",value:function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];return ea.apply(void 0,[this.prefix+"."+a].concat(c))}},{key:"getNewRandId",value:function(){return CBHCore.helpers.rand(16)}},{key:"getCallParams",value:function(){return this.callRandId=this.getNewRandId(),{phone:this.user.phone(),client_name:this.user.name(),wp_code:void 0===ha.wp_code?"":ha.wp_code,lang:CBHCore.lang.langCode,office_id:this.selectedOffice()?this.selectedOffice().value:0,call_rand_id:this.callRandId,phone_manager_tracked:CBHCore.callTracking.catchManagerPhone(),widget_show_reason:this.showReason(),url:window.location.href}}},{key:"isCallOk",value:function(){var a=!0;return this.user.isPhoneValid()||(ua.blinkObservable(this.wrongNumberError),a=!1),this.dataAgreement()||(ua.blinkObservable(this.dataAgreementError),a=!1),a}},{key:"call",value:function(){var a=this,b=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isCallOk()){if(!(this.worktime()||this.selectedDay()&&this.selectedHour()))return this.callLater();if(this.officeSelectionList().length>0&&!this.selectedOffice())return this.selectOffice(function(){return a.call()});if(this.selectedDay()&&this.selectedHour())return this.callDeferred();CBHCore.server.send(this.getCallParams()),this.vm.sendCustomizedMarketingEvent("Callbackhunter_CAUGHT_PHONE","clicked"),this.vm.sendCustomizedMarketingEvent("Callbackhunter_CALL_BUTTON","clicked"),!0===b?this.callResult():setTimeout(function(){return a.callTimer()})}}},{key:"enterPhone",value:function(a){this.activeSubslide("enter_phone"),this.next(a)}},{key:"callDeferred",value:function(){var a=this;return this.officeSelectionList().length>0&&!this.selectedOffice()?void this.selectOffice(function(){return a.callDeferred()}):this.user.isPhoneValid(!0)?(this.vm.sendCustomizedMarketingEvent("Callbackhunter_CALL_LATER_BUTTON","clicked"),CBHCore.server.send(CBHCore.helpers.extend(this.getCallParams(),{night_time:this.selectedHour().value,user_date:JSON.stringify({utc:(new Date).toUTCString(),local:String(new Date),utc_strong:(new Wa).toUTCString(),local_strong:(new Wa).toString()})})),void this.laterSuccess()):void this.enterPhone(function(){a.isCallOk()&&a.callDeferred()})}},{key:"sms",value:function(){var a=this,b=this.smsText();this.callAllowed()&&this.smsAllowed()&&(this.vm.sendCustomizedMarketingEvent("cbh_desktop_sms","sent"),this.vm.sendCustomizedMarketingEvent("Callbackhunter_SEND_SMS","sent"),this.smsSuccess(),CBHCore.server.send({lang:CBHCore.lang.langCode,question:JSON.stringify({question:b.trim(),phone:this.user.phone(),email:this.user.email(),type:"sms"})},"/hunter/",function(b){"success"!==b.result&&a.smsFailure()}))}},{key:"prioritySocial",value:function(){_a.supportedPriorityChannel(this.priorityChannel)&&"builtin"!==this.priorityChannel&&"email"!==this.priorityChannel?this.social(this.priorityChannel):this.showCommunicationSlide()}},{key:"social",value:function(a){var b=this;this.activeSubslide("social"),this.activeSocial(a);var c=ea(this.prefix+".social.channels."+a);this.text(this.user.injectNameIfAvailable(this.prefix+".social.text",this.prefix+".social.text_no_name",{social:c},10)),this.user.avatars()[a]&&this.socialAvatar("url("+this.user.avatars()[a]+")"),this.socialButtonOnClick(function(){!CBHCore.helpers.empty(b.deeplinks.config[a])&&CBHCore.helpers.isFunction(b.deeplinks[a])?b.deeplinks[a]():b.activeSlide(a),b.vm.sendCustomizedMarketingEvent("Callbackhunter_SOCIAL_BUTTON_"+a.toUpperCase(),"clicked")}),this.socialButtonText(ea(this.prefix+".social.button",{social:c}))}},{key:"callTimer",value:function(){var a=this;if(this.freeMode())return this.callSuccessFree();this.activeSubslide("call_timer"),this.title(this.user.injectNameIfAvailable(this.prefix+".timer.title_name",this.prefix+".timer.title",{},10)),Va().start(function(){return a.callResult()})}},{key:"callResult",value:function(){this.activeSubslide("call_result")}},{key:"laterSuccess",value:function(){var a=new Date(this.selectedDay().value);this.title(this.__("later_success.title",{day:ua.renderDay(a,!0,"%day%")})),this.text(this.__("later_success.text",{date:ua.renderDay(a,!0,"%date%"),time:this.selectedHour().text})),this.activeSubslide("call_later_success")}},{key:"callSuccess",value:function(){if(!this.rating())return void this.callRating();this.afterSuccess()}},{key:"callSuccessFree",value:function(){var a=this;this.activeSubslide("call_free_success"),setTimeout(function(){return a.afterSuccess()},5e3)}},{key:"afterSuccess",value:function(){this.rating(0),this.close(),this.defaultSubslide()}},{key:"callRating",value:function(){this.activeSubslide("call_rating")}},{key:"callFailure",value:function(){this.activeSubslide("call_failure")}},{key:"catch",value:function(){if(this.disableCatchFirstStep()||!this.caught()||Va&&Va().running)return void this.showCommunicationSlide();this.activeSubslide("catch"),this.recalcTimeOnSite()}},{key:"showCommunicationSlide",value:function(){var a=this;return this.selectedOffice(0),this.selectedDay(0),this.selectedHour(0),Va&&Va().running?void setTimeout(function(){return a.callTimer()}):this.hasCalls?this.worktime()?(this.activeSubslide("call_now"),this.setupText(),void this.updateTextColor()):void this.callNight():(this.callDisabled(),void this.updateTextColor())}},{key:"callNight",value:function(){this.selectedOffice(0),this.title(this.__("call_night.title")),this.activeSubslide("call_now")}},{key:"callLater",value:function(){this.selectedOffice(0),this.title(this.__("call_later.title")),this.activeSubslide("call_later")}},{key:"callDisabled",value:function(){this.selectedOffice(0),this.title(this.__("call_disabled.title")),this.activeSubslide("call_disabled")}},{key:"smsPhone",value:function(){this.activeSubslide("sms_phone")}},{key:"email",value:function(){this.activeSubslide("call_now"),this.activeSlide("email")}},{key:"smsMessage",value:function(){this.smsText(""),this.activeSubslide("sms_message")}},{key:"smsFailure",value:function(){this.activeSubslide("sms_failure")}},{key:"smsSuccess",value:function(){this.activeSubslide("sms_success")}},{key:"selectOffice",value:function(a){this.title(this.__("select_office.title")),this.activeSubslide("select_office"),this.next(a)}},{key:"onRate",value:function(a){this.rating(a),this.callSuccess()}},{key:"getGreeterData",value:function(){return this.customGreeterSettings&&this.customGreeterSettings.slider()?this.customGreeterSettings.slider():null}}]),a}(),cb=function(){var a=this;this.vm=null,this.setupText=function(){var b=a.caught()?"catch":"slider",c=a.getGreeterData();a.disableCatchFirstStep()&&!a.hasCalls||(c||(a.firstButtonText(ea("yes")),a.secondButtonText(ea("no")),a.callButtonText(ea(a.caught()?"catch.waiting_call":"slider.waiting_call"))),c?(a.title(a.isCatchSlide()?c.titleText:c.secondScreenTitleText),a.subTitle(c.subtitleText||""),c.firstButtonText&&a.firstButtonText(c.firstButtonText),c.secondButtonText&&a.secondButtonText(c.secondButtonText),c.secondScreenButtonText&&a.callButtonText(c.secondScreenButtonText)):a.freeMode()?(a.title(ea(b+".call_now.title_free",{countdown:a.countdown})),a.subTitle(ea("catch.main.title_static"))):(a.title(a.user.injectNameIfAvailable(b+".call_now.title_name",b+".call_now.title",{countdown:a.countdown},10)),a.subTitle(ea("catch.main.title_static"))))},this.setupLogo=function(){a.showSocialAvatar=ko.observable(!1),a.logoImage=ko.computed(function(){if("social"===a.activeSubslide()){var b=a.socialAvatar();if(b)return a.showSocialAvatar(!0),b}if(a.showSocialAvatar(!1),!CBHCore.helpers.brandingEnabled()||"sms_message"===a.activeSubslide())return null;var c=a.getGreeterData();if(c)return"url("+(c.bodyLogo||"")+")";var d=a.caught()?"catcher_logo":"slider_logo",e=CBHCore[d]||ha[d];return e?"url(//"+CBHCore.opt.static_domain+"/uploads/brand_large_logo/"+e+")":void 0})}},db=function(a,b){return function(c){function d(c){ma(this,d);var e=qa(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,c,a,b,"slider"));return e.visible.subscribe(function(){e.visible()||e.disableCatchFirstStep()||"main"!==e.activeSubslide()||e.recalcTimeOnSite()}),e}return pa(d,c),na(d,[{key:"recalcTimeOnSite",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"when.time",b=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.getGreeterData())return this.setupText(),void this.updateTextColor();var c=CBHCore.helpers.getTimeFromStart(),d=ra(c,3),e=d[0],f=d[1],g=d[2],h=[],i=0;return!isNaN(g)&&g>0&&(h.push(ea(a+".hours",{num:g})),i+=60*g*60),!isNaN(e)&&e>0&&(h.push(ea(a+".minutes",{num:e})),i+=60*e),!isNaN(f)&&f>0&&0===g&&(0===g&&h.push(ea(a+".seconds",{num:f})),i+=f),i<10&&(h=[]),h.length>0?this.title(ea("catch.main.title_time",{time:h.join(" ")}).replace("..",".")):this.title(""),this.title().length>35&&!b?this.recalcTimeOnSite("when.time_short",!0):void 0}},{key:"defaultSubslide",value:function(){this.showCommunicationSlide()}},{key:"close",value:function(){this.channelsVisible(!0),this.caught(!1),this.defaultSubslide(),this.changeSliderOpenState(!1)}}]),d}(bb)},eb=function(a){return function(){function b(a){var c=a.key,d=a.utm_source,e=void 0===d?"":d;ma(this,b),this.showPoweredBy=Boolean(parseInt(ha.show_powered_by,10)),this.poweredByContent=CBHCore.helpers.compilePoweredBy("powered_by."+c,e)}return na(b,[{key:"poweredByClicked",value:function(b,c){return c.stopPropagation(),a.sendCustomizedMarketingEvent("cbh_powered_by","clicked"),!0}}]),b}()},fb=0,gb=function a(b){ma(this,a),this.text=b.text,this.checked=b.checked,this.id="checkbox_"+ ++fb},hb=function(a){return function(){function b(c){ma(this,b);var d=CBHCore.helpers.isFunction,e=CBHCore.helpers.empty,f=ko.observableArray(c.channels||[]),g=c.deeplinks,h=c.caught,i=c.sliderVisible;this.denyActiveButtonState=c.denyActiveButtonState||!1,this.visible=c.visible,this.channels=ko.observableArray(ko.utils.arrayMap(f(),function(b){return{name:b,action:function(){ua.savePriorityChannel(b),"builtin"!==b&&"email"!==b||(h(!1),i(!0)),c.activeSlide()===b&&d(c.sliderOpen)||"social"===c.activeSlide()&&d(c.activeSocial)&&c.activeSocial()===b?(c.changeSliderOpenState(!1),"builtin"!==b&&"sms"!==b&&"email"!==b||a.sendCustomizedMarketingEvent("Callbackhunter_WIDGET","clicked"),"builtin"!==c.activeSlide()&&"email"!==c.activeSlide()||c.activeSlide("")):d(c.activeSlide)&&(!e(c.deeplinks.config[b])&&d(g[b])?g[b]():(c.activeSlide(b),a.sendCustomizedMarketingEvent("Callbackhunter_SOCIAL_BUTTON_"+b.toUpperCase(),"clicked")))}}}))}return b}()},ib={connected:!1,inProcess:!1,endpoint:ba.socketIOEndpoint.url,opts:{path:ba.socketIOEndpoint.path},setup:function(a,b){this.connected=!1,this.inProcess=!1,this.endpoint=a,this.opts=b||{}},connect:function(a){return this.connected?a():this.inProcess?this.io.on("initFinish",a):(this.inProcess=!0,this.io=CBHCore.io(this.endpoint,this.opts),this.io.on("connect",function(){this.io.emit("init",{sid:CBHCore.user.session_id,hcode:CBHCore.hunter_code})}.bind(this)),void this.io.on("initFinish",function(){this.connected=!0,this.inProcess=!1,a()}.bind(this)))}};Object.create(ib).setup(CBHCore.opt.socketIOEndpoint);var jb={},kb=function(a){return null!==a&&a===a.window};jb.getStyle=function(a){var b=window.getComputedStyle(this.elements[0]);return!!b&&b.getPropertyValue(a)};var lb=CBHCore.lib.Sweety(jb),mb=[];"Boolean Number String Function Array Date RegExp Object Error Symbol".split(" ").forEach(function(a){mb["[object "+a+"]"]=a.toLowerCase()});var nb={Height:"height",Width:"width"};for(var ob in nb){(function(a){if(!nb.hasOwnProperty(a))return"continue";var b=nb[a],c={padding:"inner"+a,content:b,"":"outer"+a};for(var d in c){(function(d){if(!c.hasOwnProperty(d))return"continue";var e=c[d];jb[e]=function(c){var f=arguments.length&&(d||"boolean"!=typeof c);return pb(this.elements,function(b,c,d){if(kb(b))return 0===e.indexOf("outer")?b["inner"+a]:b.document.documentElement["client"+a];if(9===b.nodeType){var f=b.documentElement;return Math.max(b.body["scroll"+a],f["scroll"+a],b.body["offset"+a],f["offset"+a],f["client"+a])}return void 0===d?parseFloat(lb(b).getStyle(c)):lb(b).addStyle(c,d)},b,f?c:void 0,f)}})(d)}})(ob)}var pb=function a(b,c,d,e,f,g,h){var i=b.length,j=h,k=c,l=f,m=0,n=null==d;if("object"===function(a){return null==a?String(a):"object"===(void 0===a?"undefined":la(a))||"function"==typeof a?mb[toString.call(a)]||"object":void 0===a?"undefined":la(a)}(d)){l=!0;for(m in d)d.hasOwnProperty(m)&&a(b,k,m,d[m],!0,g,j)}else if(void 0!==e&&(l=!0,isFunction(e)||(j=!0),n&&(j?(k.call(b,e),k=null):(n=k,k=function(a,b,c){return n.call(lb(a),c)})),k))for(;m<i;m++)k(b[m],d,j?e:e.call(b[m],m,k(b[m],d)));return l?b:n?k.call(b):i?k(b[0],d):g},qb=CBHCore.lib.Sweety(jb),rb=function(){function a(b,c){var d=c.name,e=c.avatar,f=c.title;ma(this,a),this.name=ko.observable(d),this.avatar=ko.observable(e),this.title=ko.observable(f),this.storage=b,this.name.subscribe(this.save.bind(this)),this.avatar.subscribe(this.save.bind(this)),this.title.subscribe(this.save.bind(this))}return na(a,[{key:"save",value:function(){this.storage.saveManager({name:this.name,avatar:this.avatar,title:this.title})}}]),a}(),sb=function(){function a(b){var c=b.text,d=b.ts,e=void 0===d?Number(new Date):d,f=b.own,g=void 0!==f&&f,h=b.from,i=void 0===h?"":h;ma(this,a),this.ts=e,this.own=g||"client"===i,this.text=this.filterText(c),this.day=ko.observable(),this.time=ko.observable(),this.position=ko.observable(),this.prepareTime()}return na(a,[{key:"filterText",value:function(a){var b=ua.stripTags(a);return b=b.replace(/(https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_+.~#?&\/\/=]*))/,"<a class='cbh-a' href='$1' rel='noopener' target='_blank'>$1</a>")}},{key:"prepareTime",value:function(){var a=new Date(this.ts),b=a.getHours(),c=a.getMinutes();this.day(ua.renderDay(a)),this.time((b<10?"0"+b:b)+":"+(c<10?"0"+c:c))}}]),a}(),tb=!1,ub=function(){function a(){ma(this,a)}return na(a,null,[{key:"extractId",value:function(a){var b=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/,c=a.match(b);return!(!c||11!==c[7].length)&&c[7]}},{key:"getThumbnailLink",value:function(b){if(!b)return null;var c=a.extractId(b);return c?"https://img.youtube.com/vi/"+c+"/hqdefault.jpg":null}},{key:"loadAPIIfNeeded",value:function(b){if(window.hasOwnProperty("YT")||tb)return tb?void setTimeout(function(){a.loadAPIIfNeeded(b)}):b();var c=document.createElement("script"),d=document.getElementsByTagName("script")[0];c.src="//www.youtube.com/iframe_api",d.parentNode.insertBefore(c,d),tb=!0,window.onYouTubeIframeAPIReady=function(){tb=!1,b()}}},{key:"loadPlayer",value:function(b,c,d){if(b&&c){var e=a.extractId(b);a.loadAPIIfNeeded(function(){var a=new YT.Player(c,{videoId:e,playerVars:{origin:location.origin,rel:0,autoplay:1,mute:1,fs:0,autohide:1,controls:0,disablekb:1,enablejsapi:0,loop:1,modestbranding:0,playsinline:1,showinfo:0,playlist:e},events:{onReady:function(){a.playVideo()},onStateChange:function(b){b.data===YT.PlayerState.PLAYING&&CBHCore.helpers.isFunction(d)&&d(!0),b.data===YT.PlayerState.ENDED&&a.playVideo()}}})})}}}]),a}(),vb=function(){var a=function(a){return new F(function(b){var c=b(a);return!1===c&&(CBHCore.opt.dev_mode||G("history")),c||[]},function(b,c){return c(a,b)})}("cbh-builtin-messages"),b=function(a){var b=da.toUnicode(document.location.hostname),c=ea("builtin.manager_title");return new F(function(d){var e=d(a)||{};return{name:e.name?e.name:b,avatar:e.avatar?e.avatar:"",title:e.title?e.title:c}},function(b,c){var d={};return CBHCore.helpers.isFunction(b.name)?d.name=b.name():d.name=b.name,CBHCore.helpers.isFunction(b.avatar)?d.avatar=b.avatar():d.avatar=b.avatar,CBHCore.helpers.isFunction(b.title)?d.title=b.title():d.title=b.title,c(a,d)})}("cbh-builtin-manager");return{getHistory:a.get,saveHistory:a.save,getManager:b.get,saveManager:b.save}}(),wb=function(a){return function(){function b(c){var d=this;ma(this,b),this.messages=ko.observableArray(),this.customGreeterSettings=c.customGreeterSettings.chat,this.messageLengthLimit=1e3,this.__=ea,this.user=c.user,this.visible=c.visible,this.unreadMessagesCount=c.unreadMessagesCount,this.connected=!1,this.moved=!1,this.bgVideoRef=ko.observable(null),this.fullScreenContainer=ko.observable(null),this.msgContainer=ko.observable(null),this.chatEnded=ko.observable(!1),this.inputFocused=ko.observable(!1),this.autoScrolling=ko.observable(!0),this.manager=new rb(vb,vb.getManager()),this.browser=CBHCore.helpers.browser(),this.message=ko.observable(""),this.messages.subscribe(function(a){return vb.saveHistory(a)}),this.inputFocused.subscribe(function(a){a&&setTimeout(function(){d.scrollChatToBottom()},500)}),this.visible.subscribe(function(a){a&&d.unreadMessagesCount(0)}),c.enabled()&&(ba.fakeChatMessages?this.setupDevFakeMessages():this.setupIO(),this.customGreeterSettings.subscribe(function(){d.onGreteerArised()}),a.backgroundVideo.subscribe(function(){return ub.loadPlayer(a.backgroundVideo(),d.bgVideoRef())}))}return na(b,[{key:"onGreteerArised",value:function(){var a=this.customGreeterSettings()||null;a&&(a.text&&this.onMessageReceived({text:a.text,name:a.managerName||"",title:a.managerTitle||"",avatar:a.managerAvatar||"",isGreeter:!0}),ib.io&&G("greeterArised",{greteerUid:a.greeterUid}))}},{key:"setupDevFakeMessages",value:function(){var a=this,b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1500;this.addMessages([{ts:Number(new Date("2017-08-09T12:35:00")),own:!1,text:"Lorem ipsum dolor sit amet"},{ts:Number(new Date("2017-08-09T12:35:00")),own:!0,text:"Lorem ipsum dolor sit amet"},{ts:Number(new Date("2017-08-09T12:37:30")),own:!0,text:"quis rhoncus"},{ts:Number(new Date("2017-08-09T12:37:31")),own:!0,text:"dictumst nec velit turpis"},{ts:Number(new Date("2017-08-10T13:37:32")),own:!1,text:"Euismod"},{ts:Number(new Date("2017-08-10T13:38:30")),own:!0,text:"Sagittis"},{ts:Number(new Date("2017-08-10T15:37:30")),own:!1,text:"Orci nibh at cursus, eget velit blandit sodales odio et turpis"},{ts:Number(new Date("2017-08-10T15:37:30")),own:!1,text:"Vel erat"},{ts:Number(new Date("2017-08-10T15:37:31")),own:!1,text:"Cursus turpis quisque"},{ts:Number(new Date("2017-08-10T15:37:32")),own:!0,text:"Mauris auctor dictumst vel, wisi ligula metus et wisi vivamus, suscipit ornare, volutpat quisque ut vel sit consectetuer, amet at porttitor nec velit varius purus. Nibh turpis platea leo id, id eleifend amet lobortis, id molestie cursus"}]);var c=function(){for(var a=function(a,b){return parseInt(Math.random()*(b-1)+a,10)},b=a(5,100),c=0,d=[];c<b;){var e=function(){return CBHCore.helpers.rand(a(1,15))}();c+=e.length,d.push(e)}return d.join(" ")},d=setInterval(function(){a.messages().length<20?a.onMessageReceived({text:c()}):clearInterval(d)},b)}},{key:"setupIO",value:function(){var a=this;CBHCore.loadFile("js",ba.socketIOLib,!0,function(){ib.connect(function(){a.connected||(a.connected=!0,ib.io.on("message",function(b){b&&a.onMessageReceived({text:b.text,name:b.name,avatar:b.avatar})}),ib.io.on("history",function(b){a.addMessages(b,!0),vb.saveHistory(b)}),a.addMessages(vb.getHistory(),!0))})})}},{key:"onScroll",value:function(a,b){b.stopPropagation();var c=b.target;return c!==this.msgContainer()||(c.scrollHeight-(c.scrollTop+qb(c).outerHeight())<5?this.autoScrolling(!0):this.autoScrolling(!1),!0)}},{key:"autoScrollChatToBottom",value:function(){this.autoScrolling()&&L(this.msgContainer())}},{key:"scrollChatToBottom",value:function(){L(this.msgContainer())}},{key:"onMessageReceived",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},b=a.text,c=void 0===b?"":b,d=a.name,e=void 0===d?"":d,f=a.avatar,g=void 0===f?"":f,h=a.title,i=void 0===h?"":h,j=a.isGreeter,k=void 0!==j&&j;c&&this.addMessage({text:k&&M(this.messages(),c)?"":c}),e&&this.manager.name(e),g?this.manager.avatar("url("+g+")"):this.manager.avatar(null),k?this.manager.title(i):this.manager.title(ea("builtin.manager_title"))}},{key:"addMessages",value:function(a){var b=this,c=arguments.length>1&&void 0!==arguments[1]&&arguments[1];ko.utils.arrayForEach(a,function(a){return b.addMessage(a,c)})}},{key:"addMessage",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.messages(K(this.messages().concat(H([new sb({ts:a.ts,from:a.from,own:a.own,text:a.text})],this.messageLengthLimit)))),this.visible()||b||this.unreadMessagesCount(this.unreadMessagesCount()+1),this.autoScrollChatToBottom()}},{key:"chatLength",value:function(a){var b=vb.getHistory();return CBHCore.helpers.isArray(b)?!0!==a?b.length:b.filter(function(a){return a.own&&!0===a.own}).length:null}},{key:"send",value:function(){var b=this.message().substring(0,this.messageLengthLimit),c=0===this.chatLength(!0);b.length&&(ba.fakeChatMessages||G("message",{text:b}),this.addMessage({text:b,own:!0}),this.message(""),this.inputFocused(!0),this.scrollChatToBottom(),c&&a.sendCustomizedMarketingEvent("Callbackhunter_SEND_BUILTIN","sent"))}},{key:"close",value:function(){this.inputFocused(!1),this.visible(!1)}},{key:"toggleChatEnded",value:function(){this.chatEnded(!this.chatEnded())}},{key:"onKeypress",value:function(a,b){return 13===b.keyCode&&this.send(),this.message().length<=this.messageLengthLimit}}]),b}()},xb=function a(b){ma(this,a),this.sharedObservables=b.sharedObservables},yb=function(a){return function(b){function c(b){ma(this,c);var d=qa(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,a));return d.chatSettings=b.chatSettings,d.managerTitleEnabled=!1,d.title=ko.computed(function(){return d.chatSettings&&d.chatSettings.managerTitle||""}),d.name=ko.computed(function(){return d.chatSettings&&d.chatSettings.managerName||""}),d.text=ko.computed(function(){return d.chatSettings&&d.chatSettings.text||""}),d}return pa(c,b),na(c,[{key:"click",value:function(){this.sharedObservables.snippetClicked(!0)}},{key:"close",value:function(){this.sharedObservables.snippetClosed(!0)}}]),c}(xb)},zb=1e3,Ab=function(a){return function(){function b(c){var d=this;ma(this,b),this.__=ea,this.user=c.user,this.activeSlide=c.activeSlide,this.sliderOpen=c.sliderOpen,this.channelsVisible=c.channelsVisible,this.activeSubslide=c.activeSubslide,this.dataAgreement=ko.observable(!0),this.sliderVisible=c.sliderVisible,this.emailText=ko.observable(""),this.sendAttempt=ko.observable(!1),this.textOk=ko.computed(function(){return d.emailText().length>0&&d.emailText().length<zb}),this.emailOk=ko.computed(function(){return d.user.isEmailValid()}),this.initExitPrevention(),this.bgVideoRef=ko.observable(null),a.backgroundVideo.subscribe(function(){return ub.loadPlayer(a.backgroundVideo(),d.bgVideoRef())})}return na(b,[{key:"initExitPrevention",value:function(){var a=this,b=function(b,c){!a.exitTarget&&c&&b&&a.emailText().length>0?setTimeout(function(){a.sliderOpen(!0),a.activeSlide("email"),a.channelsVisible(!1),setTimeout(function(){a.activeSubslide("email_exit"),a.exitTarget=c})}):a.exitTarget=null},c=null;this.exitTarget=null,this.activeSlide.subscribe(function(a){c=a},null,"beforeChange"),this.activeSlide.subscribe(function(){var d=a.activeSlide();a.sendAttempt()||"email"===d||"email"!==c||b(a.sliderOpen(),d),c=d}),this.sliderOpen.subscribe(function(a){"email"===c&&b(a,"close")},null,"beforeChange")}},{key:"show",value:function(){var a=this;this.exitTarget=null,this.channelsVisible(!0),this.activeSlide("email"),setTimeout(function(){return a.activeSubslide("email_main")})}},{key:"close",value:function(){var a=this;if(this.activeSubslide("email_main"),"close"!==this.exitTarget)return this.sliderOpen(!0),void setTimeout(function(){a.activeSlide(a.exitTarget),a.sliderOpen(!0),a.exitTarget=null});this.channelsVisible(!0),setTimeout(function(){return a.sliderOpen(!1)})}},{key:"send",value:function(){var b=this;if(this.sendAttempt(!0),this.textOk()&&this.emailOk()){a.sendCustomizedMarketingEvent("cbh_desktop_email","sent"),a.sendCustomizedMarketingEvent("Callbackhunter_SEND_EMAIL","sent");var c=this.emailText().trim().substr(0,zb);this.sliderVisible(!0),this.activeSlide("call"),this.activeSubslide("email_success"),this.sendAttempt(!1),CBHCore.server.send({lang:CBHCore.lang.langCode,question:JSON.stringify({question:c,name:this.user.name(),phone:this.user.phone(),email:this.user.email(),type:"email"})},"/hunter/",function(a){"success"===a.result?b.emailText(""):b.activeSubslide("email_failure")})}}}]),b}()},Bb=function a(b){var c=this;ma(this,a),this.count=b.count,this.visible=ko.computed(function(){return c.count()>0}),this.unreadMessagesPresentation=ko.computed(function(){return Math.min(99,c.count())})},Cb=function(a){return function(b){function c(b){ma(this,c);var d=qa(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,a));return d.viewmodel=a,d.priorityChannel=b.priorityChannel,d.hasCalls=b.hasCalls,d.caught=b.caught,d.hasChats=b.hasChats,d.sliderOpen=b.sliderOpen,d.changeSliderOpenState=b.changeSliderOpenState,d.activeSlide=b.activeSlide,d.sliderVisible=b.sliderVisible,d.channelsVisible=b.channelsVisible,d.resetCatching=b.resetCatching,d.customGreeterSettings=b.customGreeterSettings,d.applyGreeterSettings=b.applyGreeterSettings,d.unreadMessagesCount=b.unreadMessagesCount,d.chatsManager=b.chatsManager,d.callbackIcons=ko.observableArray([]),d.customBrandLogo=ko.observable(),d.rotatingCallIcon=ko.observable(),d.activeRotatingIcons=ko.observable(),d.animatePhoneIcon=ko.observable(),d.alternativeButton=ko.computed(function(){return d.sliderOpen()&&"callback"!==d.activeSlide()&&d.channelsVisible()}),d.animationIntervals=[],d.setupButtonLogo(),d.setupAnimation(),d.customGreeterSettings.chat.subscribe(function(a){a&&a.managerAvatar?(d.setupButtonLogo(a.managerAvatar),d.setupAnimation(!0)):(d.setupButtonLogo(),d.setupAnimation())}),d.initListeners(),d}return pa(c,b),na(c,[{key:"initListeners",value:function(){var a=this;this.sharedObservables.snippetClicked.subscribe(function(b){b&&a.click()}),this.sharedObservables.snippetClosed.subscribe(function(b){b&&a.closeSlider()})}},{key:"setupButtonLogo",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(a)this.customBrandLogo("url("+a+")");else{var b=CBHCore.brand_logo||ha.brand_logo;b?this.customBrandLogo("url(//"+CBHCore.opt.static_domain+"/uploads/brand_logo/"+b+")"):this.customBrandLogo("")}}},{key:"setupAnimation",value:function(){var a=this,b=arguments.length>0&&void 0!==arguments[0]&&arguments[0],c=["logo"];b||(this.hasChats&&c.unshift("chat"),this.hasCalls&&c.unshift("phone")),this.callbackIcons(c),this.animationIntervals.forEach(function(a){clearInterval(a)}),this.animationIntervals=[],this.rotatingCallIcon(this.callbackIcons()&&this.callbackIcons()[0]);var d=setInterval(function(){a.callbackIcons().length>1&&a.rotatingCallIcon(N(a.callbackIcons(),a.rotatingCallIcon()))},5e3);this.animationIntervals.push(d),this.activeRotatingIcons(!1);var e=setInterval(function(){a.activeRotatingIcons(!0),setTimeout(function(){a.activeRotatingIcons(!1)},3e3)},7e3);this.animationIntervals.push(e),this.animatePhoneIcon(!1);var f=setInterval(function(){a.animatePhoneIcon(!0),setTimeout(function(){a.animatePhoneIcon(!1)},3e3)},9e3);this.animationIntervals.push(f)}},{key:"toggleSlider",value:function(a){var b=this;this.changeSliderOpenState(a),a?setTimeout(function(){return b.sliderVisible(!0)}):(this.caught(!1),this.channelsVisible(!0),this.changeSliderOpenState(!1))}},{key:"closeSlider",value:function(){this.toggleSlider(!1),this.resetCatching()}},{key:"click",value:function(){this.sliderOpen()||a.showReason(CBHCore.showReasons.BUTTON);var b="Callbackhunter_WIDGET",c="callback",d=!1;this.hasCalls||"call-now"!==this.activeSlide()||this.activeSlide("callback"),
"builtin-snippet"===this.activeSlide()||this.chatsManager.isChatEnabled("builtin")&&this.unreadMessagesCount()>0?c="builtin":_a.supportedPriorityChannel(this.priorityChannel)&&(c="builtin"===this.priorityChannel||"email"===this.priorityChannel?this.priorityChannel:"social"),this.sliderOpen()&&"builtin-snippet"!==this.activeSlide()?(ua.savePriorityChannel("callback"),this.isOnFirstGreeterSliderScreen()?d=!0:"social"===this.activeSlide()?(this.activeSlide("callback"),b="Callbackhunter_PHONEICON",d=!0):-1===["social","callback"].indexOf(this.activeSlide())?(this.activeSlide("callback"),b="Callbackhunter_PHONEICON",d=!0):(this.channelsVisible(!0),b="Callbackhunter_WIDGET")):(this.activeSlide(c),b="Callbackhunter_PHONEICON",d=!0),d&&!this.sliderOpen()&&this.resetCatching(),this.toggleSlider(d),a.sendCustomizedMarketingEvent(b,"clicked"),this.activeSlide.notifySubscribers()}},{key:"isOnFirstGreeterSliderScreen",value:function(){if("slider"!==this.viewmodel.greeterType())return!1;if("callback"!==this.activeSlide()||"catch"!==this.viewmodel.activeSubslide())return!1;var a=this.viewmodel.getGreeterData();return a&&a.firstScreenEnabled&&!0===a.firstScreenEnabled}}]),c}(xb)},Db=function(){function a(b){var c=this;ma(this,a),this.backgroundImage=b.backgroundImage||ko.observable(""),this.backgroundColor=b.backgroundColor||ko.observable(""),this.backgroundVideo=b.backgroundVideo||ko.observable(""),this.textColor=b.textColor||ko.observable(""),this.customSettings=b.customSettings,this.videoIsReady=ko.observable(!1),this.bgVideoRef=ko.observable(),this.backgroundImage(null),this.backgroundColor(null),this.hasCarrousel=ko.computed(function(){return c.customSettings()&&"preset"===c.customSettings().bgChoice&&-1!==ba.bgCarrouselHostname.indexOf(window.location.hostname)}),this.carrouselInitialized=!1,CBHCore.helpers.isFunction(b.videoLoaded)&&(this.readyToDisplay=ko.computed(function(){return!c.backgroundVideo()||c.videoIsReady()||CBHCore.helpers.isEmpty(c.customSettings())}),this.readyToDisplay.subscribe(function(){b.videoLoaded(c.readyToDisplay())}),b.videoLoaded(this.readyToDisplay()))}return na(a,[{key:"init",value:function(){this.setupBackground(),this.subscribeTo()}},{key:"subscribeTo",value:function(){var a=this;this.customSettings.subscribe(function(){a.setupBackground()})}},{key:"setupBackground",value:function(){var a=this;this.hasCarrousel.subscribe(function(b){return b&&a.setupCarrouselBackground()}),this.setupStaticBackground()}},{key:"getPresetName",value:function(a){return a+"_"+((arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)+1)+".png"}},{key:"getImageURL",value:function(a,b){if(/^http(s)?/.test(a))return a;var c="//"+CBHCore.opt.static_domain+"/uploads";return b&&(c+="/preset"),c+="/greeter/"+this.type+"/"+a}},{key:"setBg",value:function(a,b,c){if(!b)return void a("none");a("url("+this.getImageURL(b,c)+")")}},{key:"setBgVideo",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return a?(this.backgroundVideo(a),ub.loadPlayer(a,this.bgVideoRef(),this.videoIsReady),!0):(this.backgroundVideo(""),!1)}},{key:"clearCarrouselTimeouts",value:function(){this.nextCarrouselTimeoutId&&window.clearTimeout(this.nextCarrouselTimeoutId),this.setBgTimeoutId&&window.clearTimeout(this.setBgTimeoutId)}},{key:"nextCarrousel",value:function(){var a=this,b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.clearCarrouselTimeouts();var c=this.key();-1!==this.presetsWithBlackText.indexOf(b)?this.textColor("#000000"):-1!==this.presetsWithWhiteText.indexOf(b)?this.textColor("#ffffff"):this.textColor(this.originalTextColor),this.presetCounter(b);var d=void 0,e=void 0;this.oddCounter()?(d=this.backgroundImageNext,e=this.backgroundImage):(d=this.backgroundImage,e=this.backgroundImageNext),this.setBg(d,this.getPresetName(c,b),!0);var f=(b+1)%ba.bgCarrouselCount,g=this.getPresetName(c,f);(new Image).src=this.getImageURL(g,!0),this.setBgTimeoutId=setTimeout(function(){return a.setBg(e,g,!0)},ba.bgCarrouselInterval+500),this.nextCarrouselTimeoutId=setTimeout(function(){return a.nextCarrousel(f)},ba.bgCarrouselInterval)}},{key:"setupCarrouselBackground",value:function(){var a=this;this.carrouselInitialized||(this.carrouselInitialized=!0,this.backgroundImageNext=ko.observable(this.backgroundImage()),this.originalTextColor=this.textColor(),this.presetCounter=ko.observable(),this.oddCounter=ko.computed(function(){return Boolean(a.presetCounter()%2)}),this.fallback=!ua.areClipPathShapesSupported(),this.nextCarrousel())}}]),a}(),Eb=function(a){function b(a){ma(this,b);var c=qa(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.type="slider",c.caught=a.caught,c.key=ko.computed(function(){return c.customSettings()?"default":c.caught()?"catcher":"slider"}),c.presetsWithBlackText=[8],c.presetsWithWhiteText=[],oa(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"init",c).call(c),c}return pa(b,a),na(b,[{key:"subscribeTo",value:function(){var a=this;oa(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"subscribeTo",this).call(this),this.caught.subscribe(function(){a.setupBackground()})}},{key:"setupStaticBackground",value:function(){var a=this.customSettings();CBHCore.helpers.isEmpty(a)?this.setupDefaultBackground():this.setupCustomBackground(a)}},{key:"setupCarrouselBackground",value:function(){var a=this;oa(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"setupCarrouselBackground",this).call(this),this.caught.subscribe(function(){a.nextCarrousel()})}},{key:"getImageURL",value:function(a,c){if(this.hasCarrousel()&&this.customSettings())return oa(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"getImageURL",this).call(this,a,c);if(/^http(s)?/.test(a))return a;var d="//"+CBHCore.opt.static_domain+"/uploads/slide_image";return c&&(d+="/preset"),d+="/"+a}},{key:"setupDefaultBackground",value:function(){var a=this.key();if(void 0!==ha[a+"_bg_choice"])switch(this.setBgVideo(),ha[a+"_bg_choice"]){case"preset":this.setBg(this.backgroundImage,ha[a+"_bg_preset"],!0),this.backgroundColor("transparent");break;case"file":this.setBg(this.backgroundImage,ha[a+"_bg_image"],!1),this.backgroundColor("transparent");break;case"color":this.backgroundColor("#"+ha[a+"_bg_color_code"])}}},{key:"setupCustomBackground",value:function(a){switch(a.bgChoice){case"color":this.backgroundColor(Oa.colorFilter(a.bgColor)),this.setBg(this.backgroundImage,""),this.setBgVideo();break;case"preset":this.setBg(this.backgroundImage,a.links.background.href||""),this.backgroundColor("transparent"),this.setBgVideo();break;case"file":this.setBg(this.backgroundImage,a.bgFile,!1,!0),this.backgroundColor("transparent"),this.setBgVideo();break;case"video":this.backgroundColor("transparent"),this.setBg(this.backgroundImage,""),this.setBgVideo(a.bgVideo);break;default:this.setupDefaultBackground()}}}]),b}(Db),Fb=function(a){function b(a){ma(this,b);var c=qa(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.type="banner",c.titleColor=a.textColor,c.subtitleColor=a.textColor,c.titleText=a.titleText,c.subtitleText=a.subtitleText,c.stdDeviation=a.stdDeviation,c.key=ko.observable("default"),c.bgClearImage=ko.computed(function(){return c.backgroundImage()&&"none"!==c.backgroundImage()?c.backgroundImage().replace(/^url\((['"])?/,"").replace(/\)(['"])?;?$/,""):""}),c.presetsWithBlackText=[0,3,5,12,13],c.presetsWithWhiteText=[1,2,4,6,7,8,9,10,11,14,15,16],oa(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"init",c).call(c),c}return pa(b,a),na(b,[{key:"setBgVideo",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.backgroundColor("transparent"),oa(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"setBgVideo",this).call(this,a)&&this.setBgImage(this.backgroundImage,ub.getThumbnailLink(a))}},{key:"setBgImage",value:function(a,b){if(!b)return void a("none");a("url("+this.getImageURL(b)+")")}},{key:"setupStaticBackground",value:function(){var a=this.customSettings();CBHCore.helpers.isEmpty(a)||this.setupCustomBackground(a)}},{key:"setupCustomBackground",value:function(){var a=this.customSettings();switch(a.bgChoice){case"color":this.backgroundColor(Oa.colorFilter(a.bgColor)),this.setBgImage(this.backgroundImage,""),this.setBgVideo();break;case"preset":this.setBgImage(this.backgroundImage,a.bgFile||null),this.setBgVideo();break;case"file":this.setBgImage(this.backgroundImage,a.bgFile,!1),this.setBgVideo();break;case"video":this.setBgVideo(a.bgVideo);break;default:this.backgroundColor(Oa.colorFilter(this.defaultSettings.bgColor)),this.setBgImage(this.backgroundImage,"")}}}]),b}(Db),Gb=function(a,b){return function(c){function d(c){ma(this,d);var e=qa(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,a));return e.vm=null,e.close=function(){e.viewmodel.resetCatching("banner")},e.tpl=b,e.viewmodel=a,e.dataAgreement=ko.observable(!0),e.user=e.viewmodel.user,e.sliderVisible=a.sliderVisible,e.vm=a,e.customSettings=c.bannerSettings,e.bg={image:ko.observable(""),color:ko.observable(""),video:ko.observable(""),feGaussianBlurStdDeviation:ko.observable(15)},e.readyToDisplay=ko.observable(),e.readyToDisplay.subscribe(function(){e.sharedObservables.bannerLoaded(e.readyToDisplay())}),e.sharedObservables.bannerLoaded(e.readyToDisplay()),e.setupDefaults(),e.setupSettings(),e.timerIsValid=ko.computed(function(){if(!e.timerEnabled())return!1;var a=parseInt(e.timerEndTs(),10),b=Math.round((new Date).getTime()/1e3);return!(!a||a<b)}),e.callTextColor=ko.computed(function(){return Oa.getWhiteOrBlack(e.buttonsColor()||e.defaultSettings.buttonsColor)}),e.wrongNumberError=ko.observable(!1),e.dataAgreementError=ko.observable(!1),e.showPoweredBy=ko.observable(ha.show_powered_by),e.getRightBgColor=ko.computed(function(){return e.bg.video()?e.rightBgColor():e.defaultSettings.rightBgColor}),e.getRightHeaderBgColor=ko.computed(function(){return e.timerIsValid()?"transparent":Oa.errorlessLighten(.1,Oa.colorFilter(e.getRightBgColor()))}),e.closeColor=ko.computed(function(){return Oa.errorlessDarken(.15,Oa.colorFilter(e.rightTitleColor()))}),e.customSettings.subscribe(function(a){e.updateSettings(a)}),e.viewmodel.widgetIsOpen.subscribe(function(a){a&&e.viewmodel.isBannerVisible()&&e.close()}),e}return pa(d,c),na(d,[{key:"getDefaultSetting",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return-1!==Object.keys(this.defaultSettings).indexOf(a)?this.defaultSettings[a]:b}},{key:"setupDefaults",value:function(){this.defaultSettings={bgChoice:"color",bgColor:"#ccc",bgFile:"",bgPresetId:"",bgVideo:"",buttonsColor:"#2199ff",callButtonText:"",rightBgColor:"#ccc",rightSubtitleColor:"#fff",rightSubtitleText:"",rightTitleColor:"#fff",rightTitleText:"",rightTitlePhoneText:"",rightTitlePhoneColor:"#fff",subtitleColor:"#fff",subtitleText:"",timerColor:"#fff",timerEnabled:0,timerEndTs:0,timerTitleText:"",titleColor:"#000",titleText:""}}},{key:"setupSettings",value:function(){var a=this;Object.keys(this.defaultSettings).forEach(function(b){a[b]=ko.observable(a.getDefaultSetting(b))})}},{key:"updateSettings",value:function(a){var b=this;CBHCore.helpers.isEmpty(a)||Object.keys(this.defaultSettings).forEach(function(c){b[c](a[c]||b.getDefaultSetting(c))})}},{key:"callOrder",value:function(){var a=!0;this.user.isPhoneValid()||(ua.blinkObservable(this.wrongNumberError),a=!1),this.dataAgreement()||(ua.blinkObservable(this.dataAgreementError),a=!1),a&&(this.vm.sendCustomizedMarketingEvent("Callbackhunter_CALL_BUTTON","clicked"),ClbhObject.showSimpleDialog(!0,"aside"),this.viewmodel.activeSlide("call-now"))}}]),d}(xb)},Hb=function(){function a(b){var c=this;ma(this,a),this.__=ea,this.timerEndTs=b.timerEndTs,this.timerColor=b.timerColor,this.timerTitleText=b.timerTitleText,this.timerInterval=null,this.daysLeft=ko.observable("00"),this.hoursLeft=ko.observable("00"),this.minutesLeft=ko.observable("00"),this.secondsLeft=ko.observable("00"),this.timerIsValid=ko.observable(!1),this.secondsMap={d:86400,h:3600},this.timerEndTs.subscribe(function(){c.startTimer()})}return na(a,[{key:"startTimer",value:function(){var a=this,b=parseInt(this.timerEndTs(),10),c=Math.round((new Date).getTime()/1e3);if(!b||b<c)return this.timerIsValid(!1),void clearInterval(this.timerInterval);this.timerIsValid(!0),this.tsLeft=b-c,this.timeCounter(),this.timerInterval=setInterval(function(){a.timeCounter()},1e3)}},{key:"timeCounter",value:function(){this.tsLeft--;var a=this.tsLeft,b=Math.floor(a/this.secondsMap.d);a-=b*this.secondsMap.d;var c=Math.floor(a/this.secondsMap.h);a-=c*this.secondsMap.h;var d=Math.floor(a/60);a-=60*d,this.daysLeft(this.formatDigit(b)),this.hoursLeft(this.formatDigit(c)),this.minutesLeft(this.formatDigit(d)),this.secondsLeft(this.formatDigit(a)),this.tsLeft<=0&&clearInterval(this.timerInterval)}},{key:"formatDigit",value:function(a){return a<10?"0"+a:a}}]),a}(),Ib=function(a){return function(){function b(c){var d=this;ma(this,b);var e=CBHCore.helpers.isFunction,f=CBHCore.helpers.empty,g=ko.observableArray(c.channels.slice(0,6)||[]),h=c.deeplinks,i=c.sliderVisible;this.close=c.close,this.denyActiveButtonState=c.denyActiveButtonState||!1,this.visible=c.visible,this.buttonsColor=c.buttonsColor,this.channels=ko.observableArray(ko.utils.arrayMap(g(),function(b){return{name:b,action:function(){e(c.activeSlide)&&(!f(c.deeplinks.config[b])&&e(h[b])?h[b]():(d.close(),"builtin"!==b&&"email"!==b||i(!0),"sms"===b&&ClbhObject.showSimpleDialog(!0,"aside"),setTimeout(function(){c.activeSlide(b)},0),a.sendCustomizedMarketingEvent("Callbackhunter_SOCIAL_BUTTON_"+b.toUpperCase(),"clicked")))}}}))}return b}()},Jb=function(a,b){function c(a){return CBHCore.helpers.isFunction(b[a])?'<script type="text/html" id="'+a+'">'+b[a]()+"<\/script>":null}var d=["social","enter_phone","sms_phone","sms_message","sms_success","sms_failure","email_success","email_failure","call_disabled","call_now","call_later","select_office","call_result","call_failure","call_rating","call_later_success","call_free_success","call_timer","catch"];ko.components.register("slider",{viewModel:db(a,b),template:b.slider__index({templates:function(a,b){return ko.utils.arrayMap(b,function(b){var d=c("widget_"+b);return d||c(a+"_"+b)}).join("")}("slider",d)})}),ko.components.register("banner",{viewModel:Gb(a,b),template:b.banner_main()}),ko.components.register("banner-action-timer",{viewModel:Hb,template:b["banner_action-timer"]()}),ko.components.register("banner-channels",{viewModel:Ib(a),template:b.banner_channels()}),ko.components.register("powered-by",{viewModel:eb(a),template:b["powered-by"]()}),ko.components.register("checkbox",{viewModel:gb,template:b.checkbox()}),ko.components.register("builtin",{viewModel:wb(a),template:b.builtin()}),ko.components.register("builtin-snippet",{viewModel:yb(a),template:b["builtin-snippet"]()}),ko.components.register("email",{viewModel:Ab(a),template:b.email()}),ko.components.register("channels",{viewModel:hb(a),template:b.channels()}),ko.components.register("unread-messages-counter",{viewModel:Bb,template:b["unread-messages-counter"]()}),ko.components.register("main-button",{viewModel:Cb(a),template:b["main-button"]()}),ko.components.register("select",{viewModel:Ra,template:b.select()}),ko.components.register("rating",{viewModel:Sa,template:b.rating()}),ko.components.register("slider-background",{viewModel:Eb,template:b.slider_background()}),ko.components.register("banner-background",{viewModel:Fb,template:b.banner_background()}),ko.components.register("banner-right-side-background",{viewModel:Fb,template:b.banner_right_side_background()})},Kb="auto",Lb="auto",Mb="25px",Nb="25px",Ob=625,Pb=function(){function a(b){function c(){return-1!==["builtin","builtin-snippet","email"].indexOf(i())}var d=this,e=b.mainButtonRef,f=b.builtinRef,g=b.snippetContainerRef,h=b.buttonSize,i=b.activeSlide,j=b.activeSubslide,k=b.hasCalls,l=b.commList,m=b.caught,n=b.channelsVisible,o=b.sliderOpen;ma(this,a),this.mainButtonRef=e,this.builtinRef=f,this.snippetContainerRef=g,this.caught=m,this.commList=l,this.sliderOpen=o,this.channelsVisible=n,this.activeSlide=i,this.activeSubslide=j,this.hasCalls=k,this.right=ko.observable(),this.left=ko.observable(),this.bottom=ko.observable(),this.top=ko.observable(),this.builtinHeight=ko.observable(),this.btnSize=ko.observable(h),this.calcSizes(),this.quadrant=ko.observable(),m()?(this.right(null),this.left(null),this.bottom(null),this.top(null)):(this.right(Mb),this.left(Kb),this.bottom(Nb),this.top(Lb)),this.builtinHeight(Ob),this.sliderTop=ko.computed(function(){return m()?null:c()?O(d.btnSize()+8,d.top):O(d.btnSize()+24,d.top)}),this.sliderBottom=ko.computed(function(){return m()?null:c()?O(d.btnSize()+9,d.bottom):O(d.btnSize()+12,d.bottom)}),this.sliderRight=ko.computed(function(){return m()?null:c()?"builtin-snippet"===d.activeSlide()?d.right:O(-13,d.right):O(d.sliderOpen()?31:4,d.right)}),this.sliderLeft=ko.computed(function(){return m()?null:c()?O(-16,d.left):O(d.sliderOpen()?33:0,d.left)}),this.calcSizes(),ko.utils.registerEventHandler(window,"resize",ua.debounce(function(){d.reposition()},50))}return na(a,[{key:"calcSizes",value:function(){var a=this,b=ko.computed(function(){return a.btnSize()/64});this.newMessagesSize=ko.computed(function(){return Math.ceil(19*b())}),this.newMessagesPosition=ko.computed(function(){return Math.ceil(3*b())}),this.newMessagesLineHeight=ko.computed(function(){return Math.ceil(15*b())}),this.smallBtnSize=ko.computed(function(){return Math.ceil(46*b())}),this.smallBtnMarginRight=ko.computed(function(){return Math.ceil(7*b())}),this.smallBtnLastMarginRight=ko.computed(function(){return Math.ceil(9*b())}),this.smallBtnMarginTop=ko.computed(function(){return(a.btnSize()-a.smallBtnSize())/2}),this.iconFontSize=ko.computed(function(){return Math.ceil(16*b())}),this.mainButtonCloseOverlap=ko.computed(function(){return a.hasCalls?Math.ceil(8*b()):0}),this.sliderWidth=ko.computed(function(){return a.sliderOpen()&&a.channelsVisible()?a.commList.length*(a.smallBtnSize()+a.smallBtnMarginRight()+a.smallBtnLastMarginRight())+2*a.btnSize():a.sliderOpen()&&-1!==["enter_phone","select_office","call_timer","call_later","call_later_success","call_free_success","call_result","call_rating","call_failure","sms_message","sms_failure","sms_success","email_exit","email_failure","email_success"].indexOf(a.activeSubslide())?2*a.btnSize():a.btnSize()})}},{key:"reposition",value:function(){this.setViewportsize();var a=this.getButtonSize(),b=a.width,c=a.height;this.btnSize(b);var d=!1,e=!1;if(this.caught())this.right(null),this.left("calc(50% + "+((550-this.sliderWidth())/2-3)+"px)"),this.bottom(null),this.top(null);else{var f=void 0,g=void 0,h=void 0,i=void 0,j=void 0;void 0!==ha.phoneicon_x&&0<=ha.phoneicon_x&&ha.phoneicon_x<=100&&(j=CBHCore.helpers.clamp(ha.phoneicon_x,0,100),j<50?(e=!0,f=(this.viewportSize.width-b)*(j/100)+"px",g="auto"):(e=!1,f="auto",g=(this.viewportSize.width-b)*(1-j/100)+"px")),void 0!==ha.phoneicon_y&&(j=CBHCore.helpers.clamp(ha.phoneicon_y,0,100),j<50?(d=!0,i=(this.viewportSize.height-c)*(j/100)+"px",h="auto"):(d=!1,i="auto",h=(this.viewportSize.height-c)*(1-j/100)+"px")),this.right(g),this.left(f),this.bottom(h),this.top(i)}this.setQuadrant(d,e),this.setBuiltinHeight(d)}},{key:"getButtonSize",value:function(){var a=void 0,b=void 0;if(this.mainButtonRef()&&CBHCore.helpers.isFunction(window.getComputedStyle)){var c=window.getComputedStyle(this.mainButtonRef());a=parseInt(c.getPropertyValue("width"),10),b=parseInt(c.getPropertyValue("height"),10)}return(!a||isNaN(a)||a<0)&&(a=64),(!b||isNaN(b)||b<0)&&(b=64),{width:a,height:b}}},{key:"setViewportsize",value:function(){this.viewportSize=CBHCore.helpers.viewportSize()}},{key:"setButtonSize",value:function(a){this.btnSize(a)}},{key:"setQuadrant",value:function(a,b){a&&b?this.quadrant("tl"):a&&!b?this.quadrant("tr"):!a&&b?this.quadrant("bl"):this.quadrant("br")}},{key:"setBuiltinHeight",value:function(a){if(this.builtinRef()&&CBHCore.helpers.isFunction(this.builtinRef().getBoundingClientRect)){var b=this.builtinRef().getBoundingClientRect(),c=a?this.viewportSize.height-b.top:b.bottom;"builtin-snippet"===this.activeSlide()&&this.snippetContainerRef()&&CBHCore.helpers.isFunction(this.snippetContainerRef().getBoundingClientRect)&&(b=this.snippetContainerRef().getBoundingClientRect(),c=a?this.viewportSize.height-b.top:b.bottom-b.top+20),0===c&&(c=Ob),this.builtinHeight(CBHCore.helpers.clamp(c,250,Ob)+"px")}}}]),a}(),Qb=!1,Rb={blockAutoPopup:!1,lastTs:(new ba.StrongDate).getTime()},Sb=function(){function a(b){var c=this;ma(this,a),this.applyGreeterSettings=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,e=CBHCore.helpers.isEmpty(b),f=0;(!c.widgetDrawEndTS||(new Date).getTime()-c.widgetDrawEndTS<100)&&(f=100),setTimeout(function(){if(c.greeterUid(e?null:b.greeterUid),c.seoId(e?null:b.seoId),c.customGreeterSettings[a](e?null:b),CBHCore.helpers.isFunction(d))return d()},f)},this.changeSliderOpenState=function(a){c.sliderOpen(a)},this.updateColors=function(){var a=c.getGreeterData();if(a&&a.buttonsColor){var b=c.greeterBodyClass();c.setupCustomColor("slider","#"+a.buttonsColor,b),c.setupCustomColor("email-container","#"+a.buttonsColor,b),c.setupIconsColor("buttons",a.buttonsColor,b,!0)}else ha.catcher_icon_color_code&&c.setupCustomColor("catch","#"+ha.catcher_icon_color_code),ha.phone_icon_color_code&&(c.setupCustomColor("slider","#"+ha.phone_icon_color_code),c.setupCustomColor("email-container","#"+ha.phone_icon_color_code)),ha.catcher_icons_color&&c.setupIconsColor("catch","#"+ha.catcher_icons_color),ha.slider_icons_color&&c.setupIconsColor("slider","#"+ha.slider_icons_color)},this.resetCatching=function(a){if("all"===a)Object.keys(c.customGreeterSettings).forEach(function(a){c.applyGreeterSettings(a,null)});else{var b=c.greeterType();b&&c.applyGreeterSettings(b,null)}c.setPopupBlocking(!1),c.setGreeterQueueActivity(!0)},this.forceCloseWidget=function(){c.caught(!1),c.channelsVisible(!0),c.changeSliderOpenState(!1),c.activeSlide(""),c.resetCatching("all")},this.__=ea,this.tpl=b,this.widgetDrawEndTS=0,this.showReason=ko.observable(CBHCore.showReasons.BUTTON),this.seoId=ko.observable(null),this.worktime=ko.observable(CBHCore.isWorkTime()),this.freeMode=ko.observable(CBHCore.helpers.freeMode()),this.hasSms=ko.observable(CBHCore.helpers.hasSms()),this.user=new Qa(this.freeMode()),this.countdown=parseInt(ha.time_connection,10),this.activeSlide=ko.observable("callback"),this.activeSubslide=ko.observable(),this.activeSocial=ko.observable(),this.sliderOpen=ko.observable(!1),this.caught=ko.observable(!1),this.slideVisibleComputed=[],this.slideInvisibleComputed=[],this.hidePill=void 0===ha.phone_icon||0===ha.phone_icon||CBHCore.hidePill,this.customCSSRules={default:[],byBodyClass:[]},this.customBodyClassCSSRules=ko.observableArray([]),this.sharedObservables={snippetClicked:ko.observable(!1),snippetClosed:ko.observable(!1),bannerLoaded:ko.observable(!1)},this.caught.subscribe(function(){(c.hasCalls||c.hasChats)&&(c.caught()?(ua.aC(document.body,"cbh-no-scroll"),setTimeout(function(){return c.catchVisible(!0)}),c.changeSliderOpenState(!0)):ua.rC(document.body,"cbh-no-scroll"))}),this.setup(),this.widgetIsOpen=ko.computed(function(){return c.sliderOpen()||c.caught()}),this.widgetIsOpen.subscribe(function(a){a?(c.setPopupBlocking(!0),c.setGreeterQueueActivity(!1)):(c.setPopupBlocking(!1),c.setGreeterQueueActivity(!0))}),Jb(this,b)}return na(a,[{key:"computeIsMainButtonsPlankVisible",value:function(){return!(!this.hasCalls&&!this.hasChats)&&(!(void 0!==this.positioningFinished&&!this.positioningFinished())&&(!!this.sliderVideoLoaded()&&(!this.hidePill||Boolean(this.sliderOpen()))))}},{key:"slideVisible",value:function(a){var b=this;return this.slideVisibleComputed[a]||(this.slideVisibleComputed[a]=ko.computed(function(){return b.sliderOpen()&&b.activeSlide()===a})),this.slideVisibleComputed[a]}},{key:"slideInvisible",value:function(a){var b=this;return this.slideInvisibleComputed[a]||(this.slideInvisibleComputed[a]=ko.computed(function(){return!b.sliderOpen()||b.activeSlide()!==a})),this.slideInvisibleComputed[a]}},{key:"setup",value:function(){this.setupGreeters(),this.setupColors(),this.setupBranding(),this.setupChats(),this.setupPositioning(),this.setupOffices(),this.setupTime(),this.setUpInitialSliderOpenState(),this.setupMisc()}},{key:"setupGreeters",value:function(){var a=this;this.customGreeterSettings={slider:ko.observable(null),chat:ko.observable(null),banner:ko.observable(null)},this.greeterClassPrefix=".greeter-",this.greeterUid=ko.observable(null),this.greeterBodyClass=ko.computed(function(){return a.greeterUid()?a.greeterClassPrefix+a.greeterUid():null}),this.greeterType=ko.computed(function(){return a.customGreeterSettings.slider()?"slider":a.customGreeterSettings.chat()?"chat":a.customGreeterSettings.banner()?"banner":null}),this.isBannerVisible=ko.computed(function(){return!CBHCore.helpers.isEmpty(a.customGreeterSettings.banner())&&a.sharedObservables.bannerLoaded()}),this.sliderVideoLoaded=ko.observable(!0),this.customGreeterSettings.slider.subscribe(function(b){a.updateColors(),a.updatePositioning(),CBHCore.helpers.isEmpty(b)||a.customBodyClassCSSRules(a.customCSSRules.byBodyClass)}),this.customGreeterSettings.chat.subscribe(function(b){a.updateColors(),a.updatePositioning(),CBHCore.helpers.isEmpty(b)||a.customBodyClassCSSRules(a.customCSSRules.byBodyClass)}),this.customGreeterSettings.banner.subscribe(function(b){b&&b.buttonsColor&&a.setupBannerButtonsColor(b.buttonsColor),CBHCore.helpers.isEmpty(b)||a.customBodyClassCSSRules(a.customCSSRules.byBodyClass)})}},{key:"setupBranding",value:function(){this.sliderBackgroundImage=ko.observable(),this.backgroundVideo=ko.observable()}},{key:"updatePositioning",value:function(){var a=this.getGreeterData(),b=this.greeterBodyClass()||"",c=this.pos,d=void 0;a&&a.channelsSize?d=parseInt(a.channelsSize,10):ha.button_size&&(d=parseInt(ha.button_size,10)),c.setButtonSize(d);var e=c.newMessagesSize(),f=c.newMessagesPosition(),g=c.newMessagesLineHeight(),h=c.smallBtnSize(),i=c.smallBtnMarginRight(),j=c.smallBtnLastMarginRight(),k=c.smallBtnMarginTop(),l=c.iconFontSize(),m=c.mainButtonCloseOverlap();this.addCSSRules([".main-button"],"width: "+this.btnSize()+"px; height: "+this.btnSize()+"px;","",b),this.addCSSRules([".main-button.slider-open",".buttons .channels"],"left: auto; right: -"+m+"px;","",b),this.addCSSRules([".left-side .main-button.slider-open"],"left: -"+m+"px;","",b),this.addCSSRules([".left-side.buttons .channels"],"right: auto; left: -"+i+"px;","",b),this.addCSSRules([".main-button i.cbh-new-messages"],"line-height: "+g+"px; font-size: 0.813em;","",b),this.addCSSRules([".buttons .channels ul",".main-button",".main-button i"],"font-size: "+l+"px;","",b),this.addCSSRules([".buttons .channels ul li"],"\n      width: "+h+"px; \n      height: "+h+"px; \n      margin-right: "+i+"px;\n    ","",b),this.addCSSRules([".buttons .channels ul li:last-child"],"\n      margin-right: "+j+"px;\n    ","",b),this.addCSSRules([".buttons.left-side .channels ul li"],"\n      margin-left: "+i+"px;\n    "),this.addCSSRules([".buttons .channels ul"],"\n      margin: "+k+"px 0;\n    ","",b),this.addCSSRules([".buttons"],"height: "+(this.btnSize()+2)+"px; line-height: "+(this.btnSize()+2)+"px;","",b),this.addCSSRules([".buttons .channels ul li .cbh-new-messages.cbh-visible"],"\n      width: "+e+"px; \n      height: "+e+"px; \n      line-height: "+(e-4)+"px\n    ","",b),this.addCSSRules([".buttons .channels ul li .cbh-new-messages.cbh-visible"],"\n      top: -"+f+"px;\n      right: -"+f+"px;\n    ","",b),a&&(this.addCSSRules([".snippet-container .builtin-snippet:after"],"\n        right: "+this.btnSize()/2+"px;\n      ","",b),this.addCSSRules([".snippet-container.left-side .builtin-snippet:after"],"\n        left: "+(this.btnSize()/2-25)+"px;\n        right: auto;\n       ","",b),window.requestAnimationFrame(function(){return c.reposition()}))}},{key:"setupPositioning",value:function(){var a=this;this.positioningFinished=ko.observable(!1),this.sliderVisible=ko.observable(!1),this.catchVisible=ko.observable(!1),this.mainButtonRef=ko.observable(),this.builtinRef=ko.observable(),this.snippetContainerRef=ko.observable(),this.right=ko.observable(),this.bottom=ko.observable(),this.isFixedButton=ko.observable(Boolean(ha.is_fixed_button));var b=void 0;ha.button_size&&(b=parseInt(ha.button_size,10));var c=new Pb({mainButtonRef:this.mainButtonRef,builtinRef:this.builtinRef,snippetContainerRef:this.snippetContainerRef,buttonSize:b,activeSlide:this.activeSlide,activeSubslide:this.activeSubslide,commList:this.commList,hasCalls:this.hasCalls,caught:this.caught,sliderOpen:this.sliderOpen,channelsVisible:this.channelsVisible});this.importPositioning(c),this.mainButtonRef.subscribe(function(){return c.reposition()}),this.activeSlide.subscribe(function(){-1!==["builtin","email","builtin-snippet"].indexOf(a.activeSlide())&&setTimeout(function(){return c.reposition()},250)}),this.caught.subscribe(function(){!a.caught()||"builtin"!==a.activeSlide()&&"email"!==a.activeSlide()||a.caught(!1),window.requestAnimationFrame(function(){return c.reposition()})}),this.activeSubslide.subscribe(function(){window.requestAnimationFrame(function(){return c.reposition()})}),this.updatePositioning(),ua.bodyHasHorizontalScroll()||this.isFixedButton()||ua.aC(document.body,"cbh-no-horizontal-scroll"),setTimeout(function(){return a.positioningFinished(!0)},500)}},{key:"importPositioning",value:function(a){this.pos=a,this.quadrant=a.quadrant,this.right=a.right,this.left=a.left,this.bottom=a.bottom,this.top=a.top,this.sliderTop=a.sliderTop,this.sliderBottom=a.sliderBottom,this.sliderRight=a.sliderRight,this.sliderLeft=a.sliderLeft,this.builtinHeight=a.builtinHeight,this.btnSize=a.btnSize,this.sliderWidth=a.sliderWidth}},{key:"setUpInitialSliderOpenState",value:function(){var a=this;this.isSliderAllowed=ko.computed(function(){return a.caught()||a.hasCalls||a.isChannelEnabled("sms")||a.isChannelEnabled("email")||a.isChannelEnabled("builtin")||_a.supportedPriorityChannel(a.priorityChannel)})}},{key:"setupMisc",value:function(){this.showDataCollectionText=ko.computed(function(){return ea("data_collection.tpl",{link:CBHCore.helpers.getDataCollectionUrl(ea("data_collection.default_link"))})})}},{key:"setupChats",value:function(){var a=this;this.unreadMessagesCount=ko.observable(0),this.chatsManager=new _a(this);var b=this.chatsManager;this.priorityChannel=b.priorityChannel,this.commList=b.commList,this.hasChats=b.hasChats,this.hasCalls=b.hasCalls,this.builtinChatEnabled=b.builtinChatEnabled,this.deeplinks=b.deeplinks,this.deeplinks=b.deeplinks,this.isChannelEnabled=b.isChannelEnabled.bind(b),this.channelsVisible=ko.observable(!0),_a.supportedPriorityChannel(this.priorityChannel)&&"builtin"!==this.priorityChannel&&"email"!==this.priorityChannel&&this.activeSlide("social"),this.isMainButtonsPlankVisible=ko.computed(function(){return a.computeIsMainButtonsPlankVisible()})}},{key:"setupOffices",value:function(){var a=this;this.officeList=ko.observableArray([]),this.officeSelectionList=ko.computed(function(){return ko.utils.arrayMap(a.officeList(),function(a){return{text:a.name,value:a.id}})}),this.selectedOffice=ko.observable(null),this.officeSelectionTitle=ko.observable(ea("select_office")),this.selectedOffice.subscribe(function(b){if(ha.show_office_choice){var c=b?CBHCore.helpers.getOfficeList(b.value):CBHCore.helpers.getOfficeList();c.length>0&&a.selectedOffice()?c[0].promt&&a.officeSelectionTitle(c[0].promt):c.length&&a.officeList(c)}}),this.selectedOffice(0)}},{key:"setupTime",value:function(){var a=this,b=ua.generateDaySelects();this.availableDays=ko.observableArray(b.data),this.selectedDay=ko.observable(null),this.selectedDay.subscribe(function(b){if(b){var c=ua.generateHourSelects(b&&b.value||b);a.availableHours(c.data);var d=c.data.find(function(b){
return a.selectedHour()&&b&&a.selectedHour().text===b.text});a.selectedHour(d||{value:c.firstVal,text:c.firstName})}}),this.selectedHour=ko.observable(null),this.selectedHourValue=ko.computed(function(){return a.selectedHour()&&a.selectedHour().value}),this.availableHours=ko.observableArray([]),this.selectedDay({value:b.firstVal,text:b.firstName,shortText:b.firstShort})}},{key:"setupColors",value:function(){this.sliderBackgroundColor=ko.observable(),this.sliderTextColor=ko.observable(),ba.disableCustomColors||this.updateColors()}},{key:"setupBannerButtonsColor",value:function(a){var b=Oa.colorFilter(a),c=Oa.getWhiteOrBlack(b),d=Oa.errorlessDarken(.1,Oa.colorFilter(b));this.addCSSRules([".buttons .channels ul li",".banner-body .call-order .enter-phone .button"],"\n      background-color: "+b+" !important;\n    ",".banner-container",this.greeterBodyClass()),this.addCSSRules([".banner-body .call-order .enter-phone .button:hover"],"\n      background-color: "+d+" !important;\n    ",".banner-container",this.greeterBodyClass()),this.addCSSRules([".banner-body .call-order .enter-phone .button"],"\n      box-shadow:0px 2px 3px 0px "+d+" !important;\n    ",".banner-container",this.greeterBodyClass()),this.addCSSRules([".buttons .channels ul li:after"],"\n      color: "+c+" !important;\n    ",".banner-container",this.greeterBodyClass())}},{key:"setupIconsColor",value:function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",d=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(b){var e=a?"."+a:"",f=d?Oa.getWhiteOrBlack(b):b;this.addCSSRules(["button"],"\n      color: "+b+";\n    ",e,c),"slider"===a&&(this.addCSSRules([".main-button i:after"],"\n        color: "+f+";\n      ",c),e=".buttons"),this.addCSSRules([".channels ul li:after"],"\n      color: "+f+";\n    ",e,c),this.addCSSRules([".main-button.slider-open:after",".main-button.close:after"],"\n      color: "+f+";\n    ",e,c)}}},{key:"setupCustomColor",value:function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",d=ua.getColorBrightness(b),e=a?"."+a:"",f=void 0;f=d>60?ua.shadeColor(b,-.2):ua.shadeColor(b,.2);var g=ua.shadeColor(b,-.2);this.addCSSRules(["button:not(.empty)"],"background-color: "+b+";",e,c),this.addCSSRules(["button:not(.empty):not(.pick-time):not(.call-now):not([disabled]):hover"],"background-color: "+f+";",e,c),this.addCSSRules(["ul.rating:hover li:after"],"color: "+b+";",e,c),this.addCSSRules(["button:not(.empty)"],"border-color: "+b+";",e,c);var h=Oa.getWhiteOrBlack(b);this.addCSSRules(["button:not(.empty)"],"\n      color: "+h+";\n      box-shadow: inset 0px -2px 3px 1px "+g+";\n    ",e,c),this.addCSSRules(["button:disabled"],"border: solid 1px "+g+";",e,c);var i=".buttons";"slider"===a?(CBHCore.helpers.addCSSRules([".cbh-button.cbh-only-button .cbh-ph-circle"],"border-color: "+b+" !important;",c),CBHCore.helpers.addCSSRules([".cbh-button.cbh-only-button .cbh-ph-circle-fill"],"background-color: "+b+" !important;",c)):i=".catch.buttons",this.addCSSRules([".main-button",".channels ul li"],"\n      background-color: "+b+" !important;\n    ",i,c),this.addCSSRules([".main-button i.custom",".main-button.slider-open.custom-logo"],"\n      border-color: "+b+" !important;\n    ",i,c)}},{key:"addCSSRules",value:function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";if(b&&CBHCore.helpers.isString(b)&&CBHCore.helpers.isArray(a)){var e="";d&&(e+="."+d.replace(/^\./,"")+" "),e+=c;var f=a.map(function(a){return e+" "+a});return this.addCSSRules(function(a,b){return ua.reduce(a,function(a,c){return a[c]=b,a},{})}(f,b),null,"",d)}for(var g in a)a.hasOwnProperty(g)&&(d?(this.customCSSRules.byBodyClass[d]||(this.customCSSRules.byBodyClass[d]=[]),this.customCSSRules.byBodyClass[d].push({selector:g,rule:a[g]})):this.customCSSRules.default.push({selector:g,rule:a[g]}))}},{key:"isInnerChannelVisible",value:function(){return this.slideVisible("builtin")||this.slideVisible("email")||this.slideVisible("sms")}},{key:"closeCatchDialog",value:function(){this.caught(!1),this.sliderVisible()||this.changeSliderOpenState(!1),this.sendCustomizedMarketingEvent("Callbackhunter_WIDGET","clicked"),this.resetCatching()}},{key:"setPopupBlocking",value:function(a){Rb.blockAutoPopup=a}},{key:"setGreeterQueueActivity",value:function(a){CBHCore.EventEmitter.emit("widget.greeters."+(a?"resume":"pause"))}},{key:"getGreeterData",value:function(){var a=this.greeterType();return a&&this.customGreeterSettings[a]?this.customGreeterSettings[a]()||null:null}},{key:"sendCustomizedMarketingEvent",value:function(a,b){U(a,b,this.seoId())}}]),a}(),Tb=function(){function a(b,c,d){var e=this;ma(this,a),this.viewmodel=null,this.afterGreeterArised=function(){W();var a=CBHCore.showReasons.BUTTON;if(e.viewmodel.greeterUid())switch(CBHCore.EventEmitter.emit("widget.greeters.visible",e.viewmodel.greeterUid()),e.viewmodel.greeterType()){case"banner":a=CBHCore.showReasons.GREETER_BANNER;break;case"chat":a=CBHCore.showReasons.GREETER_BUILTIN;break;case"slider":a=CBHCore.showReasons.GREETER_SLIDER;break;default:a=CBHCore.showReasons.BUTTON}else e.viewmodel.setGreeterQueueActivity(!1);e.viewmodel.showReason(a)},this.tpl=b,this.viewmodel=c,this.activityFlags=d,this.ifrList=[],this.injectedStyleList={},this.viewmodel.customBodyClassCSSRules.subscribe(function(a){e.injectCustomConditionalStyles(a)}),this.viewmodel.greeterUid.subscribe(function(){e.recalcGreeterBodyClass(e.viewmodel.greeterBodyClass())})}return na(a,[{key:"recalcGreeterBodyClass",value:function(a){var b=function(a){return a.replace(/^\./,"")},c=b(this.viewmodel.greeterClassPrefix);a?CBHCore.helpers.addBodyClass(a,!0):CBHCore.helpers.removeBodyClass(/^greeter(-([a-z0-9]*?)){5}$/),this.ifrList.forEach(function(d){var e=d.contentWindow.document.body.className.split(" ").filter(function(a){return""!==a&&-1===a.indexOf(c)});a&&e.push(b(a)),d.contentWindow.document.body.className=e.join(" ")})}},{key:"injectCustomConditionalStyles",value:function(a){var b=this;Object.keys(a).forEach(function(c){var d=a[c].slice();b.stylePackDiffers(c,d)&&(b.injectedStyleList[c]=d,b.ifrList.forEach(function(a){var b=a.contentWindow.document.createElement("style");a.contentWindow.document.head.appendChild(b),d.forEach(function(a){var c=a.selector,d=a.rule;X(b.sheet,c,d)})}))})}},{key:"stylePackDiffers",value:function(a,b){return-1===Object.keys(this.injectedStyleList).indexOf(a)||JSON.stringify(this.injectedStyleList[a])!==JSON.stringify(b)}},{key:"createIframe",value:function(a,b,c,d){var e=this,f=document.createElement("iframe");f.id=a,f.setAttribute("frameborder","0"),f.setAttribute("sandbox",["allow-same-origin","allow-scripts","allow-top-navigation","allow-popups-to-escape-sandbox","allow-popups"].join(" ")),d.appendChild(f),f.contentWindow.document.open(),f.contentWindow.document.write('\n      <head><link type="text/css" href="'+c+'" rel="stylesheet"></head>\n    ');var g=navigator&&navigator.userAgent||"";f.contentWindow.document.write('\n        <body data-agent="'+g+'">'+b+"</body>\n    ");var h=f.contentWindow.document.createElement("style");f.contentWindow.document.head.appendChild(h),this.viewmodel.customCSSRules.default.forEach(function(a){var b=a.selector,c=a.rule;X(h.sheet,b,c)}),setTimeout(function(){f.contentWindow.document.close(),ko.applyBindings(e.viewmodel,f.contentWindow.document.body)},50),this.ifrList.push(f)}},{key:"draw",value:function(){var a=document.createElement("div");a.innerHTML=this.tpl.main(),ko.applyBindings(this.viewmodel,a);var b=document.createElement("div");b.id="cbh";var c=a.childNodes[0];b.appendChild(c);var d=a.childNodes[0];b.appendChild(d);var e=a.childNodes[0];b.appendChild(e);var f=a.childNodes[0];b.appendChild(f),document.body.appendChild(b);var g=void 0===CBHCore.opt.use_minimized_css||!0===CBHCore.opt.use_minimized_css,h=g?"//"+CBHCore.opt.static_domain+"/widgets/v10/slider.min.css":"//"+CBHCore.opt.static_domain+"/widgets/v10/slider.css";this.createIframe("cbh_slider_container",this.tpl.slider(),h,d),this.createIframe("cbh_button_container",this.tpl.button(),h,e),this.createIframe("cbh_banner_container",this.tpl.banner_container(),h,f),this.viewmodel.widgetDrawEndTS=(new Date).getTime()}},{key:"showSlider",value:function(a){var b=this,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(CBHCore.logger.debug("showSlider attempt"),!a&&this.activityFlags.blockAutoPopup)return CBHCore.logger.debug({"showSlider prevented":this.activityFlags}),null;a&&this.viewmodel.forceCloseWidget(),setTimeout(function(){b.doSliderCatch(c,d)},0)}},{key:"showChat",value:function(a){var b=this,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(CBHCore.logger.debug("showChat attempt"),!a&&this.activityFlags.blockAutoPopup)return CBHCore.logger.debug({"showChat prevented":this.activityFlags}),null;setTimeout(function(){b.doChatCatch(c)},0)}},{key:"showBanner",value:function(a){var b=this,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(CBHCore.logger.debug("showBanner attempt"),!a&&this.activityFlags.blockAutoPopup)return CBHCore.logger.debug({"showBanner prevented":this.activityFlags}),null;a&&this.viewmodel.forceCloseWidget(),setTimeout(function(){b.doBannerCatch(c)},0)}},{key:"startCallback",value:function(){this.showSlider(!0),this.viewmodel.user.isPhoneValid(!0)&&this.viewmodel.activeSlide("call-now")}},{key:"doSliderCatch",value:function(a){var b=this,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,d="center"===c||"popup"===ha.catch_method||a&&"center"===a.position;("aside"===c||a&&"aside"===a.position)&&(d=!1),this.viewmodel.applyGreeterSettings("slider",a,this.afterGreeterArised),this.viewmodel.hasCalls&&this.viewmodel.activeSlide("callback"),d?setTimeout(function(){b.viewmodel.caught(!0)}):(this.viewmodel.changeSliderOpenState(!0),a.firstScreenEnabled&&this.viewmodel.activeSubslide("catch"),this.viewmodel.sliderVisible(!0))}},{key:"doChatCatch",value:function(a){var b=this;if(!this.viewmodel.chatsManager.isChatEnabled("builtin"))return void this.viewmodel.resetCatching();this.viewmodel.applyGreeterSettings("chat",a,this.afterGreeterArised),"full"===a.mode?(this.viewmodel.changeSliderOpenState(!0),this.viewmodel.activeSlide("builtin"),setTimeout(function(){return b.viewmodel.sliderVisible(!0)})):"snippet"===a.mode&&(this.viewmodel.activeSlide("builtin-snippet"),this.viewmodel.channelsVisible(!1),this.viewmodel.changeSliderOpenState(!0))}},{key:"doBannerCatch",value:function(a){this.viewmodel.applyGreeterSettings("banner",a,this.afterGreeterArised)}}]),a}(),Ub=function(){function a(b,c){var d=this;ma(this,a),this.api=null,this.onGreeterArise=function(a){try{CBHCore.logger.debug({onGreeterArise:a}),d.api.ariseGreeter(a)}catch(a){console.error("Error: "+a.name+":"+a.message)}},this.eventRoutes={"greeters.arise":this.onGreeterArise},this.api=b,this.eventEmitter=c}return na(a,[{key:"init",value:function(){this.registerListeners()}},{key:"registerListeners",value:function(){var a=this;Object.keys(this.eventRoutes).forEach(function(b){a.eventEmitter.on(b,a.eventRoutes[b])})}}]),a}(),Vb=function(){function a(b,c){ma(this,a),this.widget=null,this.widget=b,this.eventEmitter=c,this.GREETER_TYPES=["slider","banner","chat"]}return na(a,[{key:"ariseGreeter",value:function(a){if(!a.settings)return CBHCore.logger.debug({Error:"No data.settings"}),void this.eventEmitter.emit("widget.greeters.resume");var b=Object.keys(a.settings)[0];if(-1===this.GREETER_TYPES.indexOf(b))return this.eventEmitter.emit("widget.greeters.resume"),void CBHCore.logger.debug({Error:"Unknown greeter type of "+b});var c="show"+b.charAt(0).toUpperCase()+b.substr(1),d=a.settings[b];d.greeterUid=a.uid,d.seoId=a.seoId,1===parseInt(d.inheritWidget,10)&&(d={}),this.widget[c](!1,d)}}]),a}(),Wb=CBHCore.Masked,Xb=function(){function a(){return void 0!==ha.enable_masks&&1===parseInt(ha.enable_masks,10)}ko.bindingHandlers.masked={init:function(b,c){var d=c(),e=void 0;if(e=CBHCore.helpers.isFunction(d)?d:d.phone,!a())return void ko.utils.registerEventHandler(b,"keyup",function(){e(this.value)});var f=!1,g=!1;CBHCore.helpers.empty(ha.fixed_country)||(g=ha.fixed_country,!CBHCore.helpers.empty(ha.country_call_binding)&&ha.fixed_country&&(f=ha.country_call_binding));var h=new Wb({initial_focus:!1,selector:b,show_validation_errors:!0,one_country:g,country_binding:f,country:CBHCore.db_params.iso_code,phone:e(),onValueChanged:function(a){return e(a)},onSend:d.onSend||function(){},onToggleList:d.onToggleList||function(){},onHideList:function(){return Wb.getInst(b).focused()},i18n:{ru:{errors:{phone_is_empty:ea("phone_error"),phone_not_exists:ea("phone_error")}}}});b.maskInitInProcess=!0,void 0===ko.bindingHandlers.masked.masks&&(ko.bindingHandlers.masked.masks=[]),ko.bindingHandlers.masked.masks.push(h)},update:function(b,c){var d=c(),e=void 0;if(e=CBHCore.helpers.isFunction(d)?ko.utils.unwrapObservable(d):ko.utils.unwrapObservable(d.phone),isNaN(e)&&(e=""),!a())return void(b.value=e);for(var f=0;f<ko.bindingHandlers.masked.masks.length;f++){ko.bindingHandlers.masked.masks[f].setPhone(e)}}},ko.bindingHandlers.countdown={init:function(a,b){Va({element:a,valueAccessor:b})}},ko.bindingHandlers.ref={update:function(a,b){b()(a)}}},Yb=function(){$();var a=new Sb(ga),b=new Tb(ga,a,Rb),c=new Vb(b,CBHCore.EventEmitter),d=new Ub(c,CBHCore.EventEmitter);return Xb(),Y(a,b,d),b},Zb=null;return{init:function(){Zb=Yb()},showSimpleDialog:function(a,b){Zb&&Zb.showSlider(a,{},b)},showWidgetEnter:CBHCore.tryExternalCallback("showWidgetEnter",function(a){Zb&&Zb.showSlider(a)}),showWidgetExit:CBHCore.tryExternalCallback("showWidgetExit",function(a){Zb&&Zb.showSlider(a)})}}(0,this.document);